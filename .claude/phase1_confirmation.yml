# Phase 1 å®Œæˆç¡®è®¤æœºåˆ¶
# Purpose: Phase 1ç»“æŸæ—¶ï¼ŒAIå¿…é¡»ç”¨äººè¯å‘ç”¨æˆ·è¯´æ˜ç™½å¹¶ç­‰å¾…ç¡®è®¤

meta:
  version: "1.0.0"
  purpose: "ç¡®ä¿Phase 1ç»“æŸæ—¶ç”¨æˆ·ç†è§£è¦åšä»€ä¹ˆï¼Œå¦‚ä½•éªŒè¯ä¸æ˜¯ç©ºæ¶å­"
  target_user: "ç¼–ç¨‹å°ç™½å’ŒæŠ€æœ¯ç”¨æˆ·éƒ½èƒ½ç†è§£"
  trigger: "Phase 1.5 (Architecture Planning)å®Œæˆå"

# ====================================================================
# æ ¸å¿ƒåŸåˆ™ï¼šPhase 1ç»“æŸå¿…é¡»å®Œæˆ3ä»¶äº‹
# ====================================================================
must_do:
  1_explain_in_plain_language:
    rule: "ç”¨äººè¯è¯´æ˜ç™½è¦åšä»€ä¹ˆï¼ˆä¸æ˜¯æŠ€æœ¯æœ¯è¯­ï¼‰"
    format: |
      ## ä¸€ã€æˆ‘è¦å®ç°ä»€ä¹ˆï¼Ÿï¼ˆç”¨äººè¯è¯´ï¼‰

      **ç®€å•æ¥è¯´**ï¼šç°åœ¨XXX â†’ æ”¹æˆYYY

      **ä¸¾ä¾‹è¯´æ˜**ï¼š

      âŒ **ç°åœ¨çš„é—®é¢˜**ï¼š
      [å…·ä½“åœºæ™¯æè¿°]

      âœ… **æ”¹é€ å**ï¼š
      [å…·ä½“åœºæ™¯æè¿°æ”¹è¿›åçš„æ ·å­]

      **æ ¸å¿ƒ**ï¼š[ä¸€å¥è¯æ€»ç»“æ ¸å¿ƒä»·å€¼]

  2_show_checklist:
    rule: "æ˜ç¡®çš„Checklistï¼ˆå¦‚ä½•éªŒè¯ä¸æ˜¯ç©ºæ¶å­ï¼‰"
    required_sections:
      - "7-Phase Workflowå¼ºåˆ¶æ£€æŸ¥ï¼ˆPhase 2-7çš„è¯¦ç»†æ­¥éª¤ï¼‰"
      - "å®é™…å¯è¿è¡Œçš„æµ‹è¯•ï¼ˆå…·ä½“æµ‹è¯•ç”¨ä¾‹å’Œé¢„æœŸç»“æœï¼‰"
      - "ä½ èƒ½éªŒè¯çš„è¯æ®ï¼ˆå®é™…è¿è¡Œå‘½ä»¤å’Œè¾“å‡ºï¼‰"
      - "Né¡¹éªŒæ”¶æ ‡å‡†ï¼ˆæ¥è‡ªuser_request.mdçš„Acceptance Criteriaï¼‰"
      - "å¦‚æœå‡ºé—®é¢˜æ€ä¹ˆåŠï¼ˆå›æ»šæœºåˆ¶å’Œä¿®å¤æµç¨‹ï¼‰"

    format: |
      ## äºŒã€å¦‚ä½•ä¿è¯èƒ½è½åœ°ï¼Ÿï¼ˆChecklistæœºåˆ¶ï¼‰

      ### âœ… ä¿éšœå±‚1ï¼š7-Phase Workflowå¼ºåˆ¶æ£€æŸ¥

      Phase 2: Implementation
      â”œâ”€ [ ] 2.1 å…·ä½“ä»»åŠ¡1
      â”œâ”€ [ ] 2.2 å…·ä½“ä»»åŠ¡2
      â””â”€ [ ] 2.N æ‰€æœ‰ä»£ç èƒ½è¿è¡Œ

      Phase 3: Testingï¼ˆå¿…é¡»å…¨éƒ¨é€šè¿‡ï¼‰
      â”œâ”€ [ ] 3.1 bash -néªŒè¯è¯­æ³• â† ä¸é€šè¿‡ä¸èƒ½ç»§ç»­
      â”œâ”€ [ ] 3.2 æµ‹è¯•é¡¹2 â† ä¸é€šè¿‡ä¸èƒ½ç»§ç»­
      â””â”€ [ ] 3.N æ€§èƒ½è¾¾æ ‡ â† ä¸é€šè¿‡ä¸èƒ½ç»§ç»­

      Phase 4: Reviewï¼ˆå¿…é¡»å…¨éƒ¨é€šè¿‡ï¼‰
      â”œâ”€ [ ] 4.1 å®¡æŸ¥é¡¹1 â† ä¸é€šè¿‡ä¸èƒ½ç»§ç»­
      â””â”€ [ ] 4.N Pre-merge audité€šè¿‡ â† ä¸é€šè¿‡ä¸èƒ½ç»§ç»­

      Phase 5-7: ...

      **å…³é”®ç‚¹**ï¼š
      - â›” Phase Nä»»ä½•ä¸€é¡¹å¤±è´¥ â†’ å›åˆ°Phase N-1ä¿®å¤
      - â›” ä½ è¯´"æœ‰é—®é¢˜" â†’ ä¸è¿›å…¥ä¸‹ä¸€Phase

      ### âœ… ä¿éšœå±‚2ï¼šå®é™…å¯è¿è¡Œçš„æµ‹è¯•

      ```bash
      # æµ‹è¯•1ï¼š[æè¿°]
      æµ‹è¯•ï¼š"[å…·ä½“å†…å®¹]"
      é¢„æœŸï¼š[é¢„æœŸç»“æœ]
      å®é™…ï¼šè¿è¡Œ [å‘½ä»¤]
      ç»“æœï¼š[éªŒè¯æ–¹æ³•] âœ“ é€šè¿‡

      # æµ‹è¯•2ã€3...
      ```

      ### âœ… ä¿éšœå±‚3ï¼šä½ èƒ½éªŒè¯çš„è¯æ®

      1. **å®é™…è¿è¡Œç»“æœ**ï¼š
         ```bash
         # ä½ å¯ä»¥è‡ªå·±è¿è¡ŒéªŒè¯ï¼š
         [å®é™…å‘½ä»¤]
         # è¾“å‡ºï¼š[é¢„æœŸè¾“å‡º]
         ```

      2. **æµ‹è¯•é€šè¿‡æˆªå›¾**ï¼š
         ```
         âœ… å•å…ƒæµ‹è¯•ï¼šX/X passed
         âœ… é›†æˆæµ‹è¯•ï¼šY/Y passed
         ```

      3. **ä»£ç å®¡æŸ¥æŠ¥å‘Š**ï¼ˆREVIEW.mdï¼‰ï¼š
         - é€è¡Œæ£€æŸ¥ä»£ç é€»è¾‘
         - éªŒè¯ç‰ˆæœ¬ä¸€è‡´æ€§
         - ç¡®è®¤æ²¡æœ‰ç©ºå£³å®ç°

      ### âœ… Né¡¹éªŒæ”¶æ ‡å‡†ï¼ˆè´¨é‡è½åœ°Checklistï¼‰

      **é‡è¦**ï¼šè¿™ä¸ªChecklistè¦ç”¨"äººè¯+æŠ€æœ¯+è¯æ®"ä¸‰é‡æ ¼å¼ï¼š

      **ç¤ºä¾‹æ ¼å¼**ï¼š
      ```
      F1: åŠŸèƒ½æè¿°
      - æŠ€æœ¯ï¼šæŠ€æœ¯æœ¯è¯­æè¿°
      - äººè¯ï¼šç”¨æˆ·èƒ½ç†è§£çš„æè¿°
      - è¯æ®ï¼šå¦‚ä½•éªŒè¯ï¼ˆå‘½ä»¤ã€æ–‡ä»¶ã€æˆªå›¾ï¼‰
      ```

      **Checkliståˆ†ç±»**ï¼š
      - åŠŸèƒ½æ‰¿è¯ºï¼ˆF1-FNï¼‰
      - æ€§èƒ½æ‰¿è¯ºï¼ˆP1-PNï¼‰
      - è´¨é‡æ‰¿è¯ºï¼ˆQ1-QNï¼‰
      - é›†æˆæ‰¿è¯ºï¼ˆI1-INï¼‰
      - æ–‡æ¡£æ‰¿è¯ºï¼ˆD1-DNï¼‰

      **éªŒæ”¶é—¨æ§›**ï¼šâ‰¥90%å®Œæˆï¼ˆNé¡¹ä¸­â‰¥Xé¡¹ï¼‰

      **Phase 1ä½œç”¨**ï¼šç»™ç”¨æˆ·çœ‹"æˆ‘æ‰¿è¯ºåšåˆ°å“ªäº›"
      **Phase 6ä½œç”¨**ï¼šç»™ç”¨æˆ·çœ‹"æˆ‘å®é™…å®Œæˆäº†å“ªäº›"ï¼ˆâœ…/âŒ + è¯æ®ï¼‰

  3_wait_for_confirmation:
    rule: "å¿…é¡»ç­‰å¾…ç”¨æˆ·ç¡®è®¤ï¼Œä¸èƒ½è‡ªåŠ¨è¿›å…¥Phase 2"
    required_user_responses:
      - "æˆ‘ç†è§£äº†ï¼Œå¼€å§‹Phase 2"
      - "Phase 1é€šè¿‡ï¼Œå¼€å§‹Phase 2"
      - "å¯ä»¥ï¼Œç»§ç»­"
      - "æ²¡é—®é¢˜ï¼Œè¿›å…¥Phase 2"

    blocked_until: "ç”¨æˆ·æ˜ç¡®ç¡®è®¤"

    format: |
      ## ä¸‰ã€ç°åœ¨éœ€è¦ä½ ç¡®è®¤çš„

      **Phase 1å·²å®Œæˆï¼Œè¯·ä½ ç¡®è®¤3ä»¶äº‹**ï¼š

      1. **ä½ ç†è§£æˆ‘è¦åšä»€ä¹ˆäº†å—ï¼Ÿ**
         - âœ… æ˜¯ï¼š[ä¸€å¥è¯æ€»ç»“æ ¸å¿ƒ]
         - âŒ å¦ï¼šæˆ‘é‡æ–°è§£é‡Š

      2. **ä½ è®¤å¯è¿™ä¸ªæ–¹æ¡ˆå—ï¼Ÿ**
         - âœ… æ˜¯ï¼š[æ–¹æ¡ˆå…³é”®ç‚¹]
         - âŒ å¦ï¼šè¯´å“ªé‡Œä¸æ»¡æ„ï¼Œæˆ‘é‡æ–°è®¾è®¡

      3. **å¯ä»¥å¼€å§‹Phase 2äº†å—ï¼Ÿ**
         - âœ… æ˜¯ï¼šæˆ‘å¼€å§‹æ”¹ä»£ç ï¼ˆé¢„è®¡Xå°æ—¶å®Œæˆï¼‰
         - âŒ å¦ï¼šæˆ‘ç­‰ä½ çš„é—®é¢˜å’Œå»ºè®®

      **è¯·ç”¨ä½ çš„è¯å‘Šè¯‰æˆ‘**ï¼š
      - "æˆ‘ç†è§£äº†ï¼Œå¼€å§‹Phase 2" æˆ–
      - "æˆ‘æœ‰ç–‘é—®ï¼šXXX" æˆ–
      - "æ–¹æ¡ˆä¸è¡Œï¼Œéœ€è¦æ”¹æˆYYY"

# ====================================================================
# ç¦æ­¢çš„è¡Œä¸º
# ====================================================================
forbidden:
  - action: "Phase 1ç»“æŸåç›´æ¥è¿›å…¥Phase 2å†™ä»£ç "
    reason: "ç”¨æˆ·å¯èƒ½æ²¡ç†è§£æˆ–ä¸è®¤å¯æ–¹æ¡ˆ"
    consequence: "ç”¨æˆ·å¤±å»æ§åˆ¶æ„Ÿï¼Œå¯èƒ½åšé”™æ–¹å‘"

  - action: "åªç»™æŠ€æœ¯æ–‡æ¡£ï¼ˆP1_DISCOVERY.md, PLAN.mdï¼‰ä¸æ€»ç»“"
    reason: "ç”¨æˆ·å¯èƒ½çœ‹ä¸æ‡‚æŠ€æœ¯æ–‡æ¡£"
    consequence: "ç”¨æˆ·ä¸çŸ¥é“è¦åšä»€ä¹ˆï¼Œæ— æ³•åˆ¤æ–­æ–¹æ¡ˆæ˜¯å¦åˆç†"

  - action: "åªè¯´'Phase 1å®Œæˆ'ä¸è§£é‡Šchecklist"
    reason: "ç”¨æˆ·ä¸çŸ¥é“å¦‚ä½•éªŒè¯ä¸æ˜¯ç©ºæ¶å­"
    consequence: "ç”¨æˆ·æ‹…å¿ƒæœ€åæ‹¿åˆ°çš„æ˜¯ç©ºæ¶å­"

  - action: "ç”¨æŠ€æœ¯æœ¯è¯­è§£é‡Šï¼ˆå¦‚'per-phaseæ¶æ„'ã€'YAML schema'ï¼‰"
    reason: "ç”¨æˆ·å¯èƒ½å¬ä¸æ‡‚"
    consequence: "ç”¨æˆ·æ— æ³•åˆ¤æ–­æ–¹æ¡ˆæ˜¯å¦ç¬¦åˆéœ€æ±‚"

# ====================================================================
# è¾“å‡ºæ¨¡æ¿
# ====================================================================
output_template: |
  # ğŸ¯ Phase 1 å®Œæˆ â†’ å‘ä½ ç¡®è®¤çš„å†…å®¹

  ## ä¸€ã€æˆ‘è¦å®ç°ä»€ä¹ˆï¼Ÿï¼ˆç”¨äººè¯è¯´ï¼‰

  **ç®€å•æ¥è¯´**ï¼š[ç°çŠ¶] â†’ [æ”¹é€ å]

  **ä¸¾ä¾‹è¯´æ˜**ï¼š

  âŒ **ç°åœ¨çš„é—®é¢˜**ï¼š
  [å…·ä½“åœºæ™¯ï¼Œç”¨å¯¹è¯å½¢å¼]

  âœ… **æ”¹é€ å**ï¼š
  [å…·ä½“åœºæ™¯æ”¹è¿›åï¼Œç”¨å¯¹è¯å½¢å¼]

  **æ ¸å¿ƒ**ï¼š[ä¸€å¥è¯æ€»ç»“]

  ---

  ## äºŒã€å…·ä½“æ”¹ä»€ä¹ˆæ–‡ä»¶ï¼Ÿ

  **åªæ”¹Nä¸ªæ–‡ä»¶**ï¼š

  1. **æ–‡ä»¶1** - [ç®€å•è¯´æ˜]
     - å¢åŠ ï¼š[å…·ä½“å†…å®¹]
     - ä¿®æ”¹ï¼š[å…·ä½“å†…å®¹]

  2. **æ–‡ä»¶2** - [ç®€å•è¯´æ˜]
     - å¢åŠ ï¼š[å…·ä½“å†…å®¹]

  **ä¸æ”¹å…¶ä»–æ–‡ä»¶**ï¼

  ---

  ## ä¸‰ã€å¦‚ä½•ä¿è¯èƒ½è½åœ°ï¼Ÿï¼ˆChecklistæœºåˆ¶ï¼‰

  ### âœ… ä¿éšœå±‚1ï¼š7-Phase Workflowå¼ºåˆ¶æ£€æŸ¥

  [è¯¦ç»†çš„Phase 2-7æ­¥éª¤ï¼Œæ¯ä¸ªæ­¥éª¤æ ‡æ³¨æ˜¯å¦é˜»å¡]

  ### âœ… ä¿éšœå±‚2ï¼šå®é™…å¯è¿è¡Œçš„æµ‹è¯•

  [å…·ä½“æµ‹è¯•ç”¨ä¾‹ï¼ŒåŒ…å«å‘½ä»¤å’Œé¢„æœŸç»“æœ]

  ### âœ… ä¿éšœå±‚3ï¼šä½ èƒ½éªŒè¯çš„è¯æ®

  [ç”¨æˆ·å¯ä»¥è‡ªå·±è¿è¡Œçš„éªŒè¯å‘½ä»¤]

  ### âœ… è´¨é‡è½åœ°Checklistï¼ˆPhase 1æ‰¿è¯º â†’ Phase 6éªŒæ”¶ï¼‰

  **æ ¼å¼è¦æ±‚**ï¼š"äººè¯+æŠ€æœ¯+è¯æ®"ä¸‰é‡æ ¼å¼

  **F1**: [åŠŸèƒ½1æè¿°]
  - æŠ€æœ¯ï¼š[æŠ€æœ¯æœ¯è¯­]
  - äººè¯ï¼š[ç”¨æˆ·èƒ½ç†è§£çš„æè¿°]
  - è¯æ®ï¼š[å¦‚ä½•éªŒè¯]

  **F2-FN**: [å…¶ä»–åŠŸèƒ½...]

  **P1-PN**: [æ€§èƒ½æ‰¿è¯º...]

  **Q1-QN**: [è´¨é‡æ‰¿è¯º...]

  **I1-IN**: [é›†æˆæ‰¿è¯º...]

  **D1-DN**: [æ–‡æ¡£æ‰¿è¯º...]

  **éªŒæ”¶é—¨æ§›**ï¼šâ‰¥90%å®Œæˆ

  ---

  **Phase 6æ—¶å±•ç¤ºæ ¼å¼**ï¼š
  ```
  åŠŸèƒ½æ‰¿è¯ºï¼šâœ…âœ…âœ…âŒâœ… (4/5 = 80%)
  æ€§èƒ½æ‰¿è¯ºï¼šâœ…âœ…âœ… (3/3 = 100%)
  è´¨é‡æ‰¿è¯ºï¼šâœ…âœ…âœ…âœ…âœ… (5/5 = 100%)
  é›†æˆæ‰¿è¯ºï¼šâœ…âœ…âœ…âœ… (4/4 = 100%)
  æ–‡æ¡£æ‰¿è¯ºï¼šâœ…âœ…âœ… (3/3 = 100%)

  æ€»è®¡ï¼š19/20 (95%) âœ… è¾¾æ ‡
  ```

  ç„¶åé€é¡¹å±•ç¤ºè¯æ®ï¼ˆè¿è¡Œç»“æœã€æ–‡ä»¶å†…å®¹ã€æˆªå›¾ï¼‰

  ---

  ## å››ã€å¦‚æœå‡ºé—®é¢˜æ€ä¹ˆåŠï¼Ÿ

  **åœºæ™¯1**ï¼š[é—®é¢˜æè¿°]
  ```
  æˆ‘åšä»€ä¹ˆï¼š[ä¿®å¤æ­¥éª¤]
  ä½ çœ‹åˆ°ä»€ä¹ˆï¼š[ç»“æœ]
  ```

  **åœºæ™¯2ã€3...**

  **å›æ»šæœºåˆ¶**ï¼š
  - æ‰€æœ‰ä»£ç åœ¨featureåˆ†æ”¯ï¼ˆä¸å½±å“mainï¼‰
  - ä½ è¯´"åœ" â†’ æˆ‘ç«‹å³åœæ­¢
  - ä½ è¯´"å›æ»š" â†’ æˆ‘æ‰§è¡Œgit reset

  ---

  ## äº”ã€æˆ‘çš„æ‰¿è¯ºï¼ˆé˜²æ­¢ç©ºæ¶å­ï¼‰

  **æˆ‘ä¿è¯åšåˆ°**ï¼š

  1. âœ… **ä¸è·³Phase** - [å…·ä½“è¯´æ˜]
  2. âœ… **æ¯ä¸ªä»£ç éƒ½èƒ½è¿è¡Œ** - [å…·ä½“è¯´æ˜]
  3. âœ… **æ¯ä¸ªåŠŸèƒ½éƒ½æœ‰è¯æ®** - [å…·ä½“è¯´æ˜]
  4. âœ… **æ¯ä¸ªé˜¶æ®µç­‰ä½ ç¡®è®¤** - [å…·ä½“è¯´æ˜]
  5. âœ… **é—®é¢˜ç«‹å³ä¿®å¤** - [å…·ä½“è¯´æ˜]

  ---

  ## å…­ã€ç°åœ¨éœ€è¦ä½ ç¡®è®¤çš„

  **Phase 1å·²å®Œæˆï¼Œè¯·ä½ ç¡®è®¤3ä»¶äº‹**ï¼š

  1. **ä½ ç†è§£æˆ‘è¦åšä»€ä¹ˆäº†å—ï¼Ÿ**
  2. **ä½ è®¤å¯è¿™ä¸ªæ–¹æ¡ˆå—ï¼Ÿ**
  3. **å¯ä»¥å¼€å§‹Phase 2äº†å—ï¼Ÿ**

  **è¯·ç”¨ä½ çš„è¯å‘Šè¯‰æˆ‘**ï¼š
  - "æˆ‘ç†è§£äº†ï¼Œå¼€å§‹Phase 2" æˆ–
  - "æˆ‘æœ‰ç–‘é—®ï¼šXXX" æˆ–
  - "æ–¹æ¡ˆä¸è¡Œï¼Œéœ€è¦æ”¹æˆYYY"

  ---

  **è¿™å°±æ˜¯æˆ‘åº”è¯¥åœ¨Phase 1ç»“æŸæ—¶å‘Šè¯‰ä½ çš„å†…å®¹**

# ====================================================================
# Hooké›†æˆ
# ====================================================================
integration:
  hook_file: ".claude/hooks/phase1_completion_check.sh"
  trigger_condition: "Phase 1.5 (PLAN.md)å®Œæˆå"

  hook_logic: |
    #!/bin/bash
    # Phase 1å®Œæˆæ£€æŸ¥ï¼šç¡®ä¿AIç»™å‡ºäº†ç”¨æˆ·ç¡®è®¤å†…å®¹

    # æ£€æŸ¥æ˜¯å¦åœ¨Phase 1.5
    if [[ ! -f .workflow/PLAN.md ]]; then
        exit 0  # ä¸åœ¨Phase 1ï¼Œä¸æ£€æŸ¥
    fi

    # æ£€æŸ¥æœ€è¿‘çš„å¯¹è¯æ˜¯å¦åŒ…å«"Phase 1å®Œæˆç¡®è®¤"å…³é”®å†…å®¹
    # ï¼ˆè¿™éœ€è¦Claude Codeçš„APIæ”¯æŒï¼Œç›®å‰æ— æ³•å®ç°ï¼‰

    # æ›¿ä»£æ–¹æ¡ˆï¼šåœ¨CLAUDE.mdä¸­æ˜ç¡®å†™æ˜æ­¤è§„åˆ™
    echo "âš ï¸  æé†’ï¼šPhase 1å®Œæˆåå¿…é¡»ç»™ç”¨æˆ·ç¡®è®¤å†…å®¹ï¼ˆè§phase1_confirmation.ymlï¼‰"

# ====================================================================
# ç¤ºä¾‹ï¼ˆå¥½çš„ vs åçš„ï¼‰
# ====================================================================
examples:
  bad_example:
    description: "Phase 1ç»“æŸåç›´æ¥è¿›Phase 2"
    ai_message: |
      Phase 1å®Œæˆï¼ç°åœ¨å¼€å§‹Phase 2å®ç°...

      [AIå¼€å§‹ä¿®æ”¹STAGES.yml...]

    problem: "ç”¨æˆ·è¿˜æ²¡ç¡®è®¤ç†è§£å’Œè®¤å¯æ–¹æ¡ˆï¼"

  good_example:
    description: "Phase 1ç»“æŸåç”¨äººè¯æ€»ç»“+ç­‰ç¡®è®¤"
    ai_message: |
      # ğŸ¯ Phase 1 å®Œæˆ â†’ å‘ä½ ç¡®è®¤çš„å†…å®¹

      ## ä¸€ã€æˆ‘è¦å®ç°ä»€ä¹ˆï¼Ÿï¼ˆç”¨äººè¯è¯´ï¼‰

      **ç®€å•æ¥è¯´**ï¼šç°åœ¨Impact Assessmentæ˜¯"ä¸€åˆ€åˆ‡" â†’ æ”¹æˆ"æ¯ä¸ªé˜¶æ®µè‡ªå·±è¯´äº†ç®—"

      [è¯¦ç»†ä¸¾ä¾‹...]

      ## äºŒã€å…·ä½“æ”¹ä»€ä¹ˆæ–‡ä»¶ï¼Ÿ

      **åªæ”¹3ä¸ªæ–‡ä»¶**ï¼š[åˆ—è¡¨...]

      ## ä¸‰ã€å¦‚ä½•ä¿è¯èƒ½è½åœ°ï¼Ÿ

      ### âœ… ä¿éšœå±‚1ï¼š7-Phaseå¼ºåˆ¶æ£€æŸ¥
      [è¯¦ç»†æ­¥éª¤...]

      ### âœ… ä¿éšœå±‚2ï¼šå®é™…å¯è¿è¡Œçš„æµ‹è¯•
      [æµ‹è¯•ç”¨ä¾‹...]

      ### âœ… 27é¡¹éªŒæ”¶æ ‡å‡†
      [é€é¡¹åˆ—å‡º...]

      ## å››ã€ç°åœ¨éœ€è¦ä½ ç¡®è®¤

      è¯·å‘Šè¯‰æˆ‘ï¼š
      - "æˆ‘ç†è§£äº†ï¼Œå¼€å§‹Phase 2" æˆ–
      - "æˆ‘æœ‰ç–‘é—®ï¼šXXX"

      [ç­‰å¾…ç”¨æˆ·å›å¤...]

    why_good: "ç”¨æˆ·èƒ½ç†è§£è¦åšä»€ä¹ˆï¼Œå¦‚ä½•éªŒè¯ï¼Œæœ‰æ§åˆ¶æƒ"

# ====================================================================
# ä¸ç°æœ‰workflowçš„é›†æˆ
# ====================================================================
workflow_integration:
  phase_1_steps:
    - id: "1.1"
      name: "Branch Check"
      output: "featureåˆ†æ”¯åˆ›å»º"

    - id: "1.2"
      name: "Requirements Discussion"
      output: "user_request.md"

    - id: "1.3"
      name: "Technical Discovery"
      output: "P1_DISCOVERY.md (>300è¡Œ)"

    - id: "1.4"
      name: "Impact Assessment"
      output: "å½±å“åŠå¾„è¯„åˆ†+æ¨èagentsæ•°é‡"

    - id: "1.5"
      name: "Architecture Planning"
      output: "PLAN.md (>1000è¡Œ)"

    - id: "1.6"  # æ–°å¢æ­¥éª¤
      name: "User Confirmation"
      trigger: "1.5å®Œæˆå"
      required: true
      blocking: true  # é˜»å¡ï¼Œä¸ç¡®è®¤ä¸èƒ½è¿›Phase 2
      output: |
        1. ç”¨äººè¯æ€»ç»“ï¼ˆæŒ‰phase1_confirmation.ymlæ¨¡æ¿ï¼‰
        2. è¯¦ç»†Checklist
        3. ç­‰å¾…ç”¨æˆ·å›å¤ç¡®è®¤

      success_criteria:
        - "ç”¨æˆ·è¯´'æˆ‘ç†è§£äº†ï¼Œå¼€å§‹Phase 2'"
        - "ç”¨æˆ·è¯´'Phase 1é€šè¿‡'"
        - "ç”¨æˆ·è¯´'å¯ä»¥ï¼Œç»§ç»­'"

      failure_handling:
        - "ç”¨æˆ·è¯´'æœ‰ç–‘é—®' â†’ AIå›ç­”ç–‘é—® â†’ é‡æ–°ç¡®è®¤"
        - "ç”¨æˆ·è¯´'æ–¹æ¡ˆä¸è¡Œ' â†’ è¿”å›1.3æˆ–1.5é‡æ–°è®¾è®¡"

  gates:
    phase_1_to_phase_2:
      name: "Phase 1 â†’ Phase 2 è½¬æ¢é—¨ç¦"
      type: "user_confirmation"  # éœ€è¦ç”¨æˆ·ç¡®è®¤
      check:
        - "P1_DISCOVERY.mdå­˜åœ¨ä¸”>300è¡Œ"
        - "PLAN.mdå­˜åœ¨ä¸”>1000è¡Œ"
        - "user_request.mdä¸­Acceptance Criteriaå·²å®šä¹‰"
        - "ç”¨æˆ·å·²ç¡®è®¤ç†è§£å’Œè®¤å¯æ–¹æ¡ˆ"  # æ–°å¢

      blocking: true
      can_bypass: false  # ä¸èƒ½ç»•è¿‡ç”¨æˆ·ç¡®è®¤

# ====================================================================
# æ›´æ–°CLAUDE.md
# ====================================================================
claude_md_addition: |
  ## ğŸ¯ Phase 1å®Œæˆç¡®è®¤æœºåˆ¶ï¼ˆå¼ºåˆ¶ï¼‰

  **è§¦å‘æ—¶æœº**ï¼šPhase 1.5 (Architecture Planning)å®Œæˆå

  **å¿…é¡»åšçš„3ä»¶äº‹**ï¼š

  1. âœ… **ç”¨äººè¯è¯´æ˜ç™½è¦åšä»€ä¹ˆ**
     - ä¸ç”¨æŠ€æœ¯æœ¯è¯­
     - ä¸¾ä¾‹è¯´æ˜before/after
     - ä¸€å¥è¯æ€»ç»“æ ¸å¿ƒä»·å€¼

  2. âœ… **å±•ç¤ºè¯¦ç»†Checklist**
     - 7-Phaseå¼ºåˆ¶æ£€æŸ¥æ­¥éª¤
     - å®é™…å¯è¿è¡Œçš„æµ‹è¯•ç”¨ä¾‹
     - Né¡¹éªŒæ”¶æ ‡å‡†ï¼ˆæ¥è‡ªuser_request.mdï¼‰
     - å›æ»šæœºåˆ¶å’Œé—®é¢˜å¤„ç†

  3. âœ… **ç­‰å¾…ç”¨æˆ·ç¡®è®¤**
     - å¿…é¡»ç­‰ç”¨æˆ·è¯´"æˆ‘ç†è§£äº†ï¼Œå¼€å§‹Phase 2"
     - ä¸èƒ½è‡ªåŠ¨è¿›å…¥Phase 2
     - ç”¨æˆ·è¯´"æœ‰ç–‘é—®"æˆ–"æ–¹æ¡ˆä¸è¡Œ" â†’ é‡æ–°è®¾è®¡

  **è¯¦ç»†è§„èŒƒ**ï¼šè§`.claude/phase1_confirmation.yml`

  **ç¦æ­¢è¡Œä¸º**ï¼š
  - âŒ Phase 1ç»“æŸåç›´æ¥å†™ä»£ç 
  - âŒ åªç»™æŠ€æœ¯æ–‡æ¡£ä¸æ€»ç»“
  - âŒ ç”¨æŠ€æœ¯æœ¯è¯­è§£é‡Š
  - âŒ ä¸ç­‰ç”¨æˆ·ç¡®è®¤å°±ç»§ç»­

# ====================================================================
# ç‰ˆæœ¬å†å²
# ====================================================================
changelog:
  - version: "1.0.0"
    date: "2025-10-29"
    changes:
      - "åˆ›å»ºPhase 1å®Œæˆç¡®è®¤æœºåˆ¶"
      - "å®šä¹‰3ä¸ªmust_doè§„åˆ™"
      - "æä¾›è¯¦ç»†è¾“å‡ºæ¨¡æ¿"
      - "é›†æˆåˆ°workflow gates"
    reason: "ç”¨æˆ·åé¦ˆPhase 1ç»“æŸæ—¶ç¼ºå°‘'ç”¨äººè¯æ€»ç»“+Checklist+ç­‰ç¡®è®¤'çš„æœºåˆ¶"

# ğŸš€ Claude Enhancer ç›‘æ§å’Œå‘Šè­¦ç³»ç»Ÿ

å®Œæ•´çš„ç›‘æ§ã€è§‚æµ‹å’Œå‘Šè­¦è§£å†³æ–¹æ¡ˆï¼Œä¸“é—¨ä¸ºClaude Enhancer Hookç³»ç»Ÿè®¾è®¡ã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### ğŸ” å…¨é¢ç›‘æ§
- **Hookæ‰§è¡Œç›‘æ§**: å®æ—¶è¿½è¸ªHookæ‰§è¡Œæ—¶é—´ã€æˆåŠŸç‡ã€é”™è¯¯ç‡
- **ç³»ç»Ÿèµ„æºç›‘æ§**: CPUã€å†…å­˜ã€ç£ç›˜ä½¿ç”¨ç‡ç›‘æ§
- **æ€§èƒ½æŒ‡æ ‡**: P50/P95/P99å»¶è¿Ÿç»Ÿè®¡å’Œè¶‹åŠ¿åˆ†æ
- **å®¹å™¨ç›‘æ§**: Dockerå®¹å™¨èµ„æºä½¿ç”¨æƒ…å†µ

### ğŸ“Š å¯è§†åŒ–Dashboard
- **å®æ—¶Dashboard**: Webç•Œé¢å®æ—¶æ˜¾ç¤ºå…³é”®æŒ‡æ ‡
- **Grafanaé›†æˆ**: ä¸“ä¸šçš„å¯è§†åŒ–å’Œå‘Šè­¦Dashboard
- **äº¤äº’å¼å›¾è¡¨**: æ”¯æŒæ—¶é—´èŒƒå›´é€‰æ‹©å’Œé’»å–åˆ†æ
- **ç§»åŠ¨ç«¯é€‚é…**: å“åº”å¼è®¾è®¡æ”¯æŒç§»åŠ¨è®¾å¤‡

### ğŸš¨ æ™ºèƒ½å‘Šè­¦
- **å¤šçº§å‘Šè­¦**: Warning/Criticalå‘Šè­¦çº§åˆ«
- **æ™ºèƒ½é˜ˆå€¼**: åŸºäºå†å²æ•°æ®çš„åŠ¨æ€é˜ˆå€¼
- **å‘Šè­¦èšåˆ**: é¿å…å‘Šè­¦é£æš´çš„æ™ºèƒ½èšåˆ
- **å¤šæ¸ é“é€šçŸ¥**: æ”¯æŒé‚®ä»¶ã€Slackã€Webhookç­‰

### ğŸ“ˆ æ€§èƒ½åˆ†æ
- **è¶‹åŠ¿åˆ†æ**: è‡ªåŠ¨æ£€æµ‹æ€§èƒ½è¶‹åŠ¿å˜åŒ–
- **å¼‚å¸¸æ£€æµ‹**: åŸºäºç»Ÿè®¡çš„å¼‚å¸¸æ£€æµ‹ç®—æ³•
- **ç“¶é¢ˆè¯†åˆ«**: è‡ªåŠ¨è¯†åˆ«æ€§èƒ½ç“¶é¢ˆ
- **å®¹é‡è§„åˆ’**: åŸºäºå†å²æ•°æ®çš„å®¹é‡é¢„æµ‹

## ğŸ—ï¸ æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Claude Enhancer ç›‘æ§æ¶æ„                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚   Hooks     â”‚â”€â”€â”€â–¶â”‚  Monitor    â”‚â”€â”€â”€â–¶â”‚  Dashboard  â”‚     â”‚
â”‚  â”‚ Execution   â”‚    â”‚  Collector  â”‚    â”‚   (Web UI)  â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚         â”‚                   â”‚                              â”‚
â”‚         â–¼                   â–¼                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚Performance  â”‚    â”‚ Prometheus  â”‚    â”‚   Grafana   â”‚     â”‚
â”‚  â”‚  Logs       â”‚    â”‚ (Metrics)   â”‚    â”‚(Visualization)â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚         â”‚                   â”‚                   â”‚          â”‚
â”‚         â–¼                   â–¼                   â–¼          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚    Loki     â”‚    â”‚AlertManager â”‚    â”‚   Reports   â”‚     â”‚
â”‚  â”‚ (Log Store) â”‚    â”‚ (Alerting)  â”‚    â”‚(Analysis)   â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“‹ ç»„ä»¶è¯´æ˜

### æ ¸å¿ƒç›‘æ§ç»„ä»¶
- **Claude Enhancer Monitor**: ä¸»ç›‘æ§åº”ç”¨ï¼Œæä¾›Web Dashboardå’ŒAPI
- **Performance Collector**: ä¸“é—¨æ”¶é›†Hookæ€§èƒ½æ•°æ®
- **Prometheus**: æ—¶åºæ•°æ®åº“ï¼Œå­˜å‚¨å’ŒæŸ¥è¯¢æŒ‡æ ‡
- **Grafana**: å¯è§†åŒ–å¹³å°ï¼Œå±•ç¤ºDashboardå’Œå›¾è¡¨

### æ•°æ®æ”¶é›†ç»„ä»¶
- **Node Exporter**: ç³»ç»ŸæŒ‡æ ‡æ”¶é›†
- **cAdvisor**: å®¹å™¨æŒ‡æ ‡æ”¶é›†
- **Promtail**: æ—¥å¿—æ”¶é›†å’Œè½¬å‘
- **Blackbox Exporter**: ç«¯ç‚¹å¯ç”¨æ€§ç›‘æ§

### å­˜å‚¨å’Œå‘Šè­¦
- **Loki**: æ—¥å¿—èšåˆå’Œå­˜å‚¨
- **AlertManager**: å‘Šè­¦ç®¡ç†å’Œé€šçŸ¥
- **SQLite**: æœ¬åœ°æ•°æ®å­˜å‚¨å’Œç¼“å­˜

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ä¸€é”®éƒ¨ç½²
```bash
# è¿›å…¥ç›‘æ§ç›®å½•
cd .claude/monitoring

# ä¸€é”®éƒ¨ç½²å®Œæ•´ç›‘æ§æ ˆ
./deploy_monitoring.sh deploy
```

### 2. è®¿é—®æœåŠ¡

| æœåŠ¡ | åœ°å€ | è¯´æ˜ |
|------|------|------|
| Claude Enhancer Dashboard | http://localhost:8091 | ä¸»ç›‘æ§ç•Œé¢ |
| Grafana | http://localhost:3001 | ä¸“ä¸šå¯è§†åŒ– (admin/admin123) |
| Prometheus | http://localhost:9090 | æŒ‡æ ‡æŸ¥è¯¢ç•Œé¢ |
| AlertManager | http://localhost:9093 | å‘Šè­¦ç®¡ç†ç•Œé¢ |

### 3. ç®¡ç†å‘½ä»¤
```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
./deploy_monitoring.sh status

# æŸ¥çœ‹æ—¥å¿—
./deploy_monitoring.sh logs

# åœæ­¢æœåŠ¡
./deploy_monitoring.sh stop

# é‡å¯æœåŠ¡
./deploy_monitoring.sh restart

# æ¸…ç†èµ„æº
./deploy_monitoring.sh cleanup
```

## ğŸ“Š ç›‘æ§æŒ‡æ ‡

### Hookæ€§èƒ½æŒ‡æ ‡
- `claude_enhancer_hook_executions_total`: Hookæ‰§è¡Œæ€»æ¬¡æ•°
- `claude_enhancer_hook_duration_seconds`: Hookæ‰§è¡Œæ—¶é—´åˆ†å¸ƒ
- `claude_enhancer_hook_errors_total`: Hooké”™è¯¯æ€»æ¬¡æ•°
- `claude_enhancer_active_hooks`: å½“å‰æ´»è·ƒHookæ•°é‡
- `claude_enhancer_queue_size`: Hooké˜Ÿåˆ—å¤§å°

### ç³»ç»Ÿèµ„æºæŒ‡æ ‡
- `claude_enhancer_cpu_usage_percent`: CPUä½¿ç”¨ç‡
- `claude_enhancer_memory_usage_percent`: å†…å­˜ä½¿ç”¨ç‡
- `claude_enhancer_disk_usage_percent`: ç£ç›˜ä½¿ç”¨ç‡

### ä¸šåŠ¡æŒ‡æ ‡
- HookæˆåŠŸç‡å’Œé”™è¯¯ç‡
- P50/P95/P99å»¶è¿Ÿç»Ÿè®¡
- ååé‡å’ŒQPS
- æ€§èƒ½è¶‹åŠ¿åˆ†æ

## ğŸš¨ å‘Šè­¦è§„åˆ™

### æ€§èƒ½å‘Šè­¦
- **é«˜å»¶è¿Ÿå‘Šè­¦**: P95å»¶è¿Ÿ > 5ç§’ (Warning) / 10ç§’ (Critical)
- **é«˜é”™è¯¯ç‡å‘Šè­¦**: é”™è¯¯ç‡ > 5% (Warning) / 20% (Critical)
- **Hookå¤±è´¥å‘Šè­¦**: 5åˆ†é’Ÿå†…å¤±è´¥3æ¬¡ä»¥ä¸Š
- **æ€§èƒ½ä¸‹é™å‘Šè­¦**: å»¶è¿ŸæŒç»­å¢é•¿è¶…è¿‡é˜ˆå€¼

### èµ„æºå‘Šè­¦
- **é«˜CPUä½¿ç”¨ç‡**: > 80% (Warning) / 95% (Critical)
- **é«˜å†…å­˜ä½¿ç”¨ç‡**: > 85% (Warning) / 95% (Critical)
- **é«˜ç£ç›˜ä½¿ç”¨ç‡**: > 80% (Warning) / 90% (Critical)

### æœåŠ¡å‘Šè­¦
- **æœåŠ¡å®•æœºå‘Šè­¦**: ç›‘æ§æœåŠ¡ä¸å¯è¾¾
- **å¥åº·æ£€æŸ¥å¤±è´¥**: ç«¯ç‚¹å¥åº·æ£€æŸ¥å¤±è´¥
- **æ•°æ®æ”¶é›†åœæ­¢**: è¶…è¿‡5åˆ†é’Ÿæœªæ”¶é›†åˆ°æ•°æ®

## ğŸ”§ é…ç½®è¯´æ˜

### ç›‘æ§é…ç½®
ç¼–è¾‘ `monitoring_config.yaml` è°ƒæ•´ç›‘æ§å‚æ•°:
```yaml
monitoring:
  enabled: true
  metrics_interval: 5  # æŒ‡æ ‡æ”¶é›†é—´éš”(ç§’)
  data_retention_days: 7  # æ•°æ®ä¿ç•™å¤©æ•°

alerts:
  channels:
    console:
      enabled: true
    webhook:
      enabled: false
      url: "your-webhook-url"
```

### å‘Šè­¦é…ç½®
ç¼–è¾‘ `alertmanager.claude.yml` é…ç½®å‘Šè­¦é€šçŸ¥:
```yaml
receivers:
  - name: 'claude-enhancer-alerts'
    slack_configs:
      - api_url: '${SLACK_WEBHOOK_URL}'
        channel: '#alerts'
```

### Dashboardé…ç½®
- Grafana Dashboard: å¯¼å…¥ `grafana_dashboard.json`
- è‡ªå®šä¹‰æŒ‡æ ‡: ç¼–è¾‘ `prometheus.claude.yml`
- è®°å½•è§„åˆ™: ç¼–è¾‘ `alert_rules.claude.yml`

## ğŸ“ˆ ä½¿ç”¨åœºæ™¯

### 1. å®æ—¶ç›‘æ§
- åœ¨Dashboardä¸Šå®æ—¶æŸ¥çœ‹Hookæ‰§è¡ŒçŠ¶æ€
- ç›‘æ§ç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µ
- è§‚å¯Ÿæ€§èƒ½æŒ‡æ ‡å˜åŒ–è¶‹åŠ¿

### 2. æ€§èƒ½ä¼˜åŒ–
- è¯†åˆ«æ‰§è¡Œæ…¢çš„Hook
- åˆ†ææ€§èƒ½ç“¶é¢ˆ
- ä¼˜åŒ–Hookæ‰§è¡Œç­–ç•¥

### 3. æ•…éšœæ’æŸ¥
- å¿«é€Ÿå®šä½é—®é¢˜Hook
- æŸ¥çœ‹é”™è¯¯æ—¥å¿—å’Œå †æ ˆ
- åˆ†ææ•…éšœæ—¶é—´çº¿

### 4. å®¹é‡è§„åˆ’
- åŸºäºå†å²æ•°æ®é¢„æµ‹èµ„æºéœ€æ±‚
- åˆ¶å®šæ‰©å®¹è®¡åˆ’
- ä¼˜åŒ–èµ„æºé…ç½®

## ğŸ” æ•…éšœæ’æŸ¥

### å¸¸è§é—®é¢˜

1. **ç›‘æ§æœåŠ¡æ— æ³•å¯åŠ¨**
   ```bash
   # æ£€æŸ¥ç«¯å£å ç”¨
   ./deploy_monitoring.sh status

   # æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
   ./deploy_monitoring.sh logs
   ```

2. **æŒ‡æ ‡æ•°æ®ç¼ºå¤±**
   ```bash
   # æ£€æŸ¥Hookæ€§èƒ½æ—¥å¿—
   tail -f .claude/logs/performance.log

   # æ£€æŸ¥æ”¶é›†å™¨çŠ¶æ€
   ./deploy_monitoring.sh logs performance-collector
   ```

3. **å‘Šè­¦ä¸å·¥ä½œ**
   ```bash
   # æ£€æŸ¥AlertManageré…ç½®
   curl http://localhost:9093/api/v1/status

   # æ£€æŸ¥å‘Šè­¦è§„åˆ™
   curl http://localhost:9090/api/v1/rules
   ```

### è°ƒè¯•æ¨¡å¼
å¯ç”¨è°ƒè¯•æ¨¡å¼è·å–æ›´å¤šä¿¡æ¯:
```bash
# ä¿®æ”¹é…ç½®æ–‡ä»¶
vim monitoring_config.yaml

debug:
  enabled: true
  verbose_logging: true
```

## ğŸ“š æ‰©å±•å¼€å‘

### è‡ªå®šä¹‰æŒ‡æ ‡
æ·»åŠ æ–°çš„ç›‘æ§æŒ‡æ ‡:
```python
# åœ¨ claude_enhancer_monitor.py ä¸­æ·»åŠ 
custom_metric = Counter(
    'claude_enhancer_custom_metric',
    'Custom metric description',
    ['label1', 'label2']
)
```

### è‡ªå®šä¹‰å‘Šè­¦
æ·»åŠ æ–°çš„å‘Šè­¦è§„åˆ™:
```yaml
# åœ¨ alert_rules.claude.yml ä¸­æ·»åŠ 
- alert: CustomAlert
  expr: custom_metric > threshold
  for: 5m
  labels:
    severity: warning
  annotations:
    summary: "Custom alert description"
```

### è‡ªå®šä¹‰Dashboard
åˆ›å»ºæ–°çš„Grafanaé¢æ¿:
1. è®¿é—® http://localhost:3001
2. åˆ›å»ºæ–°Dashboard
3. æ·»åŠ Panelå’ŒæŸ¥è¯¢
4. å¯¼å‡ºJSONé…ç½®

## ğŸ¤ è´¡çŒ®æŒ‡å—

### å¼€å‘ç¯å¢ƒ
```bash
# å®‰è£…å¼€å‘ä¾èµ–
pip install -r requirements.monitor.txt

# è¿è¡Œç›‘æ§åº”ç”¨
python claude_enhancer_monitor.py

# è¿è¡Œæ€§èƒ½æ”¶é›†å™¨
python performance_collector.py
```

### æµ‹è¯•
```bash
# è¿è¡Œé›†æˆæµ‹è¯•
./deploy_monitoring.sh deploy
./deploy_monitoring.sh status

# ç”Ÿæˆæµ‹è¯•æ•°æ®
python test_data_generator.py
```

## ğŸ“„ è®¸å¯è¯

MIT License - è¯¦è§ LICENSE æ–‡ä»¶

## ğŸ†˜ æ”¯æŒ

- é—®é¢˜æŠ¥å‘Š: è¯·åœ¨é¡¹ç›®Issuesä¸­æäº¤
- åŠŸèƒ½è¯·æ±‚: è¯·åœ¨é¡¹ç›®Discussionsä¸­è®¨è®º
- æ–‡æ¡£æ”¹è¿›: æ¬¢è¿æäº¤PR

---

**Claude Enhancer ç›‘æ§ç³»ç»Ÿ** - è®©ä½ çš„Hookæ‰§è¡Œæ¸…æ™°å¯è§ï¼Œæ€§èƒ½ä¼˜åŒ–æœ‰æ®å¯ä¾ï¼ ğŸš€
# Automation Permission Whitelist
# Format: user:operation:resource
# Wildcards: * matches any value
# Comments: Lines starting with # are ignored

# ============================================================
# CI/CD AUTOMATION
# ============================================================

# GitHub Actions (full automation access)
github-actions:*:*

# CI runners
ci-bot:auto_commit:*
ci-bot:auto_push:*
ci-bot:git_*:*

# ============================================================
# CLAUDE AUTOMATION (Restrictive)
# ============================================================

# Claude can commit to feature branches only
*:auto_commit:feature/*
*:auto_commit:bugfix/*
*:auto_commit:docs/*
*:auto_commit:perf/*
*:auto_commit:experiment/*

# Claude cannot push to main/master
# (must be explicitly granted via database)
# *:auto_push:main  # FORBIDDEN
# *:auto_push:master  # FORBIDDEN

# Claude can create PRs for any branch
*:auto_pr:*

# ============================================================
# SAFE OPERATIONS (Always allowed)
# ============================================================

# Read-only git operations
*:git_status:*
*:git_log:*
*:git_diff:*
*:git_fetch:*
*:git_branch:*

# Quality checks
*:lint:*
*:test:*
*:quality_check:*

# ============================================================
# SECURITY OPERATIONS (Limited)
# ============================================================

# Owner operations monitoring (owner only)
# Handled by is_repository_owner() function

# Audit log access (read-only for all)
*:audit_read:*

# Permission checks (allowed for all)
*:permission_check:*

# ============================================================
# EXAMPLES & DOCUMENTATION
# ============================================================

# Example: Grant specific user full access
# alice:*:*

# Example: Grant user access to specific operation
# bob:git_push:feature/user-auth

# Example: Grant user access with wildcard pattern
# charlie:auto_commit:feature/payment-*

# Example: Deny by omission (not listed = denied)
# No entry for "auto_push:main" = denied for all users

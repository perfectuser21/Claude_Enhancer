{
  "total_coupling_points": 978,
  "files_analyzed": 109,
  "high_coupling_files": {
    "test_git_hooks_integration.py": 27,
    "test_perfect21_comprehensive.py": 11,
    "test_api_interface_complete.py": 13,
    "api/validators.py": 15,
    "api/rest_server.py": 9,
    "api/auth_api.py": 13,
    "tests/quick_test_fixes.py": 13,
    "tests/load_test_auth_api.py": 19,
    "tests/test_git_hooks.py": 57,
    "tests/enhanced_conftest.py": 12,
    "tests/test_auth_api_comprehensive.py": 49,
    "tests/test_workflow_orchestrator.py": 29,
    "tests/test_auth_api.py": 11,
    "tests/conftest.py": 8,
    "tests/unit/test_cli.py": 12,
    "tests/unit/test_workflow_orchestrator.py": 52,
    "tests/e2e/test_development_workflow.py": 33,
    "tests/plugins/performance.py": 12,
    "tests/plugins/database.py": 23,
    "tests/plugins/security.py": 11,
    "modules/database.py": 31,
    "modules/cache.py": 7,
    "modules/plugin_system.py": 6,
    "scripts/start_api.py": 16,
    "features/smart_decomposer.py": 21,
    "features/auth_api/user_login_api.py": 35,
    "features/auth_api/test_auth_api.py": 21,
    "features/capability_discovery/orchestrator_bridge.py": 7,
    "features/execution_supervisor/reminder.py": 6,
    "features/version_manager/semantic_version.py": 11,
    "features/sync_point_manager/sync_points.py": 6,
    "features/git_workflow/branch_manager.py": 17,
    "features/git_workflow/hooks.py": 26,
    "features/git_workflow/workflow.py": 10,
    "features/git_workflow/config_loader.py": 35,
    "features/git_workflow/hooks_manager.py": 29,
    "features/git_workflow/plugins/base_plugin.py": 6,
    "main/perfect21.py": 17,
    "main/cli.py": 30,
    "application/cli/commands/hooks_command.py": 9,
    "application/cli/commands/parallel_command.py": 9,
    "infrastructure/config/config_manager.py": 6,
    "infrastructure/git/hooks_optimized.py": 23
  },
  "coupling_by_type": {
    "by_type": {
      "subagent_direct_call": 548,
      "perfect21_internal": 93,
      "config_dependency": 221,
      "orchestrator_dependency": 71,
      "git_workflow_coupling": 45
    },
    "by_severity": {
      "medium": 814,
      "low": 92,
      "high": 71,
      "critical": 1
    },
    "critical_files": [
      "main/cli.py"
    ],
    "high_coupling_areas": [
      "subagent_direct_call",
      "perfect21_internal",
      "config_dependency",
      "orchestrator_dependency",
      "git_workflow_coupling"
    ]
  },
  "decoupling_recommendations": [
    {
      "priority": "P0",
      "title": "实现抽象接口层",
      "description": "创建IClaudeCodeAdapter接口，将Perfect21与Claude Code解耦",
      "implementation": "\n# 创建抽象接口\nclass IClaudeCodeAdapter(ABC):\n    @abstractmethod\n    def execute_subagent(self, agent_type: str, prompt: str) -> Dict[str, Any]:\n        pass\n\n    @abstractmethod\n    def get_available_agents(self) -> List[str]:\n        pass\n\n# Perfect21通过接口调用\nclass Perfect21Core:\n    def __init__(self, claude_adapter: IClaudeCodeAdapter):\n        self.claude_adapter = claude_adapter\n",
      "benefits": [
        "完全解耦",
        "易于测试",
        "支持不同实现"
      ]
    },
    {
      "priority": "P1",
      "title": "引入事件驱动架构",
      "description": "使用事件总线替代直接调用，实现松耦合",
      "implementation": "\n# 事件总线\nclass EventBus:\n    def __init__(self):\n        self.subscribers = {}\n\n    def publish(self, event_type: str, data: Any):\n        for handler in self.subscribers.get(event_type, []):\n            handler(data)\n\n    def subscribe(self, event_type: str, handler: Callable):\n        if event_type not in self.subscribers:\n            self.subscribers[event_type] = []\n        self.subscribers[event_type].append(handler)\n\n# Perfect21作为事件发布者\nclass Perfect21EventPublisher:\n    def request_agent_execution(self, agent_type: str, prompt: str):\n        self.event_bus.publish('agent_execution_requested', {\n            'agent_type': agent_type,\n            'prompt': prompt\n        })\n",
      "benefits": [
        "松耦合",
        "异步执行",
        "易于扩展"
      ]
    },
    {
      "priority": "P2",
      "title": "模块化插件系统",
      "description": "将功能模块设计为可插拔的插件",
      "implementation": "\n# 插件基类\nclass Perfect21Plugin(ABC):\n    @abstractmethod\n    def initialize(self, context: Dict[str, Any]) -> bool:\n        pass\n\n    @abstractmethod\n    def execute(self, request: Dict[str, Any]) -> Dict[str, Any]:\n        pass\n\n# 插件管理器\nclass PluginManager:\n    def __init__(self):\n        self.plugins = {}\n\n    def load_plugin(self, name: str, plugin: Perfect21Plugin):\n        self.plugins[name] = plugin\n        plugin.initialize(self.get_context())\n\n    def execute_plugin(self, name: str, request: Dict[str, Any]):\n        return self.plugins[name].execute(request)\n",
      "benefits": [
        "模块化",
        "按需加载",
        "独立开发"
      ]
    },
    {
      "priority": "P2",
      "title": "配置驱动的适配器模式",
      "description": "通过配置文件定义Claude Code集成方式",
      "implementation": "\n# 配置文件 claude_code_adapter.yaml\nclaude_code:\n  adapter_type: \"direct\"  # direct, proxy, mock\n  agent_mapping:\n    backend-architect: \"core.agents.backend_architect\"\n    frontend-specialist: \"core.agents.frontend_specialist\"\n\n# 配置驱动适配器\nclass ConfigDrivenAdapter:\n    def __init__(self, config_path: str):\n        self.config = self.load_config(config_path)\n\n    def execute_subagent(self, agent_type: str, prompt: str):\n        adapter_type = self.config['claude_code']['adapter_type']\n        if adapter_type == 'direct':\n            return self.direct_execution(agent_type, prompt)\n        elif adapter_type == 'proxy':\n            return self.proxy_execution(agent_type, prompt)\n",
      "benefits": [
        "灵活配置",
        "环境适配",
        "零代码切换"
      ]
    }
  ],
  "detailed_coupling_points": [
    {
      "file": "test_claude_code_coupling.py",
      "line": 15,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "test_claude_code_coupling.py",
      "line": 210,
      "type": "subagent_direct_call",
      "description": "@abstractmethod",
      "severity": "medium"
    },
    {
      "file": "test_claude_code_coupling.py",
      "line": 214,
      "type": "subagent_direct_call",
      "description": "@abstractmethod",
      "severity": "medium"
    },
    {
      "file": "test_claude_code_coupling.py",
      "line": 267,
      "type": "subagent_direct_call",
      "description": "@abstractmethod",
      "severity": "medium"
    },
    {
      "file": "test_claude_code_coupling.py",
      "line": 271,
      "type": "subagent_direct_call",
      "description": "@abstractmethod",
      "severity": "medium"
    },
    {
      "file": "test_git_hooks_integration.py",
      "line": 44,
      "type": "perfect21_internal",
      "description": "from features.git_workflow.hooks_manager import GitHooksManager",
      "severity": "low"
    },
    {
      "file": "test_git_hooks_integration.py",
      "line": 56,
      "type": "config_dependency",
      "description": "for hook_name, config in hooks_manager.hooks_config.items():",
      "severity": "medium"
    },
    {
      "file": "test_git_hooks_integration.py",
      "line": 57,
      "type": "config_dependency",
      "description": "if config.get('required'):",
      "severity": "medium"
    },
    {
      "file": "test_git_hooks_integration.py",
      "line": 81,
      "type": "perfect21_internal",
      "description": "from features.git_workflow.hooks_manager import GitHooksManager",
      "severity": "low"
    },
    {
      "file": "test_git_hooks_integration.py",
      "line": 252,
      "type": "subagent_direct_call",
      "description": "'suggested_agent': '@orchestrator'",
      "severity": "medium"
    },
    {
      "file": "test_git_hooks_integration.py",
      "line": 259,
      "type": "subagent_direct_call",
      "description": "'suggested_agent': '@code-reviewer'",
      "severity": "medium"
    },
    {
      "file": "test_git_hooks_integration.py",
      "line": 266,
      "type": "subagent_direct_call",
      "description": "'suggested_agent': '@deployment-manager'",
      "severity": "medium"
    },
    {
      "file": "test_git_hooks_integration.py",
      "line": 273,
      "type": "subagent_direct_call",
      "description": "'suggested_agent': '@test-engineer'",
      "severity": "medium"
    },
    {
      "file": "test_git_hooks_integration.py",
      "line": 280,
      "type": "subagent_direct_call",
      "description": "'suggested_agent': '@code-reviewer'",
      "severity": "medium"
    },
    {
      "file": "test_git_hooks_integration.py",
      "line": 286,
      "type": "subagent_direct_call",
      "description": "'main': '@orchestrator',",
      "severity": "medium"
    },
    {
      "file": "test_git_hooks_integration.py",
      "line": 287,
      "type": "subagent_direct_call",
      "description": "'feature': '@code-reviewer',",
      "severity": "medium"
    },
    {
      "file": "test_git_hooks_integration.py",
      "line": 288,
      "type": "subagent_direct_call",
      "description": "'release': '@deployment-manager',",
      "severity": "medium"
    },
    {
      "file": "test_git_hooks_integration.py",
      "line": 289,
      "type": "subagent_direct_call",
      "description": "'hotfix': '@test-engineer'",
      "severity": "medium"
    },
    {
      "file": "test_git_hooks_integration.py",
      "line": 291,
      "type": "subagent_direct_call",
      "description": "return agent_mapping.get(branch_type, '@code-reviewer')",
      "severity": "medium"
    },
    {
      "file": "test_git_hooks_integration.py",
      "line": 307,
      "type": "subagent_direct_call",
      "description": "'primary_agent': '@orchestrator',",
      "severity": "medium"
    },
    {
      "file": "test_git_hooks_integration.py",
      "line": 308,
      "type": "subagent_direct_call",
      "description": "'supporting_agents': ['@code-reviewer', '@security-auditor', '@test-engineer'],",
      "severity": "medium"
    },
    {
      "file": "test_git_hooks_integration.py",
      "line": 312,
      "type": "subagent_direct_call",
      "description": "'primary_agent': '@code-reviewer',",
      "severity": "medium"
    },
    {
      "file": "test_git_hooks_integration.py",
      "line": 313,
      "type": "subagent_direct_call",
      "description": "'supporting_agents': ['@test-engineer'],",
      "severity": "medium"
    },
    {
      "file": "test_git_hooks_integration.py",
      "line": 317,
      "type": "subagent_direct_call",
      "description": "'primary_agent': '@security-auditor',",
      "severity": "medium"
    },
    {
      "file": "test_git_hooks_integration.py",
      "line": 318,
      "type": "subagent_direct_call",
      "description": "'supporting_agents': ['@code-reviewer'],",
      "severity": "medium"
    },
    {
      "file": "test_git_hooks_integration.py",
      "line": 322,
      "type": "subagent_direct_call",
      "description": "'primary_agent': '@performance-engineer',",
      "severity": "medium"
    },
    {
      "file": "test_git_hooks_integration.py",
      "line": 323,
      "type": "subagent_direct_call",
      "description": "'supporting_agents': ['@test-engineer', '@devops-engineer'],",
      "severity": "medium"
    },
    {
      "file": "test_git_hooks_integration.py",
      "line": 418,
      "type": "perfect21_internal",
      "description": "from features.auto_capability_injection import get_global_injector",
      "severity": "low"
    },
    {
      "file": "test_git_hooks_integration.py",
      "line": 557,
      "type": "config_dependency",
      "description": "if not config.get('success', True):",
      "severity": "medium"
    },
    {
      "file": "test_git_hooks_integration.py",
      "line": 558,
      "type": "config_dependency",
      "description": "report += f\"❌ 配置测试失败: {config.get('error', '未知错误')}\\n\"",
      "severity": "medium"
    },
    {
      "file": "test_git_hooks_integration.py",
      "line": 560,
      "type": "config_dependency",
      "description": "report += f\"✅ 发现{config.get('total_hooks', 0)}个钩子配置\\n\"",
      "severity": "medium"
    },
    {
      "file": "test_git_hooks_integration.py",
      "line": 561,
      "type": "config_dependency",
      "description": "report += f\"✅ {len(config.get('hook_groups', []))}个钩子组可用\\n\"",
      "severity": "medium"
    },
    {
      "file": "show_status.py",
      "line": 76,
      "type": "perfect21_internal",
      "description": "from features.dev_templates_simple import DevTemplates",
      "severity": "low"
    },
    {
      "file": "test_architecture_performance.py",
      "line": 19,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "test_architecture_performance.py",
      "line": 39,
      "type": "orchestrator_dependency",
      "description": "('workflow_orchestrator', 'features.workflow_orchestrator.orchestrator'),",
      "severity": "high"
    },
    {
      "file": "test_architecture_performance.py",
      "line": 43,
      "type": "orchestrator_dependency",
      "description": "('task_manager', 'features.workflow_orchestrator.task_manager'),",
      "severity": "high"
    },
    {
      "file": "test_perfect21_comprehensive.py",
      "line": 124,
      "type": "perfect21_internal",
      "description": "from features.capability_discovery import bootstrap_capability_discovery",
      "severity": "low"
    },
    {
      "file": "test_perfect21_comprehensive.py",
      "line": 163,
      "type": "perfect21_internal",
      "description": "from features.auto_capability_injection import get_global_injector, auto_inject_and_call",
      "severity": "low"
    },
    {
      "file": "test_perfect21_comprehensive.py",
      "line": 185,
      "type": "subagent_direct_call",
      "description": "self.assertTrue(injection_result.get('ready_for_task_call'), \"@orchestrator调用应准备就绪\")",
      "severity": "medium"
    },
    {
      "file": "test_perfect21_comprehensive.py",
      "line": 215,
      "type": "subagent_direct_call",
      "description": "# 测试@orchestrator对话准备",
      "severity": "medium"
    },
    {
      "file": "test_perfect21_comprehensive.py",
      "line": 237,
      "type": "subagent_direct_call",
      "description": "self.assertIsInstance(orchestrator_call, str, \"@orchestrator调用内容应为字符串\")",
      "severity": "medium"
    },
    {
      "file": "test_perfect21_comprehensive.py",
      "line": 288,
      "type": "perfect21_internal",
      "description": "from features.git_workflow.hooks_manager import GitHooksManager",
      "severity": "low"
    },
    {
      "file": "test_perfect21_comprehensive.py",
      "line": 320,
      "type": "perfect21_internal",
      "description": "from features.version_manager import get_global_version_manager",
      "severity": "low"
    },
    {
      "file": "test_perfect21_comprehensive.py",
      "line": 438,
      "type": "orchestrator_dependency",
      "description": "'orchestrator.md',",
      "severity": "high"
    },
    {
      "file": "test_perfect21_comprehensive.py",
      "line": 491,
      "type": "perfect21_internal",
      "description": "from features.capability_discovery import bootstrap_capability_discovery",
      "severity": "low"
    },
    {
      "file": "test_perfect21_comprehensive.py",
      "line": 497,
      "type": "perfect21_internal",
      "description": "from features.auto_capability_injection import auto_inject_and_call",
      "severity": "low"
    },
    {
      "file": "test_perfect21_comprehensive.py",
      "line": 564,
      "type": "perfect21_internal",
      "description": "from features.orchestrator_integration import Perfect21Capabilities",
      "severity": "low"
    },
    {
      "file": "test_optimized_architecture.py",
      "line": 72,
      "type": "config_dependency",
      "description": "from infrastructure.config.config_manager import ConfigManager",
      "severity": "medium"
    },
    {
      "file": "test_api_interface_complete.py",
      "line": 139,
      "type": "subagent_direct_call",
      "description": "'has_instructions': '你现在是@orchestrator' in orchestrator_call,",
      "severity": "medium"
    },
    {
      "file": "test_api_interface_complete.py",
      "line": 163,
      "type": "perfect21_internal",
      "description": "from features.auto_capability_injection import (",
      "severity": "low"
    },
    {
      "file": "test_api_interface_complete.py",
      "line": 233,
      "type": "perfect21_internal",
      "description": "from features.git_workflow.hooks_manager import GitHooksManager",
      "severity": "low"
    },
    {
      "file": "test_api_interface_complete.py",
      "line": 275,
      "type": "config_dependency",
      "description": "for hook_name, config in hooks_manager.hooks_config.items():",
      "severity": "medium"
    },
    {
      "file": "test_api_interface_complete.py",
      "line": 304,
      "type": "subagent_direct_call",
      "description": "'expected_agents': ['@backend-architect', '@frontend-developer', '@database-designer'],",
      "severity": "medium"
    },
    {
      "file": "test_api_interface_complete.py",
      "line": 309,
      "type": "subagent_direct_call",
      "description": "'expected_agents': ['@security-auditor', '@code-reviewer'],",
      "severity": "medium"
    },
    {
      "file": "test_api_interface_complete.py",
      "line": 314,
      "type": "subagent_direct_call",
      "description": "'expected_agents': ['@performance-engineer', '@devops-engineer'],",
      "severity": "medium"
    },
    {
      "file": "test_api_interface_complete.py",
      "line": 319,
      "type": "subagent_direct_call",
      "description": "'expected_agents': ['@orchestrator', '@code-reviewer', '@test-engineer'],",
      "severity": "medium"
    },
    {
      "file": "test_api_interface_complete.py",
      "line": 324,
      "type": "perfect21_internal",
      "description": "from features.auto_capability_injection import get_global_injector",
      "severity": "low"
    },
    {
      "file": "test_api_interface_complete.py",
      "line": 400,
      "type": "perfect21_internal",
      "description": "from features.auto_capability_injection import auto_inject_and_call",
      "severity": "low"
    },
    {
      "file": "test_api_interface_complete.py",
      "line": 486,
      "type": "perfect21_internal",
      "description": "from features.auto_capability_injection import get_global_injector",
      "severity": "low"
    },
    {
      "file": "test_api_interface_complete.py",
      "line": 785,
      "type": "subagent_direct_call",
      "description": "report += \"2. **Orchestrator Gateway正常** - @orchestrator调用机制完整\\n\"",
      "severity": "medium"
    },
    {
      "file": "test_api_interface_complete.py",
      "line": 786,
      "type": "subagent_direct_call",
      "description": "report += \"3. **自动能力注入有效** - Perfect21能力自动注入@orchestrator\\n\"",
      "severity": "medium"
    },
    {
      "file": "test_backend_complete.py",
      "line": 18,
      "type": "perfect21_internal",
      "description": "from features.auth_system import AuthManager",
      "severity": "low"
    },
    {
      "file": "test_backend_complete.py",
      "line": 34,
      "type": "subagent_direct_call",
      "description": "\"email\": \"test@example.com\",",
      "severity": "medium"
    },
    {
      "file": "test_backend_complete.py",
      "line": 234,
      "type": "perfect21_internal",
      "description": "from features.auth_system.security_service import SecurityService",
      "severity": "low"
    },
    {
      "file": "test_backend_complete.py",
      "line": 248,
      "type": "subagent_direct_call",
      "description": "email_result = security_service.validate_email(\"test@example.com\")",
      "severity": "medium"
    },
    {
      "file": "test_backend_complete.py",
      "line": 283,
      "type": "perfect21_internal",
      "description": "from features.auth_system.token_manager import TokenManager",
      "severity": "low"
    },
    {
      "file": "__init__.py",
      "line": 29,
      "type": "perfect21_internal",
      "description": "from features.git_workflow import GitHooks, WorkflowManager, BranchManager",
      "severity": "low"
    },
    {
      "file": "api/rate_limiter.py",
      "line": 148,
      "type": "subagent_direct_call",
      "description": "@wraps(func)",
      "severity": "medium"
    },
    {
      "file": "api/rate_limiter.py",
      "line": 198,
      "type": "subagent_direct_call",
      "description": "@wraps(func)",
      "severity": "medium"
    },
    {
      "file": "api/rate_limiter.py",
      "line": 315,
      "type": "subagent_direct_call",
      "description": "@app.middleware(\"http\")",
      "severity": "medium"
    },
    {
      "file": "api/middleware.py",
      "line": 18,
      "type": "perfect21_internal",
      "description": "from features.auth_system import AuthManager",
      "severity": "low"
    },
    {
      "file": "api/validators.py",
      "line": 40,
      "type": "subagent_direct_call",
      "description": "@staticmethod",
      "severity": "medium"
    },
    {
      "file": "api/validators.py",
      "line": 52,
      "type": "subagent_direct_call",
      "description": "@staticmethod",
      "severity": "medium"
    },
    {
      "file": "api/validators.py",
      "line": 63,
      "type": "subagent_direct_call",
      "description": "@staticmethod",
      "severity": "medium"
    },
    {
      "file": "api/validators.py",
      "line": 85,
      "type": "subagent_direct_call",
      "description": "@validator('username')",
      "severity": "medium"
    },
    {
      "file": "api/validators.py",
      "line": 102,
      "type": "subagent_direct_call",
      "description": "@validator('password')",
      "severity": "medium"
    },
    {
      "file": "api/validators.py",
      "line": 132,
      "type": "subagent_direct_call",
      "description": "@validator('email')",
      "severity": "medium"
    },
    {
      "file": "api/validators.py",
      "line": 143,
      "type": "subagent_direct_call",
      "description": "@validator('confirm_password')",
      "severity": "medium"
    },
    {
      "file": "api/validators.py",
      "line": 154,
      "type": "subagent_direct_call",
      "description": "@validator('token')",
      "severity": "medium"
    },
    {
      "file": "api/validators.py",
      "line": 171,
      "type": "subagent_direct_call",
      "description": "@validator('refresh_token')",
      "severity": "medium"
    },
    {
      "file": "api/validators.py",
      "line": 186,
      "type": "subagent_direct_call",
      "description": "@validator('email')",
      "severity": "medium"
    },
    {
      "file": "api/validators.py",
      "line": 201,
      "type": "subagent_direct_call",
      "description": "@validator('new_password')",
      "severity": "medium"
    },
    {
      "file": "api/validators.py",
      "line": 217,
      "type": "subagent_direct_call",
      "description": "@validator('confirm_password')",
      "severity": "medium"
    },
    {
      "file": "api/validators.py",
      "line": 231,
      "type": "subagent_direct_call",
      "description": "@validator('sort_by')",
      "severity": "medium"
    },
    {
      "file": "api/validators.py",
      "line": 250,
      "type": "subagent_direct_call",
      "description": "@validator('query')",
      "severity": "medium"
    },
    {
      "file": "api/validators.py",
      "line": 262,
      "type": "subagent_direct_call",
      "description": "@validator('fields')",
      "severity": "medium"
    },
    {
      "file": "api/rest_server.py",
      "line": 93,
      "type": "subagent_direct_call",
      "description": "@app.get(\"/\")",
      "severity": "medium"
    },
    {
      "file": "api/rest_server.py",
      "line": 114,
      "type": "subagent_direct_call",
      "description": "@app.get(\"/health\", response_model=StatusResponse)",
      "severity": "medium"
    },
    {
      "file": "api/rest_server.py",
      "line": 134,
      "type": "subagent_direct_call",
      "description": "@app.post(\"/task\", response_model=TaskResponse)",
      "severity": "medium"
    },
    {
      "file": "api/rest_server.py",
      "line": 153,
      "type": "subagent_direct_call",
      "description": "@app.post(\"/task/async\", response_model=TaskResponse)",
      "severity": "medium"
    },
    {
      "file": "api/rest_server.py",
      "line": 186,
      "type": "subagent_direct_call",
      "description": "@app.get(\"/task/{task_id}\", response_model=TaskResponse)",
      "severity": "medium"
    },
    {
      "file": "api/rest_server.py",
      "line": 208,
      "type": "subagent_direct_call",
      "description": "@app.post(\"/workflow\")",
      "severity": "medium"
    },
    {
      "file": "api/rest_server.py",
      "line": 229,
      "type": "subagent_direct_call",
      "description": "@app.post(\"/hooks/install\")",
      "severity": "medium"
    },
    {
      "file": "api/rest_server.py",
      "line": 247,
      "type": "subagent_direct_call",
      "description": "@app.get(\"/status\")",
      "severity": "medium"
    },
    {
      "file": "api/rest_server.py",
      "line": 262,
      "type": "subagent_direct_call",
      "description": "@app.websocket(\"/ws/task\")",
      "severity": "medium"
    },
    {
      "file": "api/auth_api.py",
      "line": 18,
      "type": "perfect21_internal",
      "description": "from features.auth_system import AuthManager",
      "severity": "low"
    },
    {
      "file": "api/auth_api.py",
      "line": 141,
      "type": "subagent_direct_call",
      "description": "@auth_router.post(\"/register\", response_model=RegisterResponse)",
      "severity": "medium"
    },
    {
      "file": "api/auth_api.py",
      "line": 173,
      "type": "subagent_direct_call",
      "description": "@auth_router.post(\"/login\", response_model=LoginResponse)",
      "severity": "medium"
    },
    {
      "file": "api/auth_api.py",
      "line": 219,
      "type": "subagent_direct_call",
      "description": "@auth_router.post(\"/logout\", response_model=ApiResponse)",
      "severity": "medium"
    },
    {
      "file": "api/auth_api.py",
      "line": 241,
      "type": "subagent_direct_call",
      "description": "@auth_router.post(\"/refresh\", response_model=RefreshResponse)",
      "severity": "medium"
    },
    {
      "file": "api/auth_api.py",
      "line": 274,
      "type": "subagent_direct_call",
      "description": "@auth_router.get(\"/verify\", response_model=ApiResponse)",
      "severity": "medium"
    },
    {
      "file": "api/auth_api.py",
      "line": 282,
      "type": "subagent_direct_call",
      "description": "@auth_router.get(\"/profile\", response_model=UserResponse)",
      "severity": "medium"
    },
    {
      "file": "api/auth_api.py",
      "line": 314,
      "type": "subagent_direct_call",
      "description": "@auth_router.put(\"/profile\", response_model=ApiResponse)",
      "severity": "medium"
    },
    {
      "file": "api/auth_api.py",
      "line": 345,
      "type": "subagent_direct_call",
      "description": "@auth_router.post(\"/change-password\", response_model=ApiResponse)",
      "severity": "medium"
    },
    {
      "file": "api/auth_api.py",
      "line": 372,
      "type": "subagent_direct_call",
      "description": "@auth_router.get(\"/me\", response_model=UserResponse)",
      "severity": "medium"
    },
    {
      "file": "api/auth_api.py",
      "line": 393,
      "type": "subagent_direct_call",
      "description": "@auth_router.get(\"/admin/users\")",
      "severity": "medium"
    },
    {
      "file": "api/auth_api.py",
      "line": 414,
      "type": "subagent_direct_call",
      "description": "@auth_router.get(\"/admin/security/stats\")",
      "severity": "medium"
    },
    {
      "file": "api/auth_api.py",
      "line": 435,
      "type": "subagent_direct_call",
      "description": "@auth_router.get(\"/health\")",
      "severity": "medium"
    },
    {
      "file": "tests/test_execution_supervisor.py",
      "line": 16,
      "type": "perfect21_internal",
      "description": "from features.execution_supervisor import (",
      "severity": "low"
    },
    {
      "file": "tests/test_execution_supervisor.py",
      "line": 22,
      "type": "perfect21_internal",
      "description": "from features.execution_supervisor.supervisor import ExecutionMode",
      "severity": "low"
    },
    {
      "file": "tests/test_execution_supervisor.py",
      "line": 23,
      "type": "perfect21_internal",
      "description": "from features.execution_supervisor.guardian import QualityLevel",
      "severity": "low"
    },
    {
      "file": "tests/quick_test_fixes.py",
      "line": 105,
      "type": "subagent_direct_call",
      "description": "\"email\": \"testpwd@example.com\",",
      "severity": "medium"
    },
    {
      "file": "tests/quick_test_fixes.py",
      "line": 127,
      "type": "subagent_direct_call",
      "description": "\"email\": \"testuser@example.com\",",
      "severity": "medium"
    },
    {
      "file": "tests/quick_test_fixes.py",
      "line": 182,
      "type": "orchestrator_dependency",
      "description": "# orchestrator.py",
      "severity": "high"
    },
    {
      "file": "tests/quick_test_fixes.py",
      "line": 268,
      "type": "orchestrator_dependency",
      "description": "(workflow_dir / \"orchestrator.py\").write_text(orchestrator_content)",
      "severity": "high"
    },
    {
      "file": "tests/quick_test_fixes.py",
      "line": 290,
      "type": "config_dependency",
      "description": "'agent': task_config.get('agent'),",
      "severity": "medium"
    },
    {
      "file": "tests/quick_test_fixes.py",
      "line": 291,
      "type": "config_dependency",
      "description": "'description': task_config.get('description'),",
      "severity": "medium"
    },
    {
      "file": "tests/quick_test_fixes.py",
      "line": 292,
      "type": "config_dependency",
      "description": "'priority': task_config.get('priority', 'medium'),",
      "severity": "medium"
    },
    {
      "file": "tests/quick_test_fixes.py",
      "line": 293,
      "type": "config_dependency",
      "description": "'timeout': task_config.get('timeout', 300),",
      "severity": "medium"
    },
    {
      "file": "tests/quick_test_fixes.py",
      "line": 373,
      "type": "config_dependency",
      "description": "'name': sync_config.get('name'),",
      "severity": "medium"
    },
    {
      "file": "tests/quick_test_fixes.py",
      "line": 374,
      "type": "config_dependency",
      "description": "'type': sync_config.get('type'),",
      "severity": "medium"
    },
    {
      "file": "tests/quick_test_fixes.py",
      "line": 375,
      "type": "config_dependency",
      "description": "'criteria': sync_config.get('criteria', []),",
      "severity": "medium"
    },
    {
      "file": "tests/quick_test_fixes.py",
      "line": 376,
      "type": "config_dependency",
      "description": "'timeout': sync_config.get('timeout', 300),",
      "severity": "medium"
    },
    {
      "file": "tests/quick_test_fixes.py",
      "line": 569,
      "type": "subagent_direct_call",
      "description": "'agents_called': ['@backend-architect', '@test-engineer']",
      "severity": "medium"
    },
    {
      "file": "tests/load_test_auth_api.py",
      "line": 21,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "tests/load_test_auth_api.py",
      "line": 31,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "tests/load_test_auth_api.py",
      "line": 58,
      "type": "config_dependency",
      "description": "print(f\"🚀 开始负载测试: {self.config.concurrent_users} 并发用户, {self.config.test_duration} 秒\")",
      "severity": "medium"
    },
    {
      "file": "tests/load_test_auth_api.py",
      "line": 63,
      "type": "config_dependency",
      "description": "semaphore = asyncio.Semaphore(self.config.concurrent_users)",
      "severity": "medium"
    },
    {
      "file": "tests/load_test_auth_api.py",
      "line": 69,
      "type": "config_dependency",
      "description": "total_requests = self.config.target_rps * self.config.test_duration",
      "severity": "medium"
    },
    {
      "file": "tests/load_test_auth_api.py",
      "line": 77,
      "type": "config_dependency",
      "description": "if i > 0 and i % self.config.target_rps == 0:",
      "severity": "medium"
    },
    {
      "file": "tests/load_test_auth_api.py",
      "line": 97,
      "type": "config_dependency",
      "description": "await asyncio.sleep(self.config.think_time)",
      "severity": "medium"
    },
    {
      "file": "tests/load_test_auth_api.py",
      "line": 111,
      "type": "config_dependency",
      "description": "login_url = f\"{self.config.base_url}/api/auth/login\"",
      "severity": "medium"
    },
    {
      "file": "tests/load_test_auth_api.py",
      "line": 113,
      "type": "subagent_direct_call",
      "description": "\"email\": f\"testuser{user_id % 100}@example.com\",",
      "severity": "medium"
    },
    {
      "file": "tests/load_test_auth_api.py",
      "line": 156,
      "type": "config_dependency",
      "description": "{'method': 'GET', 'url': f\"{self.config.base_url}/health\"},",
      "severity": "medium"
    },
    {
      "file": "tests/load_test_auth_api.py",
      "line": 157,
      "type": "config_dependency",
      "description": "{'method': 'GET', 'url': f\"{self.config.base_url}/status\"},",
      "severity": "medium"
    },
    {
      "file": "tests/load_test_auth_api.py",
      "line": 158,
      "type": "config_dependency",
      "description": "{'method': 'GET', 'url': f\"{self.config.base_url}/\"},",
      "severity": "medium"
    },
    {
      "file": "tests/load_test_auth_api.py",
      "line": 223,
      "type": "config_dependency",
      "description": "concurrent_users=self.config.concurrent_users",
      "severity": "medium"
    },
    {
      "file": "tests/load_test_auth_api.py",
      "line": 234,
      "type": "config_dependency",
      "description": "- **目标RPS**: {self.config.target_rps}",
      "severity": "medium"
    },
    {
      "file": "tests/load_test_auth_api.py",
      "line": 235,
      "type": "config_dependency",
      "description": "- **思考时间**: {self.config.think_time}s",
      "severity": "medium"
    },
    {
      "file": "tests/load_test_auth_api.py",
      "line": 253,
      "type": "config_dependency",
      "description": "- **目标RPS**: {self.config.target_rps}",
      "severity": "medium"
    },
    {
      "file": "tests/load_test_auth_api.py",
      "line": 254,
      "type": "config_dependency",
      "description": "- **RPS达成率**: {(result.requests_per_second / self.config.target_rps * 100):.2f}%",
      "severity": "medium"
    },
    {
      "file": "tests/load_test_auth_api.py",
      "line": 287,
      "type": "config_dependency",
      "description": "rps_achievement = (result.requests_per_second / self.config.target_rps) * 100",
      "severity": "medium"
    },
    {
      "file": "tests/load_test_auth_api.py",
      "line": 419,
      "type": "config_dependency",
      "description": "stress_tester = StressTester(config.base_url)",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 17,
      "type": "perfect21_internal",
      "description": "from features.git_workflow.hooks import GitHooks",
      "severity": "low"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 20,
      "type": "git_workflow_coupling",
      "description": "class TestGitHooks(unittest.TestCase):",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 35,
      "type": "git_workflow_coupling",
      "description": "self.git_hooks = GitHooks(project_root=self.temp_dir)",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 40,
      "type": "git_workflow_coupling",
      "description": "self.git_hooks.cleanup()",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 47,
      "type": "git_workflow_coupling",
      "description": "self.assertEqual(self.git_hooks.project_root, self.temp_dir)",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 48,
      "type": "git_workflow_coupling",
      "description": "self.assertIsNotNone(self.git_hooks.subagent_mapping)",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 50,
      "type": "subagent_direct_call",
      "description": "@patch('subprocess.run')",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 59,
      "type": "git_workflow_coupling",
      "description": "status = self.git_hooks.get_git_status()",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 67,
      "type": "subagent_direct_call",
      "description": "@patch('subprocess.run')",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 72,
      "type": "git_workflow_coupling",
      "description": "status = self.git_hooks.get_git_status()",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 81,
      "type": "subagent_direct_call",
      "description": "agents = [\"@project-manager\", \"@business-analyst\"]",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 85,
      "type": "git_workflow_coupling",
      "description": "result = self.git_hooks.generate_parallel_agents_instruction(agents, task, context)",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 90,
      "type": "subagent_direct_call",
      "description": "self.assertIn(\"@project-manager\", result['agents_to_call'])",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 91,
      "type": "subagent_direct_call",
      "description": "self.assertIn(\"@business-analyst\", result['agents_to_call'])",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 104,
      "type": "subagent_direct_call",
      "description": "agents = [\"@test-engineer\"]",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 107,
      "type": "git_workflow_coupling",
      "description": "result = self.git_hooks.generate_parallel_agents_instruction(agents, task)",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 113,
      "type": "subagent_direct_call",
      "description": "@patch.object(GitHooks, 'get_git_status')",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 114,
      "type": "subagent_direct_call",
      "description": "@patch.object(GitHooks, 'generate_parallel_agents_instruction')",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 127,
      "type": "git_workflow_coupling",
      "description": "result = self.git_hooks.pre_commit_hook()",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 133,
      "type": "subagent_direct_call",
      "description": "self.assertIn('@code-reviewer', call_args)",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 136,
      "type": "subagent_direct_call",
      "description": "@patch.object(GitHooks, 'get_git_status')",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 137,
      "type": "subagent_direct_call",
      "description": "@patch.object(GitHooks, 'generate_parallel_agents_instruction')",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 150,
      "type": "git_workflow_coupling",
      "description": "result = self.git_hooks.pre_commit_hook()",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 155,
      "type": "subagent_direct_call",
      "description": "self.assertIn('@code-reviewer', call_args)",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 158,
      "type": "subagent_direct_call",
      "description": "@patch.object(GitHooks, 'get_git_status')",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 159,
      "type": "subagent_direct_call",
      "description": "@patch.object(GitHooks, 'generate_parallel_agents_instruction')",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 166,
      "type": "git_workflow_coupling",
      "description": "result = self.git_hooks.pre_push_hook('origin', 'https://github.com/test/repo.git')",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 170,
      "type": "subagent_direct_call",
      "description": "self.assertIn('@test-engineer', call_args)",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 171,
      "type": "subagent_direct_call",
      "description": "# 注意：feature分支默认只调用@test-engineer",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 173,
      "type": "subagent_direct_call",
      "description": "@patch.object(GitHooks, 'get_git_status')",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 174,
      "type": "subagent_direct_call",
      "description": "@patch.object(GitHooks, 'generate_parallel_agents_instruction')",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 181,
      "type": "git_workflow_coupling",
      "description": "result = self.git_hooks.pre_push_hook('origin', 'https://github.com/test/repo.git')",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 185,
      "type": "subagent_direct_call",
      "description": "self.assertIn('@test-engineer', call_args)",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 186,
      "type": "subagent_direct_call",
      "description": "# 所有分支类型默认都调用@test-engineer进行测试",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 188,
      "type": "subagent_direct_call",
      "description": "@patch.object(GitHooks, 'get_git_status')",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 189,
      "type": "subagent_direct_call",
      "description": "@patch.object(GitHooks, 'generate_parallel_agents_instruction')",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 195,
      "type": "git_workflow_coupling",
      "description": "result = self.git_hooks.post_checkout_hook('old_ref', 'new_ref', '1')",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 200,
      "type": "git_workflow_coupling",
      "description": "self.assertIn(self.git_hooks.subagent_mapping['deployment_check'], call_args)",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 204,
      "type": "git_workflow_coupling",
      "description": "result = self.git_hooks.post_checkout_hook('old_ref', 'new_ref', '0')",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 209,
      "type": "subagent_direct_call",
      "description": "@patch.object(GitHooks, 'get_git_status')",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 210,
      "type": "subagent_direct_call",
      "description": "@patch.object(GitHooks, 'generate_parallel_agents_instruction')",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 211,
      "type": "subagent_direct_call",
      "description": "@patch('subprocess.check_output')",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 218,
      "type": "git_workflow_coupling",
      "description": "result = self.git_hooks.prepare_commit_msg_hook('/tmp/commit_msg')",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 222,
      "type": "subagent_direct_call",
      "description": "self.assertIn('@business-analyst', call_args)",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 224,
      "type": "subagent_direct_call",
      "description": "@patch.object(GitHooks, 'get_git_status')",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 225,
      "type": "subagent_direct_call",
      "description": "@patch.object(GitHooks, 'generate_parallel_agents_instruction')",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 236,
      "type": "git_workflow_coupling",
      "description": "result = self.git_hooks.commit_msg_hook(commit_msg_file)",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 240,
      "type": "subagent_direct_call",
      "description": "self.assertIn('@business-analyst', call_args)",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 242,
      "type": "subagent_direct_call",
      "description": "@patch.object(GitHooks, 'get_git_status')",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 243,
      "type": "subagent_direct_call",
      "description": "@patch.object(GitHooks, 'generate_parallel_agents_instruction')",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 244,
      "type": "subagent_direct_call",
      "description": "@patch('subprocess.check_output')",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 251,
      "type": "git_workflow_coupling",
      "description": "result = self.git_hooks.post_commit_hook()",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 255,
      "type": "subagent_direct_call",
      "description": "self.assertIn('@devops-engineer', call_args)",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 260,
      "type": "git_workflow_coupling",
      "description": "status = self.git_hooks.get_hook_status()",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 269,
      "type": "git_workflow_coupling",
      "description": "self.git_hooks.cleanup()",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 270,
      "type": "git_workflow_coupling",
      "description": "self.assertIsNone(self.git_hooks.project_root)",
      "severity": "medium"
    },
    {
      "file": "tests/test_git_hooks.py",
      "line": 274,
      "type": "git_workflow_coupling",
      "description": "mapping = self.git_hooks.subagent_mapping",
      "severity": "medium"
    },
    {
      "file": "tests/test_phase_executor.py",
      "line": 17,
      "type": "perfect21_internal",
      "description": "from features.phase_executor import (",
      "severity": "low"
    },
    {
      "file": "tests/test_phase_executor.py",
      "line": 23,
      "type": "perfect21_internal",
      "description": "from features.phase_executor.phase_executor import ExecutionPhase",
      "severity": "low"
    },
    {
      "file": "tests/test_phase_executor.py",
      "line": 321,
      "type": "subagent_direct_call",
      "description": "@patch('subprocess.run')",
      "severity": "medium"
    },
    {
      "file": "tests/test_phase_executor.py",
      "line": 351,
      "type": "subagent_direct_call",
      "description": "@patch('subprocess.run')",
      "severity": "medium"
    },
    {
      "file": "tests/generate_test_dashboard.py",
      "line": 501,
      "type": "subagent_direct_call",
      "description": "@media (max-width: 768px) {",
      "severity": "medium"
    },
    {
      "file": "tests/enhanced_conftest.py",
      "line": 30,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture(scope=\"session\")",
      "severity": "medium"
    },
    {
      "file": "tests/enhanced_conftest.py",
      "line": 37,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture(scope=\"function\")",
      "severity": "medium"
    },
    {
      "file": "tests/enhanced_conftest.py",
      "line": 45,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture(scope=\"function\")",
      "severity": "medium"
    },
    {
      "file": "tests/enhanced_conftest.py",
      "line": 63,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture(scope=\"function\")",
      "severity": "medium"
    },
    {
      "file": "tests/enhanced_conftest.py",
      "line": 94,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture",
      "severity": "medium"
    },
    {
      "file": "tests/enhanced_conftest.py",
      "line": 110,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture",
      "severity": "medium"
    },
    {
      "file": "tests/enhanced_conftest.py",
      "line": 123,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture",
      "severity": "medium"
    },
    {
      "file": "tests/enhanced_conftest.py",
      "line": 128,
      "type": "perfect21_internal",
      "description": "from features.auth_system import AuthManager",
      "severity": "low"
    },
    {
      "file": "tests/enhanced_conftest.py",
      "line": 141,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture",
      "severity": "medium"
    },
    {
      "file": "tests/enhanced_conftest.py",
      "line": 147,
      "type": "subagent_direct_call",
      "description": "\"email\": f\"test_{unique_id}@example.com\",",
      "severity": "medium"
    },
    {
      "file": "tests/enhanced_conftest.py",
      "line": 152,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture",
      "severity": "medium"
    },
    {
      "file": "tests/enhanced_conftest.py",
      "line": 175,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 31,
      "type": "config_dependency",
      "description": "from config.security_config import SecurityConfig",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 39,
      "type": "subagent_direct_call",
      "description": "\"testuser@example.com\": {",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 41,
      "type": "subagent_direct_call",
      "description": "\"email\": \"testuser@example.com\",",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 48,
      "type": "subagent_direct_call",
      "description": "\"locked@example.com\": {",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 50,
      "type": "subagent_direct_call",
      "description": "\"email\": \"locked@example.com\",",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 134,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 139,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 144,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 148,
      "type": "subagent_direct_call",
      "description": "\"email\": \"testuser@example.com\",",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 152,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 156,
      "type": "subagent_direct_call",
      "description": "\"email\": \"nonexistent@example.com\",",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 161,
      "type": "subagent_direct_call",
      "description": "@pytest.mark.unit",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 165,
      "type": "subagent_direct_call",
      "description": "@pytest.mark.asyncio",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 175,
      "type": "subagent_direct_call",
      "description": "@pytest.mark.asyncio",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 184,
      "type": "subagent_direct_call",
      "description": "@pytest.mark.asyncio",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 187,
      "type": "subagent_direct_call",
      "description": "result = await auth_api.login(\"locked@example.com\", \"secret\")",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 192,
      "type": "subagent_direct_call",
      "description": "@pytest.mark.asyncio",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 201,
      "type": "subagent_direct_call",
      "description": "result = await auth_api.login(\"testuser@example.com\", \"secret\", ip_address)",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 206,
      "type": "subagent_direct_call",
      "description": "@pytest.mark.asyncio",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 209,
      "type": "subagent_direct_call",
      "description": "email = \"testuser@example.com\"",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 239,
      "type": "subagent_direct_call",
      "description": "@pytest.mark.integration",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 258,
      "type": "subagent_direct_call",
      "description": "@patch('api.rest_server.Perfect21SDK')",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 280,
      "type": "subagent_direct_call",
      "description": "@pytest.mark.security",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 284,
      "type": "subagent_direct_call",
      "description": "@pytest.mark.asyncio",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 299,
      "type": "subagent_direct_call",
      "description": "@pytest.mark.asyncio",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 313,
      "type": "subagent_direct_call",
      "description": "@pytest.mark.asyncio",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 317,
      "type": "subagent_direct_call",
      "description": "await auth_api.login(\"nonexistent@example.com\", \"password\")",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 321,
      "type": "subagent_direct_call",
      "description": "await auth_api.login(\"testuser@example.com\", \"wrongpassword\")",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 328,
      "type": "subagent_direct_call",
      "description": "@pytest.mark.asyncio",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 335,
      "type": "subagent_direct_call",
      "description": "result = await auth_api.login(\"testuser@example.com\", f\"wrong{attempt}\", ip_address)",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 343,
      "type": "subagent_direct_call",
      "description": "@pytest.mark.performance",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 347,
      "type": "subagent_direct_call",
      "description": "@pytest.mark.asyncio",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 351,
      "type": "subagent_direct_call",
      "description": "return await auth_api.login(\"testuser@example.com\", \"secret\", f\"192.168.1.{time.time()}\")",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 369,
      "type": "subagent_direct_call",
      "description": "@pytest.mark.asyncio",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 376,
      "type": "subagent_direct_call",
      "description": "await auth_api.login(\"testuser@example.com\", \"secret\")",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 399,
      "type": "subagent_direct_call",
      "description": "email = f\"user{i}@example.com\"",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 418,
      "type": "subagent_direct_call",
      "description": "@pytest.mark.e2e",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 422,
      "type": "subagent_direct_call",
      "description": "@pytest.mark.asyncio",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 426,
      "type": "subagent_direct_call",
      "description": "user_email = \"testuser@example.com\"",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 447,
      "type": "subagent_direct_call",
      "description": "@pytest.mark.asyncio",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 450,
      "type": "subagent_direct_call",
      "description": "user_email = \"testuser@example.com\"",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 473,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture(autouse=True)",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 503,
      "type": "subagent_direct_call",
      "description": "@pytest.mark.asyncio",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 507,
      "type": "subagent_direct_call",
      "description": "test_email = \"temp_user@example.com\"",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 525,
      "type": "config_dependency",
      "description": "db_config = config.get_db_config()",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 530,
      "type": "config_dependency",
      "description": "ssh_config = config.get_ssh_config()",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 538,
      "type": "config_dependency",
      "description": "masked = config.mask_sensitive(\"secretpassword123\", 4)",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 541,
      "type": "config_dependency",
      "description": "masked_short = config.mask_sensitive(\"abc\", 4)",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api_comprehensive.py",
      "line": 552,
      "type": "config_dependency",
      "description": "value = config.get('TEST_DB_HOST', 'default')",
      "severity": "medium"
    },
    {
      "file": "tests/test_workflow_orchestrator.py",
      "line": 17,
      "type": "orchestrator_dependency",
      "description": "from features.workflow_orchestrator.orchestrator import (",
      "severity": "high"
    },
    {
      "file": "tests/test_workflow_orchestrator.py",
      "line": 17,
      "type": "perfect21_internal",
      "description": "from features.workflow_orchestrator.orchestrator import (",
      "severity": "low"
    },
    {
      "file": "tests/test_workflow_orchestrator.py",
      "line": 25,
      "type": "orchestrator_dependency",
      "description": "class TestWorkflowOrchestrator(unittest.TestCase):",
      "severity": "high"
    },
    {
      "file": "tests/test_workflow_orchestrator.py",
      "line": 30,
      "type": "orchestrator_dependency",
      "description": "self.orchestrator = WorkflowOrchestrator()",
      "severity": "high"
    },
    {
      "file": "tests/test_workflow_orchestrator.py",
      "line": 69,
      "type": "orchestrator_dependency",
      "description": "self.orchestrator.workflows_path = os.path.join(self.temp_dir, \"workflows\")",
      "severity": "high"
    },
    {
      "file": "tests/test_workflow_orchestrator.py",
      "line": 79,
      "type": "orchestrator_dependency",
      "description": "self.assertIsNotNone(self.orchestrator.agent_capabilities)",
      "severity": "high"
    },
    {
      "file": "tests/test_workflow_orchestrator.py",
      "line": 80,
      "type": "orchestrator_dependency",
      "description": "self.assertIsNone(self.orchestrator.current_execution)",
      "severity": "high"
    },
    {
      "file": "tests/test_workflow_orchestrator.py",
      "line": 81,
      "type": "orchestrator_dependency",
      "description": "self.assertEqual(len(self.orchestrator.execution_history), 0)",
      "severity": "high"
    },
    {
      "file": "tests/test_workflow_orchestrator.py",
      "line": 85,
      "type": "orchestrator_dependency",
      "description": "workflow = self.orchestrator._load_workflow_template(\"test_workflow\")",
      "severity": "high"
    },
    {
      "file": "tests/test_workflow_orchestrator.py",
      "line": 92,
      "type": "orchestrator_dependency",
      "description": "workflow = self.orchestrator._load_workflow_template(\"nonexistent\")",
      "severity": "high"
    },
    {
      "file": "tests/test_workflow_orchestrator.py",
      "line": 99,
      "type": "orchestrator_dependency",
      "description": "complexity = self.orchestrator._analyze_task_complexity(simple_task)",
      "severity": "high"
    },
    {
      "file": "tests/test_workflow_orchestrator.py",
      "line": 104,
      "type": "orchestrator_dependency",
      "description": "complexity = self.orchestrator._analyze_task_complexity(complex_task)",
      "severity": "high"
    },
    {
      "file": "tests/test_workflow_orchestrator.py",
      "line": 109,
      "type": "orchestrator_dependency",
      "description": "complexity = self.orchestrator._analyze_task_complexity(medium_task)",
      "severity": "high"
    },
    {
      "file": "tests/test_workflow_orchestrator.py",
      "line": 116,
      "type": "orchestrator_dependency",
      "description": "project_type = self.orchestrator._analyze_project_type(api_task)",
      "severity": "high"
    },
    {
      "file": "tests/test_workflow_orchestrator.py",
      "line": 121,
      "type": "orchestrator_dependency",
      "description": "project_type = self.orchestrator._analyze_project_type(web_task)",
      "severity": "high"
    },
    {
      "file": "tests/test_workflow_orchestrator.py",
      "line": 126,
      "type": "orchestrator_dependency",
      "description": "project_type = self.orchestrator._analyze_project_type(general_task)",
      "severity": "high"
    },
    {
      "file": "tests/test_workflow_orchestrator.py",
      "line": 131,
      "type": "orchestrator_dependency",
      "description": "simplified = self.orchestrator._simplify_workflow(self.test_workflow)",
      "severity": "high"
    },
    {
      "file": "tests/test_workflow_orchestrator.py",
      "line": 139,
      "type": "orchestrator_dependency",
      "description": "enhanced = self.orchestrator._enhance_workflow(self.test_workflow)",
      "severity": "high"
    },
    {
      "file": "tests/test_workflow_orchestrator.py",
      "line": 153,
      "type": "orchestrator_dependency",
      "description": "pm_task = self.orchestrator._get_agent_task(\"project-manager\", task_desc)",
      "severity": "high"
    },
    {
      "file": "tests/test_workflow_orchestrator.py",
      "line": 158,
      "type": "orchestrator_dependency",
      "description": "unknown_task = self.orchestrator._get_agent_task(\"unknown-agent\", task_desc)",
      "severity": "high"
    },
    {
      "file": "tests/test_workflow_orchestrator.py",
      "line": 167,
      "type": "orchestrator_dependency",
      "description": "instructions = self.orchestrator.generate_workflow_instructions(",
      "severity": "high"
    },
    {
      "file": "tests/test_workflow_orchestrator.py",
      "line": 183,
      "type": "orchestrator_dependency",
      "description": "instruction = self.orchestrator._generate_stage_instruction(",
      "severity": "high"
    },
    {
      "file": "tests/test_workflow_orchestrator.py",
      "line": 201,
      "type": "orchestrator_dependency",
      "description": "instruction = self.orchestrator._generate_stage_instruction(",
      "severity": "high"
    },
    {
      "file": "tests/test_workflow_orchestrator.py",
      "line": 218,
      "type": "orchestrator_dependency",
      "description": "instruction = self.orchestrator._generate_stage_instruction(",
      "severity": "high"
    },
    {
      "file": "tests/test_workflow_orchestrator.py",
      "line": 230,
      "type": "orchestrator_dependency",
      "description": "self.orchestrator.generate_workflow_instructions(task_description, \"test_workflow\")",
      "severity": "high"
    },
    {
      "file": "tests/test_workflow_orchestrator.py",
      "line": 232,
      "type": "orchestrator_dependency",
      "description": "self.assertIsNotNone(self.orchestrator.current_execution)",
      "severity": "high"
    },
    {
      "file": "tests/test_workflow_orchestrator.py",
      "line": 233,
      "type": "orchestrator_dependency",
      "description": "self.assertEqual(self.orchestrator.current_execution.workflow_name, \"test_workflow\")",
      "severity": "high"
    },
    {
      "file": "tests/test_workflow_orchestrator.py",
      "line": 234,
      "type": "orchestrator_dependency",
      "description": "self.assertEqual(self.orchestrator.current_execution.task_description, task_description)",
      "severity": "high"
    },
    {
      "file": "tests/test_workflow_orchestrator.py",
      "line": 235,
      "type": "orchestrator_dependency",
      "description": "self.assertEqual(self.orchestrator.current_execution.status, \"running\")",
      "severity": "high"
    },
    {
      "file": "tests/test_auth_api.py",
      "line": 17,
      "type": "perfect21_internal",
      "description": "from features.auth_system import AuthManager",
      "severity": "low"
    },
    {
      "file": "tests/test_auth_api.py",
      "line": 22,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api.py",
      "line": 29,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api.py",
      "line": 36,
      "type": "subagent_direct_call",
      "description": "\"email\": f\"test_{unique_suffix}@example.com\",",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api.py",
      "line": 187,
      "type": "subagent_direct_call",
      "description": "\"email\": \"newemail@example.com\"",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api.py",
      "line": 274,
      "type": "subagent_direct_call",
      "description": "\"email\": \"testpwd@example.com\",",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api.py",
      "line": 307,
      "type": "subagent_direct_call",
      "description": "\"email\": \"testuser@example.com\",",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api.py",
      "line": 334,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api.py",
      "line": 339,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api.py",
      "line": 344,
      "type": "subagent_direct_call",
      "description": "\"email\": \"unittest@example.com\",",
      "severity": "medium"
    },
    {
      "file": "tests/test_auth_api.py",
      "line": 388,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture(autouse=True)",
      "severity": "medium"
    },
    {
      "file": "tests/conftest.py",
      "line": 25,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture(scope=\"session\")",
      "severity": "medium"
    },
    {
      "file": "tests/conftest.py",
      "line": 32,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture(autouse=True)",
      "severity": "medium"
    },
    {
      "file": "tests/conftest.py",
      "line": 40,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture",
      "severity": "medium"
    },
    {
      "file": "tests/conftest.py",
      "line": 50,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture(autouse=True)",
      "severity": "medium"
    },
    {
      "file": "tests/conftest.py",
      "line": 78,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture",
      "severity": "medium"
    },
    {
      "file": "tests/conftest.py",
      "line": 87,
      "type": "perfect21_internal",
      "description": "from features.auth_system import AuthManager",
      "severity": "low"
    },
    {
      "file": "tests/conftest.py",
      "line": 175,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture",
      "severity": "medium"
    },
    {
      "file": "tests/conftest.py",
      "line": 182,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture",
      "severity": "medium"
    },
    {
      "file": "tests/stress_test_perfect21.py",
      "line": 20,
      "type": "perfect21_internal",
      "description": "from features.git_workflow.hooks_manager import GitHooksManager",
      "severity": "low"
    },
    {
      "file": "tests/stress_test_perfect21.py",
      "line": 21,
      "type": "perfect21_internal",
      "description": "from features.version_manager import get_global_version_manager, get_global_version_advisor",
      "severity": "low"
    },
    {
      "file": "tests/stress_test_perfect21.py",
      "line": 22,
      "type": "perfect21_internal",
      "description": "from features.git_workflow.plugins.plugin_manager import PluginManager",
      "severity": "low"
    },
    {
      "file": "tests/unit/test_cli.py",
      "line": 24,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture",
      "severity": "medium"
    },
    {
      "file": "tests/unit/test_cli.py",
      "line": 29,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture",
      "severity": "medium"
    },
    {
      "file": "tests/unit/test_cli.py",
      "line": 68,
      "type": "subagent_direct_call",
      "description": "@patch('main.perfect21.Perfect21Core.execute_parallel_task')",
      "severity": "medium"
    },
    {
      "file": "tests/unit/test_cli.py",
      "line": 74,
      "type": "subagent_direct_call",
      "description": "'agents_called': ['@backend-architect', '@test-engineer']",
      "severity": "medium"
    },
    {
      "file": "tests/unit/test_cli.py",
      "line": 83,
      "type": "subagent_direct_call",
      "description": "@patch('features.git_workflow.hooks.GitHooks.install_hooks')",
      "severity": "medium"
    },
    {
      "file": "tests/unit/test_cli.py",
      "line": 97,
      "type": "subagent_direct_call",
      "description": "@patch('features.git_workflow.hooks.GitHooks.get_hook_status')",
      "severity": "medium"
    },
    {
      "file": "tests/unit/test_cli.py",
      "line": 126,
      "type": "subagent_direct_call",
      "description": "@patch('sys.argv')",
      "severity": "medium"
    },
    {
      "file": "tests/unit/test_cli.py",
      "line": 127,
      "type": "subagent_direct_call",
      "description": "@patch('main.cli.CLI.execute_command')",
      "severity": "medium"
    },
    {
      "file": "tests/unit/test_cli.py",
      "line": 194,
      "type": "subagent_direct_call",
      "description": "'agents_called': ['@backend-architect', '@test-engineer'],",
      "severity": "medium"
    },
    {
      "file": "tests/unit/test_cli.py",
      "line": 196,
      "type": "subagent_direct_call",
      "description": "'@backend-architect': {'success': True, 'output': 'Backend implementation complete'},",
      "severity": "medium"
    },
    {
      "file": "tests/unit/test_cli.py",
      "line": 197,
      "type": "subagent_direct_call",
      "description": "'@test-engineer': {'success': True, 'output': 'Tests written and passing'}",
      "severity": "medium"
    },
    {
      "file": "tests/unit/test_cli.py",
      "line": 244,
      "type": "subagent_direct_call",
      "description": "@patch('subprocess.run')",
      "severity": "medium"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 19,
      "type": "orchestrator_dependency",
      "description": "from features.workflow_orchestrator.orchestrator import WorkflowOrchestrator",
      "severity": "high"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 19,
      "type": "perfect21_internal",
      "description": "from features.workflow_orchestrator.orchestrator import WorkflowOrchestrator",
      "severity": "low"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 20,
      "type": "orchestrator_dependency",
      "description": "from features.workflow_orchestrator.task_manager import TaskManager",
      "severity": "high"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 20,
      "type": "perfect21_internal",
      "description": "from features.workflow_orchestrator.task_manager import TaskManager",
      "severity": "low"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 21,
      "type": "perfect21_internal",
      "description": "from features.sync_point_manager.sync_manager import SyncPointManager",
      "severity": "low"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 26,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture",
      "severity": "medium"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 29,
      "type": "orchestrator_dependency",
      "description": "return WorkflowOrchestrator()",
      "severity": "high"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 31,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture",
      "severity": "medium"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 41,
      "type": "subagent_direct_call",
      "description": "\"agents\": [\"@business-analyst\", \"@project-manager\"],",
      "severity": "medium"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 47,
      "type": "subagent_direct_call",
      "description": "\"agents\": [\"@api-designer\", \"@backend-architect\"],",
      "severity": "medium"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 53,
      "type": "subagent_direct_call",
      "description": "\"agents\": [\"@backend-architect\", \"@frontend-specialist\"],",
      "severity": "medium"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 81,
      "type": "orchestrator_dependency",
      "description": "result = orchestrator.load_workflow(sample_workflow)",
      "severity": "high"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 84,
      "type": "orchestrator_dependency",
      "description": "assert orchestrator.current_workflow is not None",
      "severity": "high"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 85,
      "type": "orchestrator_dependency",
      "description": "assert orchestrator.current_workflow['name'] == \"test_workflow\"",
      "severity": "high"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 89,
      "type": "orchestrator_dependency",
      "description": "orchestrator.load_workflow(sample_workflow)",
      "severity": "high"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 91,
      "type": "orchestrator_dependency",
      "description": "task = orchestrator.create_task(",
      "severity": "high"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 92,
      "type": "subagent_direct_call",
      "description": "agent=\"@business-analyst\",",
      "severity": "medium"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 98,
      "type": "subagent_direct_call",
      "description": "assert task['agent'] == \"@business-analyst\"",
      "severity": "medium"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 104,
      "type": "orchestrator_dependency",
      "description": "orchestrator.load_workflow(sample_workflow)",
      "severity": "high"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 107,
      "type": "orchestrator_dependency",
      "description": "execution_plan = orchestrator.plan_stage_execution(analysis_stage)",
      "severity": "high"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 115,
      "type": "orchestrator_dependency",
      "description": "orchestrator.load_workflow(sample_workflow)",
      "severity": "high"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 118,
      "type": "orchestrator_dependency",
      "description": "execution_plan = orchestrator.plan_stage_execution(design_stage)",
      "severity": "high"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 123,
      "type": "orchestrator_dependency",
      "description": "@patch('features.workflow_orchestrator.orchestrator.WorkflowOrchestrator.execute_agent_task')",
      "severity": "high"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 123,
      "type": "subagent_direct_call",
      "description": "@patch('features.workflow_orchestrator.orchestrator.WorkflowOrchestrator.execute_agent_task')",
      "severity": "medium"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 132,
      "type": "orchestrator_dependency",
      "description": "orchestrator.load_workflow(sample_workflow)",
      "severity": "high"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 135,
      "type": "orchestrator_dependency",
      "description": "result = orchestrator.execute_stage(analysis_stage)",
      "severity": "high"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 142,
      "type": "orchestrator_dependency",
      "description": "orchestrator.load_workflow(sample_workflow)",
      "severity": "high"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 153,
      "type": "orchestrator_dependency",
      "description": "result = orchestrator.validate_sync_point(sync_point, validation_results)",
      "severity": "high"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 160,
      "type": "orchestrator_dependency",
      "description": "orchestrator.load_workflow(sample_workflow)",
      "severity": "high"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 170,
      "type": "orchestrator_dependency",
      "description": "result = orchestrator.validate_sync_point(sync_point, validation_results)",
      "severity": "high"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 176,
      "type": "subagent_direct_call",
      "description": "@patch('asyncio.create_task')",
      "severity": "medium"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 181,
      "type": "subagent_direct_call",
      "description": "mock_task1.return_value = {'success': True, 'agent': '@business-analyst'}",
      "severity": "medium"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 184,
      "type": "subagent_direct_call",
      "description": "mock_task2.return_value = {'success': True, 'agent': '@project-manager'}",
      "severity": "medium"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 188,
      "type": "orchestrator_dependency",
      "description": "orchestrator.load_workflow(sample_workflow)",
      "severity": "high"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 191,
      "type": "orchestrator_dependency",
      "description": "result = await orchestrator.execute_stage_async(analysis_stage)",
      "severity": "high"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 198,
      "type": "orchestrator_dependency",
      "description": "orchestrator.load_workflow(sample_workflow)",
      "severity": "high"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 201,
      "type": "orchestrator_dependency",
      "description": "orchestrator.mark_task_completed(\"task_1\", {\"success\": True})",
      "severity": "high"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 202,
      "type": "orchestrator_dependency",
      "description": "orchestrator.mark_task_completed(\"task_2\", {\"success\": True})",
      "severity": "high"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 204,
      "type": "orchestrator_dependency",
      "description": "progress = orchestrator.get_workflow_progress()",
      "severity": "high"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 213,
      "type": "orchestrator_dependency",
      "description": "orchestrator.load_workflow(sample_workflow)",
      "severity": "high"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 222,
      "type": "orchestrator_dependency",
      "description": "result = orchestrator.handle_task_error(\"task_1\", error_result)",
      "severity": "high"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 229,
      "type": "orchestrator_dependency",
      "description": "orchestrator.load_workflow(sample_workflow)",
      "severity": "high"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 232,
      "type": "orchestrator_dependency",
      "description": "orchestrator.mark_stage_completed(\"analysis\")",
      "severity": "high"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 235,
      "type": "orchestrator_dependency",
      "description": "result = orchestrator.rollback_to_stage(\"analysis\")",
      "severity": "high"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 238,
      "type": "orchestrator_dependency",
      "description": "assert orchestrator.current_stage == \"analysis\"",
      "severity": "high"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 243,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture",
      "severity": "medium"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 258,
      "type": "subagent_direct_call",
      "description": "'agent': '@business-analyst',",
      "severity": "medium"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 269,
      "type": "subagent_direct_call",
      "description": "assert task['agent'] == '@business-analyst'",
      "severity": "medium"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 274,
      "type": "subagent_direct_call",
      "description": "'agent': '@business-analyst',",
      "severity": "medium"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 293,
      "type": "subagent_direct_call",
      "description": "'agent': '@business-analyst',",
      "severity": "medium"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 314,
      "type": "subagent_direct_call",
      "description": "'agent': '@business-analyst',",
      "severity": "medium"
    },
    {
      "file": "tests/unit/test_workflow_orchestrator.py",
      "line": 335,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture",
      "severity": "medium"
    },
    {
      "file": "tests/unit/test_capability_discovery.py",
      "line": 18,
      "type": "perfect21_internal",
      "description": "from features.capability_discovery.capability import CapabilityLoader, Capability",
      "severity": "low"
    },
    {
      "file": "tests/unit/test_capability_discovery.py",
      "line": 19,
      "type": "perfect21_internal",
      "description": "from features.capability_discovery.registry import CapabilityRegistry",
      "severity": "low"
    },
    {
      "file": "tests/unit/test_capability_discovery.py",
      "line": 24,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture",
      "severity": "medium"
    },
    {
      "file": "tests/unit/test_capability_discovery.py",
      "line": 32,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture",
      "severity": "medium"
    },
    {
      "file": "tests/unit/test_capability_discovery.py",
      "line": 146,
      "type": "subagent_direct_call",
      "description": "@patch('importlib.import_module')",
      "severity": "medium"
    },
    {
      "file": "tests/e2e/test_development_workflow.py",
      "line": 21,
      "type": "orchestrator_dependency",
      "description": "from features.workflow_orchestrator.orchestrator import WorkflowOrchestrator",
      "severity": "high"
    },
    {
      "file": "tests/e2e/test_development_workflow.py",
      "line": 21,
      "type": "perfect21_internal",
      "description": "from features.workflow_orchestrator.orchestrator import WorkflowOrchestrator",
      "severity": "low"
    },
    {
      "file": "tests/e2e/test_development_workflow.py",
      "line": 23,
      "type": "subagent_direct_call",
      "description": "@pytest.mark.e2e",
      "severity": "medium"
    },
    {
      "file": "tests/e2e/test_development_workflow.py",
      "line": 27,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture",
      "severity": "medium"
    },
    {
      "file": "tests/e2e/test_development_workflow.py",
      "line": 35,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture",
      "severity": "medium"
    },
    {
      "file": "tests/e2e/test_development_workflow.py",
      "line": 41,
      "type": "subagent_direct_call",
      "description": "@pytest.mark.e2e",
      "severity": "medium"
    },
    {
      "file": "tests/e2e/test_development_workflow.py",
      "line": 88,
      "type": "subagent_direct_call",
      "description": "@pytest.mark.e2e",
      "severity": "medium"
    },
    {
      "file": "tests/e2e/test_development_workflow.py",
      "line": 130,
      "type": "subagent_direct_call",
      "description": "@pytest.mark.e2e",
      "severity": "medium"
    },
    {
      "file": "tests/e2e/test_development_workflow.py",
      "line": 172,
      "type": "subagent_direct_call",
      "description": "@pytest.mark.e2e",
      "severity": "medium"
    },
    {
      "file": "tests/e2e/test_development_workflow.py",
      "line": 219,
      "type": "subagent_direct_call",
      "description": "@pytest.mark.e2e",
      "severity": "medium"
    },
    {
      "file": "tests/e2e/test_development_workflow.py",
      "line": 223,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture",
      "severity": "medium"
    },
    {
      "file": "tests/e2e/test_development_workflow.py",
      "line": 228,
      "type": "subagent_direct_call",
      "description": "@pytest.mark.e2e",
      "severity": "medium"
    },
    {
      "file": "tests/e2e/test_development_workflow.py",
      "line": 244,
      "type": "subagent_direct_call",
      "description": "assert any('@backend-architect' in str(agent) for agent in result['agents_called'])",
      "severity": "medium"
    },
    {
      "file": "tests/e2e/test_development_workflow.py",
      "line": 245,
      "type": "subagent_direct_call",
      "description": "assert any('@test-engineer' in str(agent) for agent in result['agents_called'])",
      "severity": "medium"
    },
    {
      "file": "tests/e2e/test_development_workflow.py",
      "line": 246,
      "type": "subagent_direct_call",
      "description": "assert any('@technical-writer' in str(agent) for agent in result['agents_called'])",
      "severity": "medium"
    },
    {
      "file": "tests/e2e/test_development_workflow.py",
      "line": 248,
      "type": "subagent_direct_call",
      "description": "@pytest.mark.e2e",
      "severity": "medium"
    },
    {
      "file": "tests/e2e/test_development_workflow.py",
      "line": 264,
      "type": "subagent_direct_call",
      "description": "@pytest.mark.e2e",
      "severity": "medium"
    },
    {
      "file": "tests/e2e/test_development_workflow.py",
      "line": 287,
      "type": "subagent_direct_call",
      "description": "@pytest.mark.e2e",
      "severity": "medium"
    },
    {
      "file": "tests/e2e/test_development_workflow.py",
      "line": 291,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture",
      "severity": "medium"
    },
    {
      "file": "tests/e2e/test_development_workflow.py",
      "line": 294,
      "type": "orchestrator_dependency",
      "description": "return WorkflowOrchestrator()",
      "severity": "high"
    },
    {
      "file": "tests/e2e/test_development_workflow.py",
      "line": 296,
      "type": "subagent_direct_call",
      "description": "@pytest.mark.e2e",
      "severity": "medium"
    },
    {
      "file": "tests/e2e/test_development_workflow.py",
      "line": 310,
      "type": "subagent_direct_call",
      "description": "\"agents\": [\"@business-analyst\", \"@project-manager\", \"@technical-writer\"],",
      "severity": "medium"
    },
    {
      "file": "tests/e2e/test_development_workflow.py",
      "line": 315,
      "type": "subagent_direct_call",
      "description": "\"agents\": [\"@api-designer\", \"@backend-architect\", \"@security-auditor\"],",
      "severity": "medium"
    },
    {
      "file": "tests/e2e/test_development_workflow.py",
      "line": 320,
      "type": "subagent_direct_call",
      "description": "\"agents\": [\"@backend-architect\", \"@test-engineer\", \"@performance-engineer\"],",
      "severity": "medium"
    },
    {
      "file": "tests/e2e/test_development_workflow.py",
      "line": 327,
      "type": "orchestrator_dependency",
      "description": "result = orchestrator.execute_premium_workflow(workflow_config)",
      "severity": "high"
    },
    {
      "file": "tests/e2e/test_development_workflow.py",
      "line": 337,
      "type": "subagent_direct_call",
      "description": "@pytest.mark.e2e",
      "severity": "medium"
    },
    {
      "file": "tests/e2e/test_development_workflow.py",
      "line": 346,
      "type": "subagent_direct_call",
      "description": "\"agents\": [\"@backend-architect\"],",
      "severity": "medium"
    },
    {
      "file": "tests/e2e/test_development_workflow.py",
      "line": 351,
      "type": "subagent_direct_call",
      "description": "\"agents\": [\"@test-engineer\"]",
      "severity": "medium"
    },
    {
      "file": "tests/e2e/test_development_workflow.py",
      "line": 357,
      "type": "orchestrator_dependency",
      "description": "result = orchestrator.execute_workflow(failing_workflow)",
      "severity": "high"
    },
    {
      "file": "tests/e2e/test_development_workflow.py",
      "line": 364,
      "type": "orchestrator_dependency",
      "description": "recovery_result = orchestrator.recover_from_failure(",
      "severity": "high"
    },
    {
      "file": "tests/e2e/test_development_workflow.py",
      "line": 372,
      "type": "subagent_direct_call",
      "description": "@pytest.mark.e2e",
      "severity": "medium"
    },
    {
      "file": "tests/e2e/test_development_workflow.py",
      "line": 376,
      "type": "subagent_direct_call",
      "description": "@pytest.mark.e2e",
      "severity": "medium"
    },
    {
      "file": "tests/e2e/test_development_workflow.py",
      "line": 406,
      "type": "subagent_direct_call",
      "description": "@pytest.mark.e2e",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/performance.py",
      "line": 31,
      "type": "subagent_direct_call",
      "description": "@contextmanager",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/performance.py",
      "line": 184,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/performance.py",
      "line": 189,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/performance.py",
      "line": 196,
      "type": "subagent_direct_call",
      "description": "@pytest.mark.performance",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/performance.py",
      "line": 200,
      "type": "subagent_direct_call",
      "description": "@staticmethod",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/performance.py",
      "line": 205,
      "type": "subagent_direct_call",
      "description": "@staticmethod",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/performance.py",
      "line": 210,
      "type": "subagent_direct_call",
      "description": "@staticmethod",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/performance.py",
      "line": 215,
      "type": "subagent_direct_call",
      "description": "@staticmethod",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/performance.py",
      "line": 282,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/performance.py",
      "line": 293,
      "type": "config_dependency",
      "description": "config.addinivalue_line(",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/performance.py",
      "line": 296,
      "type": "config_dependency",
      "description": "config.addinivalue_line(",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/performance.py",
      "line": 299,
      "type": "config_dependency",
      "description": "config.addinivalue_line(",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/database.py",
      "line": 120,
      "type": "subagent_direct_call",
      "description": "def get_test_user(self, email: str = \"test@example.com\") -> Dict[str, Any]:",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/database.py",
      "line": 127,
      "type": "subagent_direct_call",
      "description": "def create_test_user(self, email: str = \"test@example.com\", password_hash: str = \"hashed_password\") -> int:",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/database.py",
      "line": 163,
      "type": "subagent_direct_call",
      "description": "@contextmanager",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/database.py",
      "line": 254,
      "type": "subagent_direct_call",
      "description": "@staticmethod",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/database.py",
      "line": 259,
      "type": "subagent_direct_call",
      "description": "'email': 'active@example.com',",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/database.py",
      "line": 265,
      "type": "subagent_direct_call",
      "description": "'email': 'locked@example.com',",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/database.py",
      "line": 271,
      "type": "subagent_direct_call",
      "description": "'email': 'newuser@example.com',",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/database.py",
      "line": 278,
      "type": "subagent_direct_call",
      "description": "@staticmethod",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/database.py",
      "line": 298,
      "type": "subagent_direct_call",
      "description": "@staticmethod",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/database.py",
      "line": 303,
      "type": "subagent_direct_call",
      "description": "'email': 'active@example.com',",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/database.py",
      "line": 309,
      "type": "subagent_direct_call",
      "description": "'email': 'locked@example.com',",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/database.py",
      "line": 315,
      "type": "subagent_direct_call",
      "description": "'email': 'nonexistent@example.com',",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/database.py",
      "line": 323,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture(scope='function')",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/database.py",
      "line": 334,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture(scope='session')",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/database.py",
      "line": 344,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/database.py",
      "line": 349,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture(autouse=True)",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/database.py",
      "line": 364,
      "type": "subagent_direct_call",
      "description": "@staticmethod",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/database.py",
      "line": 370,
      "type": "subagent_direct_call",
      "description": "@staticmethod",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/database.py",
      "line": 382,
      "type": "subagent_direct_call",
      "description": "@staticmethod",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/database.py",
      "line": 394,
      "type": "subagent_direct_call",
      "description": "@staticmethod",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/database.py",
      "line": 428,
      "type": "config_dependency",
      "description": "config.addinivalue_line(",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/database.py",
      "line": 431,
      "type": "config_dependency",
      "description": "config.addinivalue_line(",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/database.py",
      "line": 434,
      "type": "config_dependency",
      "description": "config.addinivalue_line(",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/security.py",
      "line": 53,
      "type": "subagent_direct_call",
      "description": "\"<form action='/api/login' method='post'><input name='email' value='attacker@evil.com'><input type='submit'></form>\",",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/security.py",
      "line": 297,
      "type": "config_dependency",
      "description": "if validation_config.get('type') == 'email':",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/security.py",
      "line": 299,
      "type": "subagent_direct_call",
      "description": "{'value': 'valid@example.com', 'should_fail': False, 'test_type': 'valid_email'},",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/security.py",
      "line": 301,
      "type": "subagent_direct_call",
      "description": "{'value': '@missing-local.com', 'should_fail': True, 'test_type': 'missing_local'},",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/security.py",
      "line": 457,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/security.py",
      "line": 462,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/security.py",
      "line": 472,
      "type": "config_dependency",
      "description": "config.addinivalue_line(",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/security.py",
      "line": 475,
      "type": "config_dependency",
      "description": "config.addinivalue_line(",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/security.py",
      "line": 478,
      "type": "config_dependency",
      "description": "config.addinivalue_line(",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/security.py",
      "line": 481,
      "type": "config_dependency",
      "description": "config.addinivalue_line(",
      "severity": "medium"
    },
    {
      "file": "tests/plugins/security.py",
      "line": 484,
      "type": "config_dependency",
      "description": "config.addinivalue_line(",
      "severity": "medium"
    },
    {
      "file": "examples/phase_executor_demo.py",
      "line": 11,
      "type": "perfect21_internal",
      "description": "from features.phase_executor import (",
      "severity": "low"
    },
    {
      "file": "examples/phase_executor_demo.py",
      "line": 17,
      "type": "perfect21_internal",
      "description": "from features.phase_executor.phase_executor import ExecutionPhase",
      "severity": "low"
    },
    {
      "file": "examples/supervisor_demo.py",
      "line": 11,
      "type": "perfect21_internal",
      "description": "from features.phase_executor import PhaseExecutor",
      "severity": "low"
    },
    {
      "file": "examples/supervisor_demo.py",
      "line": 12,
      "type": "perfect21_internal",
      "description": "from features.phase_executor.phase_executor import ExecutionPhase",
      "severity": "low"
    },
    {
      "file": "modules/fault_tolerance.py",
      "line": 34,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "modules/fault_tolerance.py",
      "line": 106,
      "type": "subagent_direct_call",
      "description": "@abstractmethod",
      "severity": "medium"
    },
    {
      "file": "modules/fault_tolerance.py",
      "line": 111,
      "type": "subagent_direct_call",
      "description": "@abstractmethod",
      "severity": "medium"
    },
    {
      "file": "modules/fault_tolerance.py",
      "line": 364,
      "type": "perfect21_internal",
      "description": "from features.capability_discovery import get_global_loader",
      "severity": "low"
    },
    {
      "file": "modules/fault_tolerance.py",
      "line": 372,
      "type": "perfect21_internal",
      "description": "from features.version_manager import get_global_version_manager",
      "severity": "low"
    },
    {
      "file": "modules/architecture_manager.py",
      "line": 31,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "modules/monitoring.py",
      "line": 28,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "modules/monitoring.py",
      "line": 38,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "modules/database.py",
      "line": 16,
      "type": "config_dependency",
      "description": "from modules.config import config",
      "severity": "medium"
    },
    {
      "file": "modules/database.py",
      "line": 23,
      "type": "config_dependency",
      "description": "self.db_type = config.get('database.type', 'sqlite')",
      "severity": "medium"
    },
    {
      "file": "modules/database.py",
      "line": 24,
      "type": "config_dependency",
      "description": "self.db_host = config.get('database.host', 'localhost')",
      "severity": "medium"
    },
    {
      "file": "modules/database.py",
      "line": 25,
      "type": "config_dependency",
      "description": "self.db_port = config.get('database.port', 5432)",
      "severity": "medium"
    },
    {
      "file": "modules/database.py",
      "line": 26,
      "type": "config_dependency",
      "description": "self.db_name = config.get('database.name', 'perfect21')",
      "severity": "medium"
    },
    {
      "file": "modules/database.py",
      "line": 27,
      "type": "config_dependency",
      "description": "self.db_user = config.get('database.user', 'perfect21')",
      "severity": "medium"
    },
    {
      "file": "modules/database.py",
      "line": 28,
      "type": "config_dependency",
      "description": "self.db_password = config.get('database.password', '')",
      "severity": "medium"
    },
    {
      "file": "modules/database.py",
      "line": 29,
      "type": "config_dependency",
      "description": "self.db_path = config.get('database.path', 'data/perfect21.db')",
      "severity": "medium"
    },
    {
      "file": "modules/database.py",
      "line": 32,
      "type": "config_dependency",
      "description": "self.pool_size = config.get('database.pool_size', 5)",
      "severity": "medium"
    },
    {
      "file": "modules/database.py",
      "line": 33,
      "type": "config_dependency",
      "description": "self.max_overflow = config.get('database.max_overflow', 10)",
      "severity": "medium"
    },
    {
      "file": "modules/database.py",
      "line": 34,
      "type": "config_dependency",
      "description": "self.pool_timeout = config.get('database.pool_timeout', 30)",
      "severity": "medium"
    },
    {
      "file": "modules/database.py",
      "line": 84,
      "type": "config_dependency",
      "description": "if self.config.db_type == 'sqlite':",
      "severity": "medium"
    },
    {
      "file": "modules/database.py",
      "line": 98,
      "type": "config_dependency",
      "description": "conn = self.config.get_sqlite_connection()",
      "severity": "medium"
    },
    {
      "file": "modules/database.py",
      "line": 108,
      "type": "config_dependency",
      "description": "log_info(f\"初始化{self.config.db_type}数据库（待实现）\")",
      "severity": "medium"
    },
    {
      "file": "modules/database.py",
      "line": 165,
      "type": "subagent_direct_call",
      "description": "@contextmanager",
      "severity": "medium"
    },
    {
      "file": "modules/database.py",
      "line": 171,
      "type": "config_dependency",
      "description": "if self.config.db_type == 'sqlite':",
      "severity": "medium"
    },
    {
      "file": "modules/database.py",
      "line": 172,
      "type": "config_dependency",
      "description": "conn = self.config.get_sqlite_connection()",
      "severity": "medium"
    },
    {
      "file": "modules/database.py",
      "line": 175,
      "type": "config_dependency",
      "description": "raise NotImplementedError(f\"暂不支持{self.config.db_type}数据库\")",
      "severity": "medium"
    },
    {
      "file": "modules/database.py",
      "line": 246,
      "type": "config_dependency",
      "description": "if self.config.db_type == 'sqlite':",
      "severity": "medium"
    },
    {
      "file": "modules/database.py",
      "line": 250,
      "type": "config_dependency",
      "description": "raise NotImplementedError(f\"暂不支持{self.config.db_type}数据库\")",
      "severity": "medium"
    },
    {
      "file": "modules/database.py",
      "line": 256,
      "type": "config_dependency",
      "description": "if self.config.db_type == 'sqlite':",
      "severity": "medium"
    },
    {
      "file": "modules/database.py",
      "line": 261,
      "type": "config_dependency",
      "description": "raise NotImplementedError(f\"暂不支持{self.config.db_type}数据库\")",
      "severity": "medium"
    },
    {
      "file": "modules/database.py",
      "line": 266,
      "type": "config_dependency",
      "description": "if self.config.db_type == 'sqlite':",
      "severity": "medium"
    },
    {
      "file": "modules/database.py",
      "line": 268,
      "type": "config_dependency",
      "description": "shutil.copy2(self.config.db_path, backup_path)",
      "severity": "medium"
    },
    {
      "file": "modules/database.py",
      "line": 273,
      "type": "config_dependency",
      "description": "log_info(f\"备份{self.config.db_type}数据库（待实现）\")",
      "severity": "medium"
    },
    {
      "file": "modules/database.py",
      "line": 283,
      "type": "config_dependency",
      "description": "if self.config.db_type == 'sqlite':",
      "severity": "medium"
    },
    {
      "file": "modules/database.py",
      "line": 290,
      "type": "config_dependency",
      "description": "log_info(f\"优化{self.config.db_type}数据库（待实现）\")",
      "severity": "medium"
    },
    {
      "file": "modules/database.py",
      "line": 299,
      "type": "config_dependency",
      "description": "'database_type': self.config.db_type,",
      "severity": "medium"
    },
    {
      "file": "modules/database.py",
      "line": 300,
      "type": "config_dependency",
      "description": "'database_path': self.config.db_path if self.config.db_type == 'sqlite' else None,",
      "severity": "medium"
    },
    {
      "file": "modules/database.py",
      "line": 304,
      "type": "config_dependency",
      "description": "if self.config.db_type == 'sqlite' and os.path.exists(self.config.db_path):",
      "severity": "medium"
    },
    {
      "file": "modules/database.py",
      "line": 305,
      "type": "config_dependency",
      "description": "stats['database_size'] = os.path.getsize(self.config.db_path)",
      "severity": "medium"
    },
    {
      "file": "modules/cache.py",
      "line": 19,
      "type": "config_dependency",
      "description": "from modules.config import config",
      "severity": "medium"
    },
    {
      "file": "modules/cache.py",
      "line": 273,
      "type": "config_dependency",
      "description": "self.cache_type = config.get('cache.type', 'memory')",
      "severity": "medium"
    },
    {
      "file": "modules/cache.py",
      "line": 274,
      "type": "config_dependency",
      "description": "self.default_ttl = config.get('cache.default_ttl', 3600)",
      "severity": "medium"
    },
    {
      "file": "modules/cache.py",
      "line": 280,
      "type": "config_dependency",
      "description": "cache_dir = config.get('cache.file_dir', 'cache')",
      "severity": "medium"
    },
    {
      "file": "modules/cache.py",
      "line": 297,
      "type": "config_dependency",
      "description": "# redis_host = config.get('cache.redis_host', 'localhost')",
      "severity": "medium"
    },
    {
      "file": "modules/cache.py",
      "line": 298,
      "type": "config_dependency",
      "description": "# redis_port = config.get('cache.redis_port', 6379)",
      "severity": "medium"
    },
    {
      "file": "modules/cache.py",
      "line": 299,
      "type": "config_dependency",
      "description": "# redis_db = config.get('cache.redis_db', 0)",
      "severity": "medium"
    },
    {
      "file": "modules/plugin_system.py",
      "line": 26,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "modules/plugin_system.py",
      "line": 48,
      "type": "subagent_direct_call",
      "description": "@abstractmethod",
      "severity": "medium"
    },
    {
      "file": "modules/plugin_system.py",
      "line": 53,
      "type": "subagent_direct_call",
      "description": "@abstractmethod",
      "severity": "medium"
    },
    {
      "file": "modules/plugin_system.py",
      "line": 58,
      "type": "subagent_direct_call",
      "description": "@abstractmethod",
      "severity": "medium"
    },
    {
      "file": "modules/plugin_system.py",
      "line": 63,
      "type": "subagent_direct_call",
      "description": "@abstractmethod",
      "severity": "medium"
    },
    {
      "file": "modules/plugin_system.py",
      "line": 68,
      "type": "subagent_direct_call",
      "description": "@abstractmethod",
      "severity": "medium"
    },
    {
      "file": "modules/state_manager.py",
      "line": 33,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "modules/state_manager.py",
      "line": 47,
      "type": "subagent_direct_call",
      "description": "@abstractmethod",
      "severity": "medium"
    },
    {
      "file": "modules/parallel_monitor.py",
      "line": 26,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "modules/parallel_monitor.py",
      "line": 231,
      "type": "subagent_direct_call",
      "description": "monitor.add_task(task1_id, \"@code-reviewer\", \"代码质量检查\")",
      "severity": "medium"
    },
    {
      "file": "modules/parallel_monitor.py",
      "line": 232,
      "type": "subagent_direct_call",
      "description": "monitor.add_task(task2_id, \"@test-engineer\", \"运行测试套件\")",
      "severity": "medium"
    },
    {
      "file": "modules/parallel_monitor.py",
      "line": 249,
      "type": "subagent_direct_call",
      "description": "monitor.add_task(task3_id, \"@security-auditor\", \"安全扫描\")",
      "severity": "medium"
    },
    {
      "file": "modules/parallel_monitor.py",
      "line": 250,
      "type": "subagent_direct_call",
      "description": "monitor.add_task(task4_id, \"@performance-engineer\", \"性能分析\")",
      "severity": "medium"
    },
    {
      "file": "modules/dependency_injection.py",
      "line": 16,
      "type": "subagent_direct_call",
      "description": "@abstractmethod",
      "severity": "medium"
    },
    {
      "file": "modules/dependency_injection.py",
      "line": 21,
      "type": "subagent_direct_call",
      "description": "@abstractmethod",
      "severity": "medium"
    },
    {
      "file": "modules/dependency_injection.py",
      "line": 26,
      "type": "subagent_direct_call",
      "description": "@abstractmethod",
      "severity": "medium"
    },
    {
      "file": "modules/config.py",
      "line": 127,
      "type": "config_dependency",
      "description": "self.config.update(loaded_config)",
      "severity": "medium"
    },
    {
      "file": "shared/errors/error_handler.py",
      "line": 39,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "shared/errors/error_handler.py",
      "line": 50,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "shared/errors/error_handler.py",
      "line": 380,
      "type": "config_dependency",
      "description": "from infrastructure.config.config_manager import get_config_manager",
      "severity": "medium"
    },
    {
      "file": "scripts/start_api.py",
      "line": 16,
      "type": "config_dependency",
      "description": "from modules.config import config",
      "severity": "medium"
    },
    {
      "file": "scripts/start_api.py",
      "line": 49,
      "type": "config_dependency",
      "description": "if not jwt_secret and config.get('perfect21.mode') == 'production':",
      "severity": "medium"
    },
    {
      "file": "scripts/start_api.py",
      "line": 54,
      "type": "config_dependency",
      "description": "data_dir = config.get('perfect21.data_dir', 'data')",
      "severity": "medium"
    },
    {
      "file": "scripts/start_api.py",
      "line": 55,
      "type": "config_dependency",
      "description": "logs_dir = config.get('perfect21.logs_dir', 'logs')",
      "severity": "medium"
    },
    {
      "file": "scripts/start_api.py",
      "line": 72,
      "type": "config_dependency",
      "description": "log_level = log_level or config.get('logging.level', 'INFO')",
      "severity": "medium"
    },
    {
      "file": "scripts/start_api.py",
      "line": 73,
      "type": "config_dependency",
      "description": "log_file = config.get('logging.file', 'logs/api.log')",
      "severity": "medium"
    },
    {
      "file": "scripts/start_api.py",
      "line": 85,
      "type": "perfect21_internal",
      "description": "from features.auth_system import AuthManager",
      "severity": "low"
    },
    {
      "file": "scripts/start_api.py",
      "line": 99,
      "type": "subagent_direct_call",
      "description": "email=\"admin@perfect21.local\",",
      "severity": "medium"
    },
    {
      "file": "scripts/start_api.py",
      "line": 144,
      "type": "config_dependency",
      "description": "host = host or config.get('server.host', '127.0.0.1')",
      "severity": "medium"
    },
    {
      "file": "scripts/start_api.py",
      "line": 145,
      "type": "config_dependency",
      "description": "port = port or config.get('server.port', 8000)",
      "severity": "medium"
    },
    {
      "file": "scripts/start_api.py",
      "line": 146,
      "type": "config_dependency",
      "description": "workers = workers or config.get('server.workers', 1)",
      "severity": "medium"
    },
    {
      "file": "scripts/start_api.py",
      "line": 149,
      "type": "config_dependency",
      "description": "if config.get('perfect21.mode') == 'production':",
      "severity": "medium"
    },
    {
      "file": "scripts/start_api.py",
      "line": 180,
      "type": "config_dependency",
      "description": "print(f\"版本: {config.get('perfect21.version', 'Unknown')}\")",
      "severity": "medium"
    },
    {
      "file": "scripts/start_api.py",
      "line": 181,
      "type": "config_dependency",
      "description": "print(f\"模式: {config.get('perfect21.mode', 'Unknown')}\")",
      "severity": "medium"
    },
    {
      "file": "scripts/start_api.py",
      "line": 194,
      "type": "config_dependency",
      "description": "server_host = config.get('server.host', '127.0.0.1')",
      "severity": "medium"
    },
    {
      "file": "scripts/start_api.py",
      "line": 195,
      "type": "config_dependency",
      "description": "server_port = config.get('server.port', 8000)",
      "severity": "medium"
    },
    {
      "file": "scripts/performance_test.py",
      "line": 216,
      "type": "config_dependency",
      "description": "from infrastructure.config.config_manager import get_config_manager",
      "severity": "medium"
    },
    {
      "file": "scripts/performance_test.py",
      "line": 274,
      "type": "config_dependency",
      "description": "from infrastructure.config.config_manager import get_config_manager",
      "severity": "medium"
    },
    {
      "file": "features/parallel_manager.py",
      "line": 21,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "features/parallel_manager.py",
      "line": 33,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "features/parallel_manager.py",
      "line": 361,
      "type": "subagent_direct_call",
      "description": "Task(",
      "severity": "medium"
    },
    {
      "file": "features/smart_decomposer.py",
      "line": 24,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "features/smart_decomposer.py",
      "line": 38,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "features/smart_decomposer.py",
      "line": 333,
      "type": "subagent_direct_call",
      "description": "return AgentTask(",
      "severity": "medium"
    },
    {
      "file": "features/smart_decomposer.py",
      "line": 373,
      "type": "subagent_direct_call",
      "description": "return AgentTask(",
      "severity": "medium"
    },
    {
      "file": "features/smart_decomposer.py",
      "line": 413,
      "type": "subagent_direct_call",
      "description": "return AgentTask(",
      "severity": "medium"
    },
    {
      "file": "features/smart_decomposer.py",
      "line": 453,
      "type": "subagent_direct_call",
      "description": "return AgentTask(",
      "severity": "medium"
    },
    {
      "file": "features/smart_decomposer.py",
      "line": 476,
      "type": "subagent_direct_call",
      "description": "return AgentTask(\"test-engineer\", \"创建测试策略和自动化测试\", prompt, 4, 60)",
      "severity": "medium"
    },
    {
      "file": "features/smart_decomposer.py",
      "line": 492,
      "type": "subagent_direct_call",
      "description": "return AgentTask(\"devops-engineer\", \"配置CI/CD和部署\", prompt, 5, 75)",
      "severity": "medium"
    },
    {
      "file": "features/smart_decomposer.py",
      "line": 497,
      "type": "subagent_direct_call",
      "description": "return AgentTask(\"fullstack-engineer\", \"全栈应用开发\", prompt, 2, 150)",
      "severity": "medium"
    },
    {
      "file": "features/smart_decomposer.py",
      "line": 501,
      "type": "subagent_direct_call",
      "description": "return AgentTask(\"api-designer\", \"API接口设计\", prompt, 1, 45)",
      "severity": "medium"
    },
    {
      "file": "features/smart_decomposer.py",
      "line": 505,
      "type": "subagent_direct_call",
      "description": "return AgentTask(\"ux-designer\", \"用户体验设计\", prompt, 1, 60)",
      "severity": "medium"
    },
    {
      "file": "features/smart_decomposer.py",
      "line": 509,
      "type": "subagent_direct_call",
      "description": "return AgentTask(\"business-analyst\", \"业务需求分析\", prompt, 1, 45)",
      "severity": "medium"
    },
    {
      "file": "features/smart_decomposer.py",
      "line": 513,
      "type": "subagent_direct_call",
      "description": "return AgentTask(\"project-manager\", \"项目管理和规划\", prompt, 1, 30)",
      "severity": "medium"
    },
    {
      "file": "features/smart_decomposer.py",
      "line": 517,
      "type": "subagent_direct_call",
      "description": "return AgentTask(\"cloud-architect\", \"云架构设计\", prompt, 3, 60)",
      "severity": "medium"
    },
    {
      "file": "features/smart_decomposer.py",
      "line": 521,
      "type": "subagent_direct_call",
      "description": "return AgentTask(\"performance-engineer\", \"性能优化分析\", prompt, 4, 60)",
      "severity": "medium"
    },
    {
      "file": "features/smart_decomposer.py",
      "line": 525,
      "type": "subagent_direct_call",
      "description": "return AgentTask(\"ai-engineer\", \"AI/ML系统开发\", prompt, 2, 120)",
      "severity": "medium"
    },
    {
      "file": "features/smart_decomposer.py",
      "line": 529,
      "type": "subagent_direct_call",
      "description": "return AgentTask(\"mobile-developer\", \"移动应用开发\", prompt, 2, 120)",
      "severity": "medium"
    },
    {
      "file": "features/smart_decomposer.py",
      "line": 533,
      "type": "subagent_direct_call",
      "description": "return AgentTask(\"blockchain-developer\", \"区块链应用开发\", prompt, 2, 100)",
      "severity": "medium"
    },
    {
      "file": "features/smart_decomposer.py",
      "line": 537,
      "type": "subagent_direct_call",
      "description": "return AgentTask(\"fintech-specialist\", \"金融科技解决方案\", prompt, 2, 90)",
      "severity": "medium"
    },
    {
      "file": "features/smart_decomposer.py",
      "line": 541,
      "type": "subagent_direct_call",
      "description": "return AgentTask(\"ecommerce-expert\", \"电商平台开发\", prompt, 2, 100)",
      "severity": "medium"
    },
    {
      "file": "features/smart_decomposer.py",
      "line": 545,
      "type": "subagent_direct_call",
      "description": "return AgentTask(\"healthcare-dev\", \"医疗健康系统\", prompt, 2, 110)",
      "severity": "medium"
    },
    {
      "file": "features/orchestrator_integration.py",
      "line": 24,
      "type": "perfect21_internal",
      "description": "from features.workflow_engine import create_workflow_engine",
      "severity": "low"
    },
    {
      "file": "features/parallel_executor.py",
      "line": 144,
      "type": "subagent_direct_call",
      "description": "Task(",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/user_login_api.py",
      "line": 34,
      "type": "config_dependency",
      "description": "from modules.config import config",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/user_login_api.py",
      "line": 36,
      "type": "perfect21_internal",
      "description": "from features.capability_discovery.capability import CapabilityDefinition",
      "severity": "low"
    },
    {
      "file": "features/auth_api/user_login_api.py",
      "line": 71,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/user_login_api.py",
      "line": 82,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/user_login_api.py",
      "line": 97,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/user_login_api.py",
      "line": 115,
      "type": "subagent_direct_call",
      "description": "@validator('username')",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/user_login_api.py",
      "line": 121,
      "type": "subagent_direct_call",
      "description": "@validator('password')",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/user_login_api.py",
      "line": 212,
      "type": "config_dependency",
      "description": "self.jwt_secret_key = self.config.get('auth.jwt_secret_key', self._generate_secret_key())",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/user_login_api.py",
      "line": 213,
      "type": "config_dependency",
      "description": "self.jwt_algorithm = self.config.get('auth.jwt_algorithm', 'HS256')",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/user_login_api.py",
      "line": 214,
      "type": "config_dependency",
      "description": "self.access_token_expires = self.config.get('auth.access_token_expires', 3600)  # 1小时",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/user_login_api.py",
      "line": 215,
      "type": "config_dependency",
      "description": "self.refresh_token_expires = self.config.get('auth.refresh_token_expires', 86400 * 7)  # 7天",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/user_login_api.py",
      "line": 218,
      "type": "config_dependency",
      "description": "self.max_login_attempts = self.config.get('auth.max_login_attempts', 5)",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/user_login_api.py",
      "line": 219,
      "type": "config_dependency",
      "description": "self.lockout_duration = self.config.get('auth.lockout_duration', 900)  # 15分钟",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/user_login_api.py",
      "line": 220,
      "type": "config_dependency",
      "description": "self.require_captcha_after = self.config.get('auth.require_captcha_after', 3)",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/user_login_api.py",
      "line": 221,
      "type": "config_dependency",
      "description": "self.password_salt_rounds = self.config.get('auth.password_salt_rounds', 12)",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/user_login_api.py",
      "line": 238,
      "type": "config_dependency",
      "description": "db_url = self.config.get('database.url', 'sqlite:///perfect21_auth.db')",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/user_login_api.py",
      "line": 239,
      "type": "config_dependency",
      "description": "engine = create_engine(db_url, echo=self.config.get('database.echo', False))",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/user_login_api.py",
      "line": 249,
      "type": "config_dependency",
      "description": "redis_config = self.config.get('redis', {})",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/user_login_api.py",
      "line": 251,
      "type": "config_dependency",
      "description": "host=redis_config.get('host', 'localhost'),",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/user_login_api.py",
      "line": 252,
      "type": "config_dependency",
      "description": "port=redis_config.get('port', 6379),",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/user_login_api.py",
      "line": 253,
      "type": "config_dependency",
      "description": "db=redis_config.get('db', 0),",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/user_login_api.py",
      "line": 254,
      "type": "config_dependency",
      "description": "password=redis_config.get('password'),",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/user_login_api.py",
      "line": 780,
      "type": "subagent_direct_call",
      "description": "@wraps(f)",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/user_login_api.py",
      "line": 802,
      "type": "subagent_direct_call",
      "description": "@app.route('/api/v1/auth/login', methods=['POST'])",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/user_login_api.py",
      "line": 832,
      "type": "subagent_direct_call",
      "description": "@app.route('/api/v1/auth/validate', methods=['POST'])",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/user_login_api.py",
      "line": 851,
      "type": "subagent_direct_call",
      "description": "@app.route('/api/v1/auth/refresh', methods=['POST'])",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/user_login_api.py",
      "line": 871,
      "type": "subagent_direct_call",
      "description": "@app.route('/api/v1/auth/logout', methods=['POST'])",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/user_login_api.py",
      "line": 872,
      "type": "subagent_direct_call",
      "description": "@require_auth",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/user_login_api.py",
      "line": 887,
      "type": "subagent_direct_call",
      "description": "@app.route('/api/v1/auth/profile', methods=['GET'])",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/user_login_api.py",
      "line": 888,
      "type": "subagent_direct_call",
      "description": "@require_auth",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/user_login_api.py",
      "line": 902,
      "type": "subagent_direct_call",
      "description": "@app.errorhandler(404)",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/user_login_api.py",
      "line": 906,
      "type": "subagent_direct_call",
      "description": "@app.errorhandler(500)",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/user_login_api.py",
      "line": 997,
      "type": "config_dependency",
      "description": "host = config.get('auth_api.host', '0.0.0.0')",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/user_login_api.py",
      "line": 998,
      "type": "config_dependency",
      "description": "port = config.get('auth_api.port', 8080)",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/user_login_api.py",
      "line": 999,
      "type": "config_dependency",
      "description": "debug = config.get('auth_api.debug', False)",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/client_sdk.py",
      "line": 28,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/client_sdk.py",
      "line": 41,
      "type": "subagent_direct_call",
      "description": "@property",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/client_sdk.py",
      "line": 46,
      "type": "subagent_direct_call",
      "description": "@property",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/client_sdk.py",
      "line": 53,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/client_sdk.py",
      "line": 504,
      "type": "subagent_direct_call",
      "description": "@property",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/test_auth_api.py",
      "line": 23,
      "type": "perfect21_internal",
      "description": "from features.auth_api.user_login_api import (",
      "severity": "low"
    },
    {
      "file": "features/auth_api/test_auth_api.py",
      "line": 27,
      "type": "perfect21_internal",
      "description": "from features.auth_api.client_sdk import Perfect21AuthClient, AsyncPerfect21AuthClient, AuthenticationError",
      "severity": "low"
    },
    {
      "file": "features/auth_api/test_auth_api.py",
      "line": 33,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/test_auth_api.py",
      "line": 37,
      "type": "config_dependency",
      "description": "mock_config.get.return_value = 'test-value'",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/test_auth_api.py",
      "line": 41,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/test_auth_api.py",
      "line": 47,
      "type": "subagent_direct_call",
      "description": "user.email = 'test@example.com'",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/test_auth_api.py",
      "line": 214,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/test_auth_api.py",
      "line": 219,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/test_auth_api.py",
      "line": 233,
      "type": "subagent_direct_call",
      "description": "'email': 'test@example.com',",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/test_auth_api.py",
      "line": 268,
      "type": "perfect21_internal",
      "description": "from features.auth_api.client_sdk import AuthToken",
      "severity": "low"
    },
    {
      "file": "features/auth_api/test_auth_api.py",
      "line": 292,
      "type": "perfect21_internal",
      "description": "from features.auth_api.client_sdk import UserProfile",
      "severity": "low"
    },
    {
      "file": "features/auth_api/test_auth_api.py",
      "line": 296,
      "type": "subagent_direct_call",
      "description": "email='test@example.com',",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/test_auth_api.py",
      "line": 325,
      "type": "subagent_direct_call",
      "description": "@pytest.fixture(scope='class')",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/test_auth_api.py",
      "line": 332,
      "type": "perfect21_internal",
      "description": "from features.auth_api.user_login_api import UserLoginAPI, create_flask_app",
      "severity": "low"
    },
    {
      "file": "features/auth_api/test_auth_api.py",
      "line": 342,
      "type": "config_dependency",
      "description": "mock_config.get.side_effect = lambda key, default=None: test_config.get(key.replace('auth.', '').replace('database.', '').replace('redis.', ''), default)",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/test_auth_api.py",
      "line": 407,
      "type": "perfect21_internal",
      "description": "from features.auth_api.user_login_api import UserLoginAPI",
      "severity": "low"
    },
    {
      "file": "features/auth_api/test_auth_api.py",
      "line": 411,
      "type": "config_dependency",
      "description": "mock_config.get.return_value = 'test-value'",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/test_auth_api.py",
      "line": 447,
      "type": "perfect21_internal",
      "description": "from features.auth_api.user_login_api import UserLoginAPI",
      "severity": "low"
    },
    {
      "file": "features/auth_api/test_auth_api.py",
      "line": 450,
      "type": "config_dependency",
      "description": "mock_config.get.return_value = 'test-value'",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/test_auth_api.py",
      "line": 491,
      "type": "subagent_direct_call",
      "description": "@pytest.mark.asyncio",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/test_auth_api.py",
      "line": 503,
      "type": "subagent_direct_call",
      "description": "'email': 'test@example.com',",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/capability.py",
      "line": 14,
      "type": "perfect21_internal",
      "description": "from features.capability_discovery.capability import CapabilityDefinition",
      "severity": "low"
    },
    {
      "file": "features/auth_api/capability.py",
      "line": 186,
      "type": "subagent_direct_call",
      "description": "\"example\": \"postgresql://user:password@localhost/perfect21_auth\"",
      "severity": "medium"
    },
    {
      "file": "features/auth_api/capability.py",
      "line": 274,
      "type": "perfect21_internal",
      "description": "from features.auth_api.client import Perfect21AuthClient",
      "severity": "low"
    },
    {
      "file": "features/auth_api/capability.py",
      "line": 385,
      "type": "perfect21_internal",
      "description": "from features.capability_discovery.registry import get_capability_registry",
      "severity": "low"
    },
    {
      "file": "features/preventive_quality/quality_gate.py",
      "line": 33,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "features/preventive_quality/quality_gate.py",
      "line": 45,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "features/preventive_quality/quality_gate.py",
      "line": 686,
      "type": "perfect21_internal",
      "description": "from features.multi_workspace import WorkspaceManager",
      "severity": "low"
    },
    {
      "file": "features/preventive_quality/quality_gate.py",
      "line": 754,
      "type": "perfect21_internal",
      "description": "from features.multi_workspace import WorkspaceManager",
      "severity": "low"
    },
    {
      "file": "features/execution_monitor/monitor.py",
      "line": 33,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "features/execution_monitor/monitor.py",
      "line": 49,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "features/execution_monitor/monitor.py",
      "line": 63,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "features/workflow_templates/templates.py",
      "line": 30,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "features/workflow_templates/templates.py",
      "line": 44,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "features/capability_discovery/orchestrator_bridge.py",
      "line": 3,
      "type": "subagent_direct_call",
      "description": "@orchestrator集成桥梁",
      "severity": "medium"
    },
    {
      "file": "features/capability_discovery/orchestrator_bridge.py",
      "line": 11,
      "type": "subagent_direct_call",
      "description": "\"\"\"@orchestrator集成桥梁\"\"\"",
      "severity": "medium"
    },
    {
      "file": "features/capability_discovery/orchestrator_bridge.py",
      "line": 50,
      "type": "subagent_direct_call",
      "description": "\"\"\"为@orchestrator生成能力描述\"\"\"",
      "severity": "medium"
    },
    {
      "file": "features/capability_discovery/orchestrator_bridge.py",
      "line": 85,
      "type": "subagent_direct_call",
      "description": "作为@orchestrator，你可以：",
      "severity": "medium"
    },
    {
      "file": "features/capability_discovery/orchestrator_bridge.py",
      "line": 111,
      "type": "subagent_direct_call",
      "description": "\"\"\"保存能力清单供@orchestrator读取\"\"\"",
      "severity": "medium"
    },
    {
      "file": "features/capability_discovery/orchestrator_bridge.py",
      "line": 119,
      "type": "subagent_direct_call",
      "description": "# 保存给@orchestrator的简报",
      "severity": "medium"
    },
    {
      "file": "features/capability_discovery/orchestrator_bridge.py",
      "line": 130,
      "type": "subagent_direct_call",
      "description": "\"\"\"获取Perfect21信息供@orchestrator使用\"\"\"",
      "severity": "medium"
    },
    {
      "file": "features/capability_discovery/capability.py",
      "line": 9,
      "type": "subagent_direct_call",
      "description": "\"description\": \"动态发现Perfect21功能并为@orchestrator提供集成桥梁\",",
      "severity": "medium"
    },
    {
      "file": "features/capability_discovery/capability.py",
      "line": 28,
      "type": "subagent_direct_call",
      "description": "\"get_perfect21_capabilities\": \"获取Perfect21能力信息供@orchestrator使用\",",
      "severity": "medium"
    },
    {
      "file": "features/capability_discovery/capability.py",
      "line": 30,
      "type": "subagent_direct_call",
      "description": "\"get_capabilities_for_orchestrator\": \"生成@orchestrator专用的功能描述\"",
      "severity": "medium"
    },
    {
      "file": "features/capability_discovery/capability.py",
      "line": 38,
      "type": "subagent_direct_call",
      "description": "\"before_orchestrator_call\", # @orchestrator调用前",
      "severity": "medium"
    },
    {
      "file": "features/capability_discovery/__init__.py",
      "line": 23,
      "type": "subagent_direct_call",
      "description": "\"\"\"获取Perfect21能力信息的主入口 - 供@orchestrator使用\"\"\"",
      "severity": "medium"
    },
    {
      "file": "features/capability_discovery/registry.py",
      "line": 242,
      "type": "orchestrator_dependency",
      "description": "# 简单策略：不注入到orchestrator.md",
      "severity": "high"
    },
    {
      "file": "features/capability_discovery/registry.py",
      "line": 243,
      "type": "orchestrator_dependency",
      "description": "# orchestrator.md已经有完整的Perfect21功能区域，由人工维护",
      "severity": "high"
    },
    {
      "file": "features/execution_supervisor/reminder.py",
      "line": 270,
      "type": "subagent_direct_call",
      "description": "1. 并行调用 @project-manager, @business-analyst, @technical-writer",
      "severity": "medium"
    },
    {
      "file": "features/execution_supervisor/reminder.py",
      "line": 276,
      "type": "subagent_direct_call",
      "description": "1. 并行调用 @api-designer, @backend-architect, @database-specialist",
      "severity": "medium"
    },
    {
      "file": "features/execution_supervisor/reminder.py",
      "line": 282,
      "type": "subagent_direct_call",
      "description": "1. 并行调用 @backend-architect, @frontend-specialist, @test-engineer",
      "severity": "medium"
    },
    {
      "file": "features/execution_supervisor/reminder.py",
      "line": 288,
      "type": "subagent_direct_call",
      "description": "1. 并行调用 @test-engineer, @security-auditor, @performance-engineer",
      "severity": "medium"
    },
    {
      "file": "features/execution_supervisor/reminder.py",
      "line": 294,
      "type": "subagent_direct_call",
      "description": "1. 调用 @devops-engineer, @deployment-manager",
      "severity": "medium"
    },
    {
      "file": "features/execution_supervisor/reminder.py",
      "line": 305,
      "type": "subagent_direct_call",
      "description": "\"使用 Task() 在一个消息中调用多个agents\",",
      "severity": "medium"
    },
    {
      "file": "features/execution_supervisor/supervisor.py",
      "line": 81,
      "type": "subagent_direct_call",
      "description": "3. ✅ 使用单个消息中的多个Task()调用",
      "severity": "medium"
    },
    {
      "file": "features/execution_supervisor/supervisor.py",
      "line": 87,
      "type": "subagent_direct_call",
      "description": "Task(subagent_type='{recommended_agents[0] if recommended_agents else 'agent1'}', prompt='...')",
      "severity": "medium"
    },
    {
      "file": "features/execution_supervisor/supervisor.py",
      "line": 88,
      "type": "subagent_direct_call",
      "description": "Task(subagent_type='{recommended_agents[1] if len(recommended_agents) > 1 else 'agent2'}', prompt='...')",
      "severity": "medium"
    },
    {
      "file": "features/execution_supervisor/supervisor.py",
      "line": 89,
      "type": "subagent_direct_call",
      "description": "Task(subagent_type='{recommended_agents[2] if len(recommended_agents) > 2 else 'agent3'}', prompt='...')",
      "severity": "medium"
    },
    {
      "file": "features/execution_supervisor/supervisor.py",
      "line": 196,
      "type": "subagent_direct_call",
      "description": "3. 使用多个Task()调用agents",
      "severity": "medium"
    },
    {
      "file": "features/multi_workspace/workspace_manager.py",
      "line": 45,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "features/multi_workspace/workspace_manager.py",
      "line": 70,
      "type": "subagent_direct_call",
      "description": "@classmethod",
      "severity": "medium"
    },
    {
      "file": "features/multi_workspace/workspace_manager.py",
      "line": 83,
      "type": "config_dependency",
      "description": "self.config_file = self.workspace_dir / \"workspace_config.json\"",
      "severity": "medium"
    },
    {
      "file": "features/multi_workspace/workspace_manager.py",
      "line": 112,
      "type": "config_dependency",
      "description": "ws_id: ws_config.to_dict()",
      "severity": "medium"
    },
    {
      "file": "features/multi_workspace/workspace_manager.py",
      "line": 221,
      "type": "config_dependency",
      "description": "with open(workspace_path / \"config.json\", 'w', encoding='utf-8') as f:",
      "severity": "medium"
    },
    {
      "file": "features/workflow_orchestrator/task_manager.py",
      "line": 20,
      "type": "config_dependency",
      "description": "'agent': task_config.get('agent'),",
      "severity": "medium"
    },
    {
      "file": "features/workflow_orchestrator/task_manager.py",
      "line": 21,
      "type": "config_dependency",
      "description": "'description': task_config.get('description'),",
      "severity": "medium"
    },
    {
      "file": "features/workflow_orchestrator/task_manager.py",
      "line": 22,
      "type": "config_dependency",
      "description": "'priority': task_config.get('priority', 'medium'),",
      "severity": "medium"
    },
    {
      "file": "features/workflow_orchestrator/task_manager.py",
      "line": 23,
      "type": "config_dependency",
      "description": "'timeout': task_config.get('timeout', 300),",
      "severity": "medium"
    },
    {
      "file": "features/version_manager/version_manager.py",
      "line": 61,
      "type": "config_dependency",
      "description": "'pattern': '**/config.py',",
      "severity": "medium"
    },
    {
      "file": "features/version_manager/semantic_version.py",
      "line": 11,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "features/version_manager/semantic_version.py",
      "line": 54,
      "type": "subagent_direct_call",
      "description": "@classmethod",
      "severity": "medium"
    },
    {
      "file": "features/version_manager/semantic_version.py",
      "line": 81,
      "type": "subagent_direct_call",
      "description": "@classmethod",
      "severity": "medium"
    },
    {
      "file": "features/version_manager/semantic_version.py",
      "line": 94,
      "type": "subagent_direct_call",
      "description": "@classmethod",
      "severity": "medium"
    },
    {
      "file": "features/version_manager/semantic_version.py",
      "line": 134,
      "type": "subagent_direct_call",
      "description": "@classmethod",
      "severity": "medium"
    },
    {
      "file": "features/version_manager/semantic_version.py",
      "line": 159,
      "type": "subagent_direct_call",
      "description": "@classmethod",
      "severity": "medium"
    },
    {
      "file": "features/version_manager/semantic_version.py",
      "line": 184,
      "type": "subagent_direct_call",
      "description": "@classmethod",
      "severity": "medium"
    },
    {
      "file": "features/version_manager/semantic_version.py",
      "line": 204,
      "type": "subagent_direct_call",
      "description": "@classmethod",
      "severity": "medium"
    },
    {
      "file": "features/version_manager/semantic_version.py",
      "line": 224,
      "type": "subagent_direct_call",
      "description": "@classmethod",
      "severity": "medium"
    },
    {
      "file": "features/version_manager/semantic_version.py",
      "line": 250,
      "type": "subagent_direct_call",
      "description": "@classmethod",
      "severity": "medium"
    },
    {
      "file": "features/version_manager/semantic_version.py",
      "line": 265,
      "type": "subagent_direct_call",
      "description": "@classmethod",
      "severity": "medium"
    },
    {
      "file": "features/version_manager/capability.py",
      "line": 67,
      "type": "config_dependency",
      "description": "\"modules/config.py\",",
      "severity": "medium"
    },
    {
      "file": "features/sync_point_manager/sync_points.py",
      "line": 36,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "features/sync_point_manager/sync_points.py",
      "line": 45,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "features/sync_point_manager/sync_points.py",
      "line": 55,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "features/sync_point_manager/sync_points.py",
      "line": 179,
      "type": "subagent_direct_call",
      "description": "- @security-auditor: 从安全角度评审",
      "severity": "medium"
    },
    {
      "file": "features/sync_point_manager/sync_points.py",
      "line": 180,
      "type": "subagent_direct_call",
      "description": "- @performance-engineer: 从性能角度评审",
      "severity": "medium"
    },
    {
      "file": "features/sync_point_manager/sync_points.py",
      "line": 181,
      "type": "subagent_direct_call",
      "description": "- @devops-engineer: 从运维角度评审",
      "severity": "medium"
    },
    {
      "file": "features/sync_point_manager/sync_manager.py",
      "line": 19,
      "type": "config_dependency",
      "description": "'name': sync_config.get('name'),",
      "severity": "medium"
    },
    {
      "file": "features/sync_point_manager/sync_manager.py",
      "line": 20,
      "type": "config_dependency",
      "description": "'type': sync_config.get('type'),",
      "severity": "medium"
    },
    {
      "file": "features/sync_point_manager/sync_manager.py",
      "line": 21,
      "type": "config_dependency",
      "description": "'criteria': sync_config.get('criteria', []),",
      "severity": "medium"
    },
    {
      "file": "features/sync_point_manager/sync_manager.py",
      "line": 22,
      "type": "config_dependency",
      "description": "'timeout': sync_config.get('timeout', 300),",
      "severity": "medium"
    },
    {
      "file": "features/phase_executor/phase_executor.py",
      "line": 13,
      "type": "perfect21_internal",
      "description": "from features.execution_supervisor import (",
      "severity": "low"
    },
    {
      "file": "features/phase_executor/phase_executor.py",
      "line": 144,
      "type": "subagent_direct_call",
      "description": "agent_calls.append(f\"Task(subagent_type='{agent}', prompt='...')\")",
      "severity": "medium"
    },
    {
      "file": "features/phase_executor/phase_executor.py",
      "line": 206,
      "type": "config_dependency",
      "description": "git_ops = config.get('git_operations', [])",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/branch_manager.py",
      "line": 22,
      "type": "git_workflow_coupling",
      "description": "self.git_hooks = GitHooks(project_root)",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/branch_manager.py",
      "line": 115,
      "type": "git_workflow_coupling",
      "description": "validation_result = self.git_hooks.call_subagent(",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/branch_manager.py",
      "line": 116,
      "type": "subagent_direct_call",
      "description": "'@business-analyst',",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/branch_manager.py",
      "line": 148,
      "type": "git_workflow_coupling",
      "description": "strategy_result = self.git_hooks.call_subagent(",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/branch_manager.py",
      "line": 149,
      "type": "subagent_direct_call",
      "description": "'@devops-engineer',",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/branch_manager.py",
      "line": 177,
      "type": "subagent_direct_call",
      "description": "'1. 代码审查 (@code-reviewer)',",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/branch_manager.py",
      "line": 178,
      "type": "subagent_direct_call",
      "description": "'2. 运行测试套件 (@test-engineer)',",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/branch_manager.py",
      "line": 184,
      "type": "subagent_direct_call",
      "description": "'1. 完整质量检查 (@orchestrator)',",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/branch_manager.py",
      "line": 185,
      "type": "subagent_direct_call",
      "description": "'2. 安全审计 (@security-auditor)',",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/branch_manager.py",
      "line": 186,
      "type": "subagent_direct_call",
      "description": "'3. 性能验证 (@performance-engineer)',",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/branch_manager.py",
      "line": 187,
      "type": "subagent_direct_call",
      "description": "'4. 部署就绪检查 (@devops-engineer)',",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/branch_manager.py",
      "line": 194,
      "type": "subagent_direct_call",
      "description": "'1. 紧急安全检查 (@security-auditor)',",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/branch_manager.py",
      "line": 195,
      "type": "subagent_direct_call",
      "description": "'2. 关键路径测试 (@test-engineer)',",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/branch_manager.py",
      "line": 196,
      "type": "subagent_direct_call",
      "description": "'3. 快速部署验证 (@devops-engineer)',",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/branch_manager.py",
      "line": 228,
      "type": "git_workflow_coupling",
      "description": "cleanup_result = self.git_hooks.call_subagent(",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/branch_manager.py",
      "line": 229,
      "type": "subagent_direct_call",
      "description": "'@devops-engineer',",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/branch_manager.py",
      "line": 264,
      "type": "git_workflow_coupling",
      "description": "git_status = self.git_hooks.get_git_status()",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/test_plugin_integration.py",
      "line": 14,
      "type": "perfect21_internal",
      "description": "from features.git_workflow.hooks_manager import GitHooksManager",
      "severity": "low"
    },
    {
      "file": "features/git_workflow/hooks.py",
      "line": 28,
      "type": "subagent_direct_call",
      "description": "'code_review': '@code-reviewer',",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks.py",
      "line": 29,
      "type": "subagent_direct_call",
      "description": "'security_audit': '@security-auditor',",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks.py",
      "line": 30,
      "type": "subagent_direct_call",
      "description": "'test_execution': '@test-engineer',",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks.py",
      "line": 31,
      "type": "subagent_direct_call",
      "description": "'performance_check': '@performance-engineer',",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks.py",
      "line": 32,
      "type": "subagent_direct_call",
      "description": "'deployment_check': '@devops-engineer',",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks.py",
      "line": 33,
      "type": "subagent_direct_call",
      "description": "'quality_gate': '@orchestrator'",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks.py",
      "line": 42,
      "type": "subagent_direct_call",
      "description": "'@orchestrator': ['@orchestrator', '@code-reviewer', '@security-auditor', '@test-engineer'],",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks.py",
      "line": 43,
      "type": "subagent_direct_call",
      "description": "'@code-reviewer': ['@code-reviewer', '@security-auditor', '@test-engineer'],",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks.py",
      "line": 44,
      "type": "subagent_direct_call",
      "description": "'@security-auditor': ['@security-auditor', '@test-engineer', '@devops-engineer'],",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks.py",
      "line": 45,
      "type": "subagent_direct_call",
      "description": "'@test-engineer': ['@test-engineer', '@code-reviewer', '@devops-engineer'],",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks.py",
      "line": 46,
      "type": "subagent_direct_call",
      "description": "'@devops-engineer': ['@devops-engineer', '@security-auditor', '@test-engineer']",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks.py",
      "line": 50,
      "type": "subagent_direct_call",
      "description": "agents = base_parallel_agents.get(primary_agent, [primary_agent, '@code-reviewer', '@test-engineer'])",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks.py",
      "line": 57,
      "type": "subagent_direct_call",
      "description": "agents = ['@orchestrator', '@code-reviewer', '@security-auditor', '@test-engineer', '@devops-engineer']",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks.py",
      "line": 60,
      "type": "subagent_direct_call",
      "description": "agents = ['@code-reviewer', '@test-engineer', '@security-auditor']",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks.py",
      "line": 63,
      "type": "subagent_direct_call",
      "description": "agents = ['@test-engineer', '@code-reviewer', '@devops-engineer']",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks.py",
      "line": 159,
      "type": "subagent_direct_call",
      "description": "parallel_instructions.append(f\"Task(subagent_type='{agent_name}', ...)\")",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks.py",
      "line": 207,
      "type": "subagent_direct_call",
      "description": "agents = ['@code-reviewer', '@security-auditor', '@test-engineer']",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks.py",
      "line": 219,
      "type": "subagent_direct_call",
      "description": "agents = ['@code-reviewer']",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks.py",
      "line": 223,
      "type": "subagent_direct_call",
      "description": "agents.append('@test-engineer')",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks.py",
      "line": 254,
      "type": "subagent_direct_call",
      "description": "agents = ['@test-engineer', '@performance-engineer', '@devops-engineer']",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks.py",
      "line": 266,
      "type": "subagent_direct_call",
      "description": "agents = ['@test-engineer']  # 只需要测试验证",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks.py",
      "line": 279,
      "type": "subagent_direct_call",
      "description": "agents = ['@test-engineer']",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks.py",
      "line": 282,
      "type": "subagent_direct_call",
      "description": "agents.append('@code-reviewer')",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks.py",
      "line": 339,
      "type": "subagent_direct_call",
      "description": "['@business-analyst'],",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks.py",
      "line": 366,
      "type": "subagent_direct_call",
      "description": "['@business-analyst'],",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks.py",
      "line": 398,
      "type": "subagent_direct_call",
      "description": "['@devops-engineer'],",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/install_hooks.py",
      "line": 148,
      "type": "subagent_direct_call",
      "description": "print(\"  git commit → 自动调用@orchestrator质量检查\")",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/install_hooks.py",
      "line": 149,
      "type": "subagent_direct_call",
      "description": "print(\"  git push   → 自动调用@test-engineer验证\")",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/install_hooks.py",
      "line": 150,
      "type": "subagent_direct_call",
      "description": "print(\"  git checkout → 自动调用@devops-engineer环境配置\")",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/workflow.py",
      "line": 22,
      "type": "git_workflow_coupling",
      "description": "self.git_hooks = GitHooks(project_root)",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/workflow.py",
      "line": 106,
      "type": "git_workflow_coupling",
      "description": "setup_result = self.git_hooks.call_subagent(",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/workflow.py",
      "line": 107,
      "type": "subagent_direct_call",
      "description": "'@devops-engineer',",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/workflow.py",
      "line": 157,
      "type": "git_workflow_coupling",
      "description": "release_result = self.git_hooks.call_subagent(",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/workflow.py",
      "line": 158,
      "type": "subagent_direct_call",
      "description": "'@orchestrator',",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/workflow.py",
      "line": 189,
      "type": "git_workflow_coupling",
      "description": "pre_merge_result = self.git_hooks.call_subagent(",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/workflow.py",
      "line": 190,
      "type": "subagent_direct_call",
      "description": "'@orchestrator',",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/workflow.py",
      "line": 221,
      "type": "git_workflow_coupling",
      "description": "post_merge_result = self.git_hooks.call_subagent(",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/workflow.py",
      "line": 222,
      "type": "subagent_direct_call",
      "description": "'@deployment-manager',",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/workflow.py",
      "line": 251,
      "type": "git_workflow_coupling",
      "description": "git_status = self.git_hooks.get_git_status()",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/config_loader.py",
      "line": 22,
      "type": "config_dependency",
      "description": "'features/git_workflow/hooks_config.yaml'",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/config_loader.py",
      "line": 66,
      "type": "config_dependency",
      "description": "return self._config.get('global', {})",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/config_loader.py",
      "line": 70,
      "type": "config_dependency",
      "description": "hooks_config = self._config.get('hooks', {})",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/config_loader.py",
      "line": 71,
      "type": "config_dependency",
      "description": "return hooks_config.get(hook_name)",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/config_loader.py",
      "line": 75,
      "type": "config_dependency",
      "description": "groups = self._config.get('hook_groups', {})",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/config_loader.py",
      "line": 83,
      "type": "config_dependency",
      "description": "return group_config.get('hooks', [])",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/config_loader.py",
      "line": 87,
      "type": "config_dependency",
      "description": "hooks_config = self._config.get('hooks', {})",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/config_loader.py",
      "line": 89,
      "type": "config_dependency",
      "description": "for hook_name, config in hooks_config.items():",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/config_loader.py",
      "line": 90,
      "type": "config_dependency",
      "description": "if config.get('enabled', False):",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/config_loader.py",
      "line": 97,
      "type": "config_dependency",
      "description": "return self._config.get('default_hook_group', 'essential')",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/config_loader.py",
      "line": 104,
      "type": "config_dependency",
      "description": "return hook_config.get('enabled', False)",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/config_loader.py",
      "line": 110,
      "type": "subagent_direct_call",
      "description": "return \"@orchestrator\"",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/config_loader.py",
      "line": 118,
      "type": "subagent_direct_call",
      "description": "return branch_rules[branch].get('agent', hook_config.get('agent', '@orchestrator'))",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/config_loader.py",
      "line": 118,
      "type": "config_dependency",
      "description": "return branch_rules[branch].get('agent', hook_config.get('agent', '@orchestrator'))",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/config_loader.py",
      "line": 125,
      "type": "subagent_direct_call",
      "description": "return rule.get('agent', hook_config.get('agent', '@orchestrator'))",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/config_loader.py",
      "line": 125,
      "type": "config_dependency",
      "description": "return rule.get('agent', hook_config.get('agent', '@orchestrator'))",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/config_loader.py",
      "line": 127,
      "type": "subagent_direct_call",
      "description": "return hook_config.get('agent', '@orchestrator')",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/config_loader.py",
      "line": 127,
      "type": "config_dependency",
      "description": "return hook_config.get('agent', '@orchestrator')",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/config_loader.py",
      "line": 133,
      "type": "config_dependency",
      "description": "return hook_config.get('timeout', 120)",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/config_loader.py",
      "line": 136,
      "type": "config_dependency",
      "description": "return global_config.get('timeout', 300)",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/config_loader.py",
      "line": 146,
      "type": "config_dependency",
      "description": "return global_config.get('parallel_execution', True)",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/config_loader.py",
      "line": 151,
      "type": "config_dependency",
      "description": "return global_config.get('max_workers', 4)",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/config_loader.py",
      "line": 155,
      "type": "config_dependency",
      "description": "plugins = self._config.get('plugins', {})",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/config_loader.py",
      "line": 164,
      "type": "config_dependency",
      "description": "return hook_config.get('plugins', [])",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/config_loader.py",
      "line": 171,
      "type": "config_dependency",
      "description": "environments = self._config.get('environments', {})",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/config_loader.py",
      "line": 176,
      "type": "config_dependency",
      "description": "integrations = self._config.get('integrations', {})",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/config_loader.py",
      "line": 191,
      "type": "config_dependency",
      "description": "hooks_config = self._config.get('hooks', {})",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/config_loader.py",
      "line": 192,
      "type": "config_dependency",
      "description": "for hook_name, config in hooks_config.items():",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/config_loader.py",
      "line": 204,
      "type": "config_dependency",
      "description": "groups = self._config.get('hook_groups', {})",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/config_loader.py",
      "line": 279,
      "type": "config_dependency",
      "description": "hooks_config = self._config.get('hooks', {})",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/config_loader.py",
      "line": 281,
      "type": "config_dependency",
      "description": "enabled_hooks = [name for name, config in hooks_config.items() if config.get('enabled')]",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/config_loader.py",
      "line": 286,
      "type": "config_dependency",
      "description": "项目: {global_config.get('project_name', 'Unknown')}",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/config_loader.py",
      "line": 287,
      "type": "config_dependency",
      "description": "版本: {global_config.get('version', 'Unknown')}",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/config_loader.py",
      "line": 288,
      "type": "config_dependency",
      "description": "并行执行: {'启用' if global_config.get('parallel_execution') else '禁用'}",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/config_loader.py",
      "line": 289,
      "type": "config_dependency",
      "description": "最大工作线程: {global_config.get('max_workers', 4)}",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks_manager.py",
      "line": 27,
      "type": "git_workflow_coupling",
      "description": "self.git_hooks = GitHooks(project_root)",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks_manager.py",
      "line": 58,
      "type": "config_dependency",
      "description": "yaml_hooks = self.config_loader._config.get('hooks', {})",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks_manager.py",
      "line": 62,
      "type": "config_dependency",
      "description": "'category': yaml_config.get('category', 'unknown'),",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks_manager.py",
      "line": 63,
      "type": "config_dependency",
      "description": "'priority': yaml_config.get('priority', 'medium'),",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks_manager.py",
      "line": 64,
      "type": "subagent_direct_call",
      "description": "'subagent': yaml_config.get('agent', '@orchestrator'),",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks_manager.py",
      "line": 64,
      "type": "config_dependency",
      "description": "'subagent': yaml_config.get('agent', '@orchestrator'),",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks_manager.py",
      "line": 65,
      "type": "config_dependency",
      "description": "'description': yaml_config.get('description', f'{hook_name}钩子'),",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks_manager.py",
      "line": 66,
      "type": "config_dependency",
      "description": "'triggers': yaml_config.get('triggers', []),",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks_manager.py",
      "line": 67,
      "type": "config_dependency",
      "description": "'required': yaml_config.get('enabled', False),",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks_manager.py",
      "line": 68,
      "type": "config_dependency",
      "description": "'timeout': yaml_config.get('timeout', 120),",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks_manager.py",
      "line": 69,
      "type": "config_dependency",
      "description": "'parallel': yaml_config.get('parallel', False),",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks_manager.py",
      "line": 70,
      "type": "config_dependency",
      "description": "'plugins': yaml_config.get('plugins', [])",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks_manager.py",
      "line": 77,
      "type": "config_dependency",
      "description": "yaml_groups = self.config_loader._config.get('hook_groups', {})",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks_manager.py",
      "line": 81,
      "type": "config_dependency",
      "description": "hook_groups[group_name] = group_config.get('hooks', [])",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks_manager.py",
      "line": 197,
      "type": "config_dependency",
      "description": "hook_config = self.hooks_config.get(hook_name, {})",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks_manager.py",
      "line": 198,
      "type": "subagent_direct_call",
      "description": "subagent = hook_config.get('subagent', '@orchestrator')",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks_manager.py",
      "line": 198,
      "type": "config_dependency",
      "description": "subagent = hook_config.get('subagent', '@orchestrator')",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks_manager.py",
      "line": 199,
      "type": "config_dependency",
      "description": "description = hook_config.get('description', f'{hook_name}钩子')",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks_manager.py",
      "line": 400,
      "type": "subagent_direct_call",
      "description": "print(\"  🔍 git commit   → 自动代码质量检查 (@orchestrator/@code-reviewer)\")",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks_manager.py",
      "line": 401,
      "type": "subagent_direct_call",
      "description": "print(\"  🚀 git push     → 自动测试验证 (@test-engineer)\")",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks_manager.py",
      "line": 402,
      "type": "subagent_direct_call",
      "description": "print(\"  🌿 git checkout → 自动环境配置 (@devops-engineer)\")",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks_manager.py",
      "line": 405,
      "type": "subagent_direct_call",
      "description": "print(\"  💬 commit消息   → 自动格式验证 (@business-analyst)\")",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks_manager.py",
      "line": 406,
      "type": "subagent_direct_call",
      "description": "print(\"  🔄 git merge    → 自动集成测试 (@test-engineer)\")",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks_manager.py",
      "line": 409,
      "type": "subagent_direct_call",
      "description": "print(\"  📝 git rebase   → 自动冲突预检 (@code-reviewer)\")",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks_manager.py",
      "line": 410,
      "type": "subagent_direct_call",
      "description": "print(\"  🧹 git gc       → 自动备份清理 (@devops-engineer)\")",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks_manager.py",
      "line": 418,
      "type": "config_dependency",
      "description": "hook_names = list(self.hooks_config.keys())",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks_manager.py",
      "line": 459,
      "type": "config_dependency",
      "description": "for hook_name, config in self.hooks_config.items():",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks_manager.py",
      "line": 597,
      "type": "git_workflow_coupling",
      "description": "self.git_hooks.cleanup()",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/hooks_manager.py",
      "line": 601,
      "type": "config_dependency",
      "description": "self.hooks_config.clear()",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/plugins/base_plugin.py",
      "line": 37,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/plugins/base_plugin.py",
      "line": 61,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/plugins/base_plugin.py",
      "line": 97,
      "type": "config_dependency",
      "description": "self.enabled = self.config.get('enabled', True)",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/plugins/base_plugin.py",
      "line": 103,
      "type": "subagent_direct_call",
      "description": "@abstractmethod",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/plugins/base_plugin.py",
      "line": 108,
      "type": "subagent_direct_call",
      "description": "@abstractmethod",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/plugins/base_plugin.py",
      "line": 161,
      "type": "config_dependency",
      "description": "return self.config.get(key, default)",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/plugins/plugin_manager.py",
      "line": 134,
      "type": "config_dependency",
      "description": "plugin_config = self.config.get('plugins', {}).get(plugin_name, {})",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/plugins/plugin_manager.py",
      "line": 137,
      "type": "config_dependency",
      "description": "plugin_instance = plugin_class(plugin_config.get('config', {}))",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/plugins/plugin_manager.py",
      "line": 412,
      "type": "config_dependency",
      "description": "plugin.config.clear()",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/plugins/plugin_manager.py",
      "line": 501,
      "type": "config_dependency",
      "description": "self.config.clear()",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/plugins/built_in/security_scan.py",
      "line": 19,
      "type": "perfect21_internal",
      "description": "from features.git_workflow.plugins.base_plugin import (",
      "severity": "low"
    },
    {
      "file": "features/git_workflow/plugins/built_in/message_validator.py",
      "line": 15,
      "type": "perfect21_internal",
      "description": "from features.git_workflow.plugins.base_plugin import (",
      "severity": "low"
    },
    {
      "file": "features/git_workflow/plugins/built_in/test_runner.py",
      "line": 17,
      "type": "perfect21_internal",
      "description": "from features.git_workflow.plugins.base_plugin import (",
      "severity": "low"
    },
    {
      "file": "features/git_workflow/plugins/built_in/test_runner.py",
      "line": 92,
      "type": "config_dependency",
      "description": "'config_files': ['jest.config.js', 'package.json'],",
      "severity": "medium"
    },
    {
      "file": "features/git_workflow/plugins/built_in/commit_quality.py",
      "line": 18,
      "type": "perfect21_internal",
      "description": "from features.git_workflow.plugins.base_plugin import (",
      "severity": "low"
    },
    {
      "file": "features/learning_feedback/improvement_suggester.py",
      "line": 35,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "features/learning_feedback/pattern_analyzer.py",
      "line": 28,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "features/learning_feedback/learning_engine.py",
      "line": 35,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "features/learning_feedback/learning_engine.py",
      "line": 48,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "features/learning_feedback/learning_engine.py",
      "line": 59,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "features/learning_feedback/learning_engine.py",
      "line": 73,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "features/learning_feedback/feedback_collector.py",
      "line": 34,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "features/workflow_engine/engine.py",
      "line": 32,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "features/workflow_engine/engine.py",
      "line": 50,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "features/workflow_engine/engine.py",
      "line": 91,
      "type": "subagent_direct_call",
      "description": "task = AgentTask(",
      "severity": "medium"
    },
    {
      "file": "features/workflow_engine/engine.py",
      "line": 176,
      "type": "subagent_direct_call",
      "description": "task = AgentTask(",
      "severity": "medium"
    },
    {
      "file": "features/workflow_engine/engine.py",
      "line": 302,
      "type": "subagent_direct_call",
      "description": "task = AgentTask(",
      "severity": "medium"
    },
    {
      "file": "features/decision_recorder/adr_manager.py",
      "line": 38,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "features/decision_recorder/adr_manager.py",
      "line": 48,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "features/claude_md_manager/template_manager.py",
      "line": 86,
      "type": "config_dependency",
      "description": "for key, value in user_config.items():",
      "severity": "medium"
    },
    {
      "file": "features/claude_md_manager/template_engine.py",
      "line": 18,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "features/claude_md_manager/template_engine.py",
      "line": 30,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "features/claude_md_manager/manager.py",
      "line": 21,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "features/claude_md_manager/manager.py",
      "line": 31,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "features/claude_md_manager/dynamic_updater.py",
      "line": 113,
      "type": "perfect21_internal",
      "description": "from features.version_manager.version_manager import VersionManager",
      "severity": "low"
    },
    {
      "file": "features/claude_md_manager/smart_updater.py",
      "line": 21,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "features/claude_md_manager/smart_updater.py",
      "line": 31,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "features/claude_md_manager/smart_updater.py",
      "line": 119,
      "type": "perfect21_internal",
      "description": "from features.version_manager.version_manager import VersionManager",
      "severity": "low"
    },
    {
      "file": "features/claude_md_manager/lifecycle_manager.py",
      "line": 20,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "features/claude_md_manager/lifecycle_manager.py",
      "line": 33,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "features/claude_md_manager/lifecycle_manager.py",
      "line": 42,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "features/claude_md_manager/smart_classifier.py",
      "line": 18,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "features/claude_md_manager/smart_classifier.py",
      "line": 32,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "main/perfect21_controller.py",
      "line": 17,
      "type": "perfect21_internal",
      "description": "from features.git_workflow import GitHooks, WorkflowManager, BranchManager",
      "severity": "low"
    },
    {
      "file": "main/cli_optimized.py",
      "line": 24,
      "type": "config_dependency",
      "description": "from infrastructure.config.config_manager import get_config_manager",
      "severity": "medium"
    },
    {
      "file": "main/cli_optimized.py",
      "line": 95,
      "type": "config_dependency",
      "description": "from infrastructure.config.config_manager import get_config",
      "severity": "medium"
    },
    {
      "file": "main/perfect21.py",
      "line": 15,
      "type": "config_dependency",
      "description": "from modules.config import config",
      "severity": "medium"
    },
    {
      "file": "main/perfect21.py",
      "line": 18,
      "type": "perfect21_internal",
      "description": "from features.git_workflow import GitHooks, WorkflowManager, BranchManager",
      "severity": "low"
    },
    {
      "file": "main/perfect21.py",
      "line": 27,
      "type": "config_dependency",
      "description": "self.config.get('logging.level', 'INFO'),",
      "severity": "medium"
    },
    {
      "file": "main/perfect21.py",
      "line": 28,
      "type": "config_dependency",
      "description": "self.config.get('logging.file', 'logs/perfect21.log')",
      "severity": "medium"
    },
    {
      "file": "main/perfect21.py",
      "line": 40,
      "type": "config_dependency",
      "description": "self.config.get('logging.level', 'INFO'),",
      "severity": "medium"
    },
    {
      "file": "main/perfect21.py",
      "line": 41,
      "type": "config_dependency",
      "description": "self.config.get('logging.file', 'logs/perfect21.log')",
      "severity": "medium"
    },
    {
      "file": "main/perfect21.py",
      "line": 45,
      "type": "git_workflow_coupling",
      "description": "self.git_hooks = GitHooks(self.project_root)",
      "severity": "medium"
    },
    {
      "file": "main/perfect21.py",
      "line": 55,
      "type": "git_workflow_coupling",
      "description": "hook_status = self.git_hooks.get_hook_status()",
      "severity": "medium"
    },
    {
      "file": "main/perfect21.py",
      "line": 61,
      "type": "config_dependency",
      "description": "'version': self.config.get('perfect21.version'),",
      "severity": "medium"
    },
    {
      "file": "main/perfect21.py",
      "line": 62,
      "type": "config_dependency",
      "description": "'mode': self.config.get('perfect21.mode'),",
      "severity": "medium"
    },
    {
      "file": "main/perfect21.py",
      "line": 90,
      "type": "git_workflow_coupling",
      "description": "result = self.git_hooks.pre_commit_hook()",
      "severity": "medium"
    },
    {
      "file": "main/perfect21.py",
      "line": 93,
      "type": "git_workflow_coupling",
      "description": "result = self.git_hooks.pre_push_hook(remote)",
      "severity": "medium"
    },
    {
      "file": "main/perfect21.py",
      "line": 96,
      "type": "git_workflow_coupling",
      "description": "result = self.git_hooks.post_checkout_hook(old_ref, new_ref, branch_flag)",
      "severity": "medium"
    },
    {
      "file": "main/perfect21.py",
      "line": 99,
      "type": "git_workflow_coupling",
      "description": "result = self.git_hooks.prepare_commit_msg_hook(commit_msg_file)",
      "severity": "medium"
    },
    {
      "file": "main/perfect21.py",
      "line": 102,
      "type": "git_workflow_coupling",
      "description": "result = self.git_hooks.commit_msg_hook(commit_msg_file)",
      "severity": "medium"
    },
    {
      "file": "main/perfect21.py",
      "line": 104,
      "type": "git_workflow_coupling",
      "description": "result = self.git_hooks.post_commit_hook()",
      "severity": "medium"
    },
    {
      "file": "main/perfect21.py",
      "line": 209,
      "type": "git_workflow_coupling",
      "description": "self.git_hooks.cleanup()",
      "severity": "medium"
    },
    {
      "file": "main/cli.py",
      "line": 60,
      "type": "perfect21_internal",
      "description": "from features.git_workflow.hooks_manager import GitHooksManager",
      "severity": "low"
    },
    {
      "file": "main/cli.py",
      "line": 79,
      "type": "config_dependency",
      "description": "for hook_name, config in hooks_manager.hooks_config.items():",
      "severity": "medium"
    },
    {
      "file": "main/cli.py",
      "line": 104,
      "type": "config_dependency",
      "description": "print(f\"可用钩子: {', '.join(hooks_manager.hooks_config.keys())}\")",
      "severity": "medium"
    },
    {
      "file": "main/cli.py",
      "line": 261,
      "type": "perfect21_internal",
      "description": "from features.claude_md_manager import (",
      "severity": "critical"
    },
    {
      "file": "main/cli.py",
      "line": 449,
      "type": "perfect21_internal",
      "description": "from features.multi_workspace import WorkspaceIntegration",
      "severity": "low"
    },
    {
      "file": "main/cli.py",
      "line": 485,
      "type": "perfect21_internal",
      "description": "from features.capability_discovery import get_perfect21_capabilities",
      "severity": "low"
    },
    {
      "file": "main/cli.py",
      "line": 504,
      "type": "subagent_direct_call",
      "description": "print(\"\\n💡 提示: @orchestrator现在了解Perfect21的所有扩展功能\")",
      "severity": "medium"
    },
    {
      "file": "main/cli.py",
      "line": 505,
      "type": "subagent_direct_call",
      "description": "print(\"🚀 你可以直接向@orchestrator说明需要使用Perfect21的哪些功能\")",
      "severity": "medium"
    },
    {
      "file": "main/cli.py",
      "line": 506,
      "type": "subagent_direct_call",
      "description": "print(\"📋 例如: '@orchestrator 使用Perfect21的git_workflow功能进行代码检查'\")",
      "severity": "medium"
    },
    {
      "file": "main/cli.py",
      "line": 512,
      "type": "subagent_direct_call",
      "description": "print(\"💡 你仍然可以直接与@orchestrator对话\")",
      "severity": "medium"
    },
    {
      "file": "main/cli.py",
      "line": 517,
      "type": "perfect21_internal",
      "description": "from features.smart_decomposer import get_smart_decomposer",
      "severity": "low"
    },
    {
      "file": "main/cli.py",
      "line": 518,
      "type": "perfect21_internal",
      "description": "from features.parallel_executor import get_parallel_executor",
      "severity": "low"
    },
    {
      "file": "main/cli.py",
      "line": 587,
      "type": "perfect21_internal",
      "description": "from features.parallel_executor import get_parallel_executor",
      "severity": "low"
    },
    {
      "file": "main/cli.py",
      "line": 627,
      "type": "perfect21_internal",
      "description": "from features.parallel_executor import get_parallel_executor",
      "severity": "low"
    },
    {
      "file": "main/cli.py",
      "line": 651,
      "type": "subagent_direct_call",
      "description": "\"\"\"处理@orchestrator对话命令（强制并行模式）\"\"\"",
      "severity": "medium"
    },
    {
      "file": "main/cli.py",
      "line": 652,
      "type": "subagent_direct_call",
      "description": "print(\"🚀 Perfect21 @orchestrator 强制并行网关\")",
      "severity": "medium"
    },
    {
      "file": "main/cli.py",
      "line": 656,
      "type": "perfect21_internal",
      "description": "from features.capability_discovery import get_perfect21_capabilities",
      "severity": "low"
    },
    {
      "file": "main/cli.py",
      "line": 680,
      "type": "subagent_direct_call",
      "description": "print(\"🎯 @orchestrator调用已准备 (包含Perfect21完整能力)\")",
      "severity": "medium"
    },
    {
      "file": "main/cli.py",
      "line": 682,
      "type": "subagent_direct_call",
      "description": "print(\"📋 请复制以下内容到Claude Code中调用@orchestrator:\")",
      "severity": "medium"
    },
    {
      "file": "main/cli.py",
      "line": 692,
      "type": "subagent_direct_call",
      "description": "print(f\"❌ @orchestrator调用准备失败: {e}\")",
      "severity": "medium"
    },
    {
      "file": "main/cli.py",
      "line": 697,
      "type": "perfect21_internal",
      "description": "from features.multi_workspace import WorkspaceManager, WorkspaceType, WorkspaceIntegration",
      "severity": "low"
    },
    {
      "file": "main/cli.py",
      "line": 836,
      "type": "perfect21_internal",
      "description": "from features.learning_feedback import (",
      "severity": "low"
    },
    {
      "file": "main/cli.py",
      "line": 983,
      "type": "perfect21_internal",
      "description": "from features.learning_feedback.improvement_suggester import Priority",
      "severity": "low"
    },
    {
      "file": "main/cli.py",
      "line": 988,
      "type": "perfect21_internal",
      "description": "from features.learning_feedback.improvement_suggester import ImprovementCategory",
      "severity": "low"
    },
    {
      "file": "main/cli.py",
      "line": 1060,
      "type": "subagent_direct_call",
      "description": "print(\"💡 @orchestrator会自动选择最合适的开发模式\")",
      "severity": "medium"
    },
    {
      "file": "main/cli.py",
      "line": 1097,
      "type": "subagent_direct_call",
      "description": "# orchestrator命令 - 直接与@orchestrator对话",
      "severity": "medium"
    },
    {
      "file": "main/cli.py",
      "line": 1098,
      "type": "subagent_direct_call",
      "description": "orchestrator_parser = subparsers.add_parser('orchestrator', help='直接与@orchestrator对话 (强制并行)')",
      "severity": "medium"
    },
    {
      "file": "main/cli.py",
      "line": 1099,
      "type": "subagent_direct_call",
      "description": "orchestrator_parser.add_argument('request', help='你想让@orchestrator做什么')",
      "severity": "medium"
    },
    {
      "file": "main/cli.py",
      "line": 1100,
      "type": "subagent_direct_call",
      "description": "orchestrator_parser.add_argument('--execute', action='store_true', help='立即执行@orchestrator调用')",
      "severity": "medium"
    },
    {
      "file": "main/cli.py",
      "line": 1337,
      "type": "subagent_direct_call",
      "description": "'agents_called': ['@backend-architect', '@test-engineer']",
      "severity": "medium"
    },
    {
      "file": "application/cli/command_base.py",
      "line": 17,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "application/cli/command_base.py",
      "line": 42,
      "type": "subagent_direct_call",
      "description": "@abstractmethod",
      "severity": "medium"
    },
    {
      "file": "application/cli/command_base.py",
      "line": 55,
      "type": "subagent_direct_call",
      "description": "@abstractmethod",
      "severity": "medium"
    },
    {
      "file": "application/cli/commands/hooks_command.py",
      "line": 23,
      "type": "perfect21_internal",
      "description": "from features.git_workflow.hooks_manager import GitHooksManager",
      "severity": "low"
    },
    {
      "file": "application/cli/commands/hooks_command.py",
      "line": 77,
      "type": "perfect21_internal",
      "description": "from features.git_workflow.hooks_manager import GitHooksManager",
      "severity": "low"
    },
    {
      "file": "application/cli/commands/hooks_command.py",
      "line": 131,
      "type": "perfect21_internal",
      "description": "from features.git_workflow.hooks_manager import GitHooksManager",
      "severity": "low"
    },
    {
      "file": "application/cli/commands/hooks_command.py",
      "line": 238,
      "type": "perfect21_internal",
      "description": "from features.git_workflow.hooks_manager import GitHooksManager",
      "severity": "low"
    },
    {
      "file": "application/cli/commands/hooks_command.py",
      "line": 285,
      "type": "config_dependency",
      "description": "for hook_name, config in hooks_config.items():",
      "severity": "medium"
    },
    {
      "file": "application/cli/commands/hooks_command.py",
      "line": 286,
      "type": "config_dependency",
      "description": "if config.get('category') == category:",
      "severity": "medium"
    },
    {
      "file": "application/cli/commands/hooks_command.py",
      "line": 287,
      "type": "config_dependency",
      "description": "required_icon = \"🔴\" if config.get('required') else \"🟡\"",
      "severity": "medium"
    },
    {
      "file": "application/cli/commands/hooks_command.py",
      "line": 288,
      "type": "config_dependency",
      "description": "subagent = config.get('subagent', 'unknown')",
      "severity": "medium"
    },
    {
      "file": "application/cli/commands/hooks_command.py",
      "line": 289,
      "type": "config_dependency",
      "description": "description = config.get('description', 'No description')",
      "severity": "medium"
    },
    {
      "file": "application/cli/commands/parallel_command.py",
      "line": 23,
      "type": "perfect21_internal",
      "description": "from features.smart_decomposer import get_smart_decomposer",
      "severity": "low"
    },
    {
      "file": "application/cli/commands/parallel_command.py",
      "line": 24,
      "type": "perfect21_internal",
      "description": "from features.parallel_executor import get_parallel_executor",
      "severity": "low"
    },
    {
      "file": "application/cli/commands/parallel_command.py",
      "line": 55,
      "type": "config_dependency",
      "description": "if not execution_config.get('ready_for_execution'):",
      "severity": "medium"
    },
    {
      "file": "application/cli/commands/parallel_command.py",
      "line": 72,
      "type": "config_dependency",
      "description": "'instructions': execution_config.get('execution_instructions'),",
      "severity": "medium"
    },
    {
      "file": "application/cli/commands/parallel_command.py",
      "line": 73,
      "type": "config_dependency",
      "description": "'monitoring': execution_config.get('monitoring_config')",
      "severity": "medium"
    },
    {
      "file": "application/cli/commands/parallel_command.py",
      "line": 122,
      "type": "config_dependency",
      "description": "if execution_config.get('execution_mode'):",
      "severity": "medium"
    },
    {
      "file": "application/cli/commands/parallel_command.py",
      "line": 125,
      "type": "config_dependency",
      "description": "f\"🤖 预计并行agents: {execution_config.get('expected_agents', 0)}个\"",
      "severity": "medium"
    },
    {
      "file": "application/cli/commands/parallel_command.py",
      "line": 160,
      "type": "perfect21_internal",
      "description": "from features.parallel_executor import get_parallel_executor",
      "severity": "low"
    },
    {
      "file": "application/cli/commands/parallel_command.py",
      "line": 219,
      "type": "perfect21_internal",
      "description": "from features.parallel_executor import get_parallel_executor",
      "severity": "low"
    },
    {
      "file": "infrastructure/config/config_manager.py",
      "line": 19,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "infrastructure/config/config_manager.py",
      "line": 28,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "infrastructure/config/config_manager.py",
      "line": 38,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "infrastructure/config/config_manager.py",
      "line": 47,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "infrastructure/config/config_manager.py",
      "line": 57,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    },
    {
      "file": "infrastructure/config/config_manager.py",
      "line": 85,
      "type": "config_dependency",
      "description": "self.user_config_file = self.project_root / \".perfect21\" / \"config.yaml\"",
      "severity": "medium"
    },
    {
      "file": "infrastructure/git/hooks_optimized.py",
      "line": 32,
      "type": "subagent_direct_call",
      "description": "'code_review': '@code-reviewer',",
      "severity": "medium"
    },
    {
      "file": "infrastructure/git/hooks_optimized.py",
      "line": 33,
      "type": "subagent_direct_call",
      "description": "'security_audit': '@security-auditor',",
      "severity": "medium"
    },
    {
      "file": "infrastructure/git/hooks_optimized.py",
      "line": 34,
      "type": "subagent_direct_call",
      "description": "'test_execution': '@test-engineer',",
      "severity": "medium"
    },
    {
      "file": "infrastructure/git/hooks_optimized.py",
      "line": 35,
      "type": "subagent_direct_call",
      "description": "'performance_check': '@performance-engineer',",
      "severity": "medium"
    },
    {
      "file": "infrastructure/git/hooks_optimized.py",
      "line": 36,
      "type": "subagent_direct_call",
      "description": "'deployment_check': '@devops-engineer',",
      "severity": "medium"
    },
    {
      "file": "infrastructure/git/hooks_optimized.py",
      "line": 37,
      "type": "subagent_direct_call",
      "description": "'quality_gate': '@orchestrator',",
      "severity": "medium"
    },
    {
      "file": "infrastructure/git/hooks_optimized.py",
      "line": 38,
      "type": "subagent_direct_call",
      "description": "'business_analysis': '@business-analyst'",
      "severity": "medium"
    },
    {
      "file": "infrastructure/git/hooks_optimized.py",
      "line": 248,
      "type": "subagent_direct_call",
      "description": "agents = ['@code-reviewer']  # 基础检查",
      "severity": "medium"
    },
    {
      "file": "infrastructure/git/hooks_optimized.py",
      "line": 257,
      "type": "subagent_direct_call",
      "description": "agents.extend(['@security-auditor', '@test-engineer'])",
      "severity": "medium"
    },
    {
      "file": "infrastructure/git/hooks_optimized.py",
      "line": 259,
      "type": "subagent_direct_call",
      "description": "agents.extend(['@test-engineer', '@performance-engineer'])",
      "severity": "medium"
    },
    {
      "file": "infrastructure/git/hooks_optimized.py",
      "line": 263,
      "type": "subagent_direct_call",
      "description": "if '@security-auditor' not in agents:",
      "severity": "medium"
    },
    {
      "file": "infrastructure/git/hooks_optimized.py",
      "line": 264,
      "type": "subagent_direct_call",
      "description": "agents.append('@security-auditor')",
      "severity": "medium"
    },
    {
      "file": "infrastructure/git/hooks_optimized.py",
      "line": 267,
      "type": "subagent_direct_call",
      "description": "if '@test-engineer' not in agents:",
      "severity": "medium"
    },
    {
      "file": "infrastructure/git/hooks_optimized.py",
      "line": 268,
      "type": "subagent_direct_call",
      "description": "agents.append('@test-engineer')",
      "severity": "medium"
    },
    {
      "file": "infrastructure/git/hooks_optimized.py",
      "line": 272,
      "type": "subagent_direct_call",
      "description": "if '@test-engineer' not in agents:",
      "severity": "medium"
    },
    {
      "file": "infrastructure/git/hooks_optimized.py",
      "line": 273,
      "type": "subagent_direct_call",
      "description": "agents.append('@test-engineer')",
      "severity": "medium"
    },
    {
      "file": "infrastructure/git/hooks_optimized.py",
      "line": 276,
      "type": "subagent_direct_call",
      "description": "agents.append('@orchestrator')  # 大规模变更需要协调",
      "severity": "medium"
    },
    {
      "file": "infrastructure/git/hooks_optimized.py",
      "line": 282,
      "type": "subagent_direct_call",
      "description": "agents = ['@test-engineer']  # 基础测试",
      "severity": "medium"
    },
    {
      "file": "infrastructure/git/hooks_optimized.py",
      "line": 288,
      "type": "subagent_direct_call",
      "description": "agents.extend(['@performance-engineer', '@devops-engineer'])",
      "severity": "medium"
    },
    {
      "file": "infrastructure/git/hooks_optimized.py",
      "line": 291,
      "type": "subagent_direct_call",
      "description": "agents = ['@test-engineer']",
      "severity": "medium"
    },
    {
      "file": "infrastructure/git/hooks_optimized.py",
      "line": 294,
      "type": "subagent_direct_call",
      "description": "agents.append('@code-reviewer')",
      "severity": "medium"
    },
    {
      "file": "infrastructure/git/hooks_optimized.py",
      "line": 296,
      "type": "subagent_direct_call",
      "description": "agents.append('@performance-engineer')",
      "severity": "medium"
    },
    {
      "file": "infrastructure/git/hooks_optimized.py",
      "line": 367,
      "type": "subagent_direct_call",
      "description": "parallel_instructions.append(f\"Task(subagent_type='{agent_name}', ...)\")",
      "severity": "medium"
    },
    {
      "file": "infrastructure/git/git_cache.py",
      "line": 17,
      "type": "subagent_direct_call",
      "description": "@dataclass",
      "severity": "medium"
    }
  ]
}
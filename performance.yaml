# Claude Enhancer Performance Optimization Configuration
# 性能优化配置文件

service_name: "claude-enhancer"
environment: "production"  # development, staging, production
debug_mode: false
log_level: "INFO"
config_refresh_interval: 300  # 5 minutes

# Redis缓存配置
redis:
  host: "localhost"
  port: 6379
  password: null
  db: 0
  pool_size: 50
  timeout: 5
  retry_on_timeout: true
  compression_enabled: true
  compression_threshold: 1024
  default_ttl: 300
  max_connections: 100

# 数据库优化配置
database:
  # url will be loaded from environment variable DATABASE_URL
  pool_size: 20
  max_overflow: 30
  pool_timeout: 30
  pool_recycle: 3600
  slow_query_threshold: 1.0
  enable_query_cache: true
  query_cache_ttl: 300
  enable_prepared_statements: true
  statement_cache_size: 100
  connection_timeout: 10.0
  query_timeout: 30.0

# 异步处理器配置
async_processor:
  max_workers: 10
  max_queue_size: 1000
  worker_timeout: 300.0
  health_check_interval: 30.0
  stats_report_interval: 60.0
  cleanup_interval: 3600.0
  task_retention_hours: 24

  # 邮件配置
  smtp_host: "localhost"
  smtp_port: 587
  smtp_username: null
  smtp_password: null
  smtp_use_tls: true
  email_from: "noreply@claude-enhancer.dev"

  # 消息队列配置
  rabbitmq_url: "amqp://localhost"

  # API配置
  api_timeout: 30.0
  api_retries: 3

# 负载均衡器配置
load_balancer:
  algorithm: "weighted_round_robin"  # round_robin, weighted_round_robin, least_connections, ip_hash, health_based
  health_check_enabled: true
  health_check_interval: 30
  session_affinity: false
  session_timeout: 3600
  max_retries: 3
  retry_delay: 0.1
  circuit_breaker_enabled: true
  circuit_breaker_threshold: 5
  circuit_breaker_timeout: 60
  connection_timeout: 10.0
  read_timeout: 30.0

# 指标收集配置
metrics:
  collection_interval: 10.0
  retention_period_hours: 24
  max_metrics_per_type: 10000
  enable_system_metrics: true
  enable_application_metrics: true
  enable_business_metrics: true
  alert_check_interval: 30.0
  export_interval: 60.0
  export_format: "prometheus"  # prometheus, json
  export_file: "/tmp/claude_enhancer_metrics.txt"

# 性能阈值配置
thresholds:
  # 响应时间阈值 (毫秒)
  response_time_warning: 500.0
  response_time_critical: 1000.0

  # CPU使用率阈值 (%)
  cpu_usage_warning: 70.0
  cpu_usage_critical: 85.0

  # 内存使用率阈值 (%)
  memory_usage_warning: 75.0
  memory_usage_critical: 90.0

  # 磁盘使用率阈值 (%)
  disk_usage_warning: 80.0
  disk_usage_critical: 95.0

  # 网络延迟阈值 (毫秒)
  network_latency_warning: 100.0
  network_latency_critical: 500.0

  # 错误率阈值 (%)
  error_rate_warning: 1.0
  error_rate_critical: 5.0

  # 并发连接数阈值
  connection_count_warning: 1000
  connection_count_critical: 5000

# 优化设置
optimization:
  # 缓存设置
  enable_l1_cache: true
  enable_l2_cache: true
  cache_strategy: "lru"  # lru, lfu, ttl, write_through, write_back

  # 连接池设置
  enable_connection_pooling: true
  connection_pool_preconnect: true

  # 查询优化
  enable_query_optimization: true
  enable_batch_operations: true

  # 压缩设置
  enable_response_compression: true
  compression_min_size: 1024

  # 异步处理
  enable_async_processing: true
  async_queue_prioritization: true

  # 负载均衡
  enable_load_balancing: true
  enable_health_checks: true

  # 监控设置
  enable_detailed_monitoring: true
  enable_real_time_alerts: true

# 环境特定配置
development:
  debug_mode: true
  log_level: "DEBUG"
  redis:
    pool_size: 10
  database:
    pool_size: 5
  metrics:
    collection_interval: 5.0

staging:
  debug_mode: false
  log_level: "INFO"
  redis:
    pool_size: 20
  database:
    pool_size: 10

production:
  debug_mode: false
  log_level: "WARNING"
  redis:
    pool_size: 50
  database:
    pool_size: 20
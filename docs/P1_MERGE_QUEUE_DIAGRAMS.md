# P1è§„åˆ’ï¼šMerge Queueæ¶æ„å›¾é›†

**ç‰ˆæœ¬**: 1.0
**æ—¥æœŸ**: 2025-10-10
**é…å¥—æ–‡æ¡£**: P1_MERGE_QUEUE_ARCHITECTURE.md

---

## 1. ç³»ç»Ÿæ¶æ„æ€»è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Claude Enhancer Workflow                     â”‚
â”‚                         (P0-P7 Phases)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ P6 (Release Phase)
                     â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  Branch Protection    â”‚
         â”‚   (branch_helper.sh)  â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ Feature Branch Ready
                     â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   Merge Queue Manager (NEW)            â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
    â”‚   â”‚  Queue Operations              â”‚   â”‚
    â”‚   â”‚  - enqueue()                   â”‚   â”‚
    â”‚   â”‚  - dequeue()                   â”‚   â”‚
    â”‚   â”‚  - status()                    â”‚   â”‚
    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
    â”‚                â–¼                        â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
    â”‚   â”‚  Conflict Pre-Check            â”‚   â”‚
    â”‚   â”‚  - git merge-tree              â”‚   â”‚
    â”‚   â”‚  - conflict_analyzer           â”‚   â”‚
    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
    â”‚                â–¼                        â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
    â”‚   â”‚  FIFO Scheduler                â”‚   â”‚
    â”‚   â”‚  - priority calculation        â”‚   â”‚
    â”‚   â”‚  - resource coordination       â”‚   â”‚
    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  Mutex Lock (REUSE)   â”‚
         â”‚  (.workflow/lib/      â”‚
         â”‚   mutex_lock.sh)      â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  Git Merge   â”‚
              â”‚  to main     â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. æ•°æ®æµå›¾ï¼ˆData Flow Diagramï¼‰

```
Terminal 1          Terminal 2          Terminal 3
    â”‚                   â”‚                   â”‚
    â”‚ feature/auth      â”‚ feature/payment   â”‚ feature/logging
    â–¼                   â–¼                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Merge Queue (queue.json)                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Entry 1: {id: mq-001, status: QUEUED, ...} â”‚  â”‚
â”‚  â”‚ Entry 2: {id: mq-002, status: QUEUED, ...} â”‚  â”‚
â”‚  â”‚ Entry 3: {id: mq-003, status: QUEUED, ...} â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   Processor Loop      â”‚
        â”‚   (Daemon Process)    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚ Dequeue Next
                    â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Conflict Pre-Check   â”‚
        â”‚  (git merge-tree)     â”‚
        â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜
            â”‚               â”‚
     No Conflict      Has Conflict
            â”‚               â”‚
            â–¼               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   MERGING    â”‚   â”‚ CONFLICT_DETECTEDâ”‚
    â”‚   Status     â”‚   â”‚   Status         â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                    â”‚
           â”‚                    â–¼
           â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚           â”‚  Auto Rebase?   â”‚
           â”‚           â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜
           â”‚                â”‚ Yes    â”‚ No
           â”‚                â–¼        â–¼
           â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚        â”‚  Rebase   â”‚ â”‚ MANUAL_REQUIREDâ”‚
           â”‚        â”‚  Success  â”‚ â”‚   Notify User  â”‚
           â”‚        â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚              â”‚
           â”‚              â–¼ Re-enqueue
           â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â””â”€â”€â”€â”€â”€â”€â”€>â”‚   Mutex   â”‚
                    â”‚   Lock    â”‚
                    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚  Git Merge    â”‚
                  â”‚  (Atomic Op)  â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚    MERGED     â”‚
                  â”‚   Status      â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. çŠ¶æ€æœºè¯¦ç»†è½¬æ¢å›¾

```
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚  User Input â”‚
                        â”‚ (merge req) â”‚
                        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚   SUBMITTED     â”‚
                      â”‚  Validation     â”‚
                      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜
                           â”‚ Valid  â”‚ Invalid
                           â–¼        â–¼
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚   QUEUED    â”‚ â”‚ REJECTED â”‚
                  â”‚  (waiting)  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ Dequeued
                         â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  CONFLICT_CHECK       â”‚
              â”‚  (git merge-tree)     â”‚
              â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜
                  â”‚ No Conflict   â”‚ Has Conflict
                  â–¼               â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚    MERGING       â”‚  â”‚ CONFLICT_DETECTED   â”‚
        â”‚ (mutex locked)   â”‚  â”‚  Analyze conflicts  â”‚
        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚ OK     â”‚ Fail             â”‚
             â–¼        â–¼                  â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚ MERGED  â”‚ â”‚ FAILED â”‚    â”‚ Decision: Rebase?   â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜
                                  â”‚ Auto         â”‚ Manual
                                  â–¼              â–¼
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚REBASE_PENDING â”‚  â”‚ MANUAL_REQUIRED  â”‚
                          â”‚  (executing)  â”‚  â”‚ (wait for user)  â”‚
                          â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚ OK    â”‚ Fail          â”‚ Fixed
                              â–¼       â–¼               â–¼
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚ QUEUED  â”‚ â”‚ FAILED â”‚  â”‚ QUEUED  â”‚
                         â”‚ (retry) â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ (retry) â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


Legend:
â”â”â”â”â”â”â” Normal Flow
â”„â”„â”„â”„â”„â”„â”„ Error Flow
â” â” â” â” Retry Flow
```

---

## 4. å¹¶å‘æ§åˆ¶æ—¶åºå›¾ï¼ˆSequence Diagramï¼‰

```
Terminal-1   Terminal-2   Queue Manager   Processor   Mutex Lock   Git
    â”‚            â”‚              â”‚             â”‚           â”‚         â”‚
    â”‚ enqueue    â”‚              â”‚             â”‚           â”‚         â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚             â”‚           â”‚         â”‚
    â”‚            â”‚              â”‚ Add Entry   â”‚           â”‚         â”‚
    â”‚            â”‚              â”‚ (mq-001)    â”‚           â”‚         â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”‚           â”‚         â”‚
    â”‚  Position:1â”‚              â”‚             â”‚           â”‚         â”‚
    â”‚            â”‚ enqueue      â”‚             â”‚           â”‚         â”‚
    â”‚            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚             â”‚           â”‚         â”‚
    â”‚            â”‚              â”‚ Add Entry   â”‚           â”‚         â”‚
    â”‚            â”‚              â”‚ (mq-002)    â”‚           â”‚         â”‚
    â”‚            â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”‚           â”‚         â”‚
    â”‚            â”‚  Position:2  â”‚             â”‚           â”‚         â”‚
    â”‚            â”‚              â”‚             â”‚           â”‚         â”‚
    â”‚            â”‚              â”‚   Dequeue   â”‚           â”‚         â”‚
    â”‚            â”‚              â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”‚         â”‚
    â”‚            â”‚              â”‚  mq-001     â”‚           â”‚         â”‚
    â”‚            â”‚              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚           â”‚         â”‚
    â”‚            â”‚              â”‚             â”‚           â”‚         â”‚
    â”‚            â”‚              â”‚       Conflict Check    â”‚         â”‚
    â”‚            â”‚              â”‚             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚
    â”‚            â”‚              â”‚             â”‚           â”‚  merge- â”‚
    â”‚            â”‚              â”‚             â”‚           â”‚  tree   â”‚
    â”‚            â”‚              â”‚             â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
    â”‚            â”‚              â”‚             â”‚  No Conflict       â”‚
    â”‚            â”‚              â”‚             â”‚           â”‚         â”‚
    â”‚            â”‚              â”‚             â”‚  Acquire Lock      â”‚
    â”‚            â”‚              â”‚             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚         â”‚
    â”‚            â”‚              â”‚             â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”‚
    â”‚            â”‚              â”‚             â”‚  Locked   â”‚         â”‚
    â”‚            â”‚              â”‚             â”‚           â”‚         â”‚
    â”‚            â”‚              â”‚             â”‚      Execute Merge  â”‚
    â”‚            â”‚              â”‚             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚            â”‚              â”‚             â”‚           â”‚  checkoutâ”‚
    â”‚            â”‚              â”‚             â”‚           â”‚  merge   â”‚
    â”‚            â”‚              â”‚             â”‚           â”‚  push    â”‚
    â”‚            â”‚              â”‚             â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
    â”‚            â”‚              â”‚             â”‚           â”‚  Success â”‚
    â”‚            â”‚              â”‚             â”‚           â”‚         â”‚
    â”‚            â”‚              â”‚             â”‚  Release Lock       â”‚
    â”‚            â”‚              â”‚             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚         â”‚
    â”‚            â”‚              â”‚             â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”‚
    â”‚            â”‚              â”‚   Update Status         â”‚         â”‚
    â”‚            â”‚              â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”‚         â”‚
    â”‚            â”‚              â”‚  MERGED     â”‚           â”‚         â”‚
    â”‚            â”‚              â”‚             â”‚           â”‚         â”‚
    â”‚ Notify     â”‚              â”‚             â”‚           â”‚         â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”‚           â”‚         â”‚
    â”‚  Success   â”‚              â”‚             â”‚           â”‚         â”‚
    â”‚            â”‚              â”‚   Dequeue Next          â”‚         â”‚
    â”‚            â”‚              â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”‚         â”‚
    â”‚            â”‚              â”‚  mq-002     â”‚           â”‚         â”‚
    â”‚            â”‚              â”‚             â”‚           â”‚         â”‚
```

---

## 5. æ¨¡å—ä¾èµ–å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             merge_queue_manager.sh (Main)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”œâ”€â”€> queue_operations.sh
           â”‚    â”œâ”€ enqueue()
           â”‚    â”œâ”€ dequeue()
           â”‚    â”œâ”€ update_status()
           â”‚    â””â”€ get_status()
           â”‚
           â”œâ”€â”€> state_machine.sh
           â”‚    â”œâ”€ validate_transition()
           â”‚    â”œâ”€ apply_state_change()
           â”‚    â””â”€ get_valid_transitions()
           â”‚
           â”œâ”€â”€> persistence.sh
           â”‚    â”œâ”€ save_queue()
           â”‚    â”œâ”€ load_queue()
           â”‚    â”œâ”€ backup_queue()
           â”‚    â””â”€ restore_from_backup()
           â”‚
           â”œâ”€â”€> conflict_detection/
           â”‚    â”‚
           â”‚    â”œâ”€â”€> git_merge_tree.sh
           â”‚    â”‚    â”œâ”€ precheck_conflict()
           â”‚    â”‚    â”œâ”€ analyze_conflict_type()
           â”‚    â”‚    â””â”€ extract_conflict_files()
           â”‚    â”‚
           â”‚    â”œâ”€â”€> conflict_analyzer.sh
           â”‚    â”‚    â”œâ”€ classify_conflict()
           â”‚    â”‚    â”œâ”€ estimate_complexity()
           â”‚    â”‚    â””â”€ recommend_strategy()
           â”‚    â”‚
           â”‚    â””â”€â”€> rebase_advisor.sh
           â”‚         â”œâ”€ can_auto_rebase()
           â”‚         â”œâ”€ execute_rebase()
           â”‚         â””â”€ rollback_on_failure()
           â”‚
           â”œâ”€â”€> scheduler/
           â”‚    â”‚
           â”‚    â”œâ”€â”€> fifo_scheduler.sh
           â”‚    â”‚    â”œâ”€ get_next_task()
           â”‚    â”‚    â”œâ”€ calculate_wait_time()
           â”‚    â”‚    â””â”€ reorder_queue()
           â”‚    â”‚
           â”‚    â”œâ”€â”€> priority_engine.sh (FUTURE)
           â”‚    â”‚    â”œâ”€ calculate_priority()
           â”‚    â”‚    â”œâ”€ apply_priority_rules()
           â”‚    â”‚    â””â”€ dynamic_adjustment()
           â”‚    â”‚
           â”‚    â””â”€â”€> resource_manager.sh
           â”‚         â”œâ”€ check_resource_availability()
           â”‚         â”œâ”€ allocate_resource()
           â”‚         â””â”€ release_resource()
           â”‚
           â”œâ”€â”€> integration/
           â”‚    â”‚
           â”‚    â”œâ”€â”€> mutex_adapter.sh
           â”‚    â”‚    â”œâ”€ acquire_merge_lock()
           â”‚    â”‚    â”œâ”€ release_merge_lock()
           â”‚    â”‚    â””â”€ check_lock_status()
           â”‚    â”‚    â”‚
           â”‚    â”‚    â””â”€â”€â”€> ../../.workflow/lib/mutex_lock.sh (REUSE)
           â”‚    â”‚
           â”‚    â”œâ”€â”€> workflow_hooks.sh
           â”‚    â”‚    â”œâ”€ integrate_with_p6()
           â”‚    â”‚    â”œâ”€ trigger_on_merge()
           â”‚    â”‚    â””â”€ post_merge_actions()
           â”‚    â”‚
           â”‚    â””â”€â”€> notification.sh
           â”‚         â”œâ”€ send_notification()
           â”‚         â”œâ”€ write_notification_file()
           â”‚         â””â”€ log_notification()
           â”‚
           â””â”€â”€> utils/
                â”œâ”€â”€> logger.sh
                â”‚    â”œâ”€ log_info()
                â”‚    â”œâ”€ log_warn()
                â”‚    â”œâ”€ log_error()
                â”‚    â””â”€ log_success()
                â”‚
                â”œâ”€â”€> validator.sh
                â”‚    â”œâ”€ validate_branch()
                â”‚    â”œâ”€ validate_target()
                â”‚    â””â”€ validate_queue_entry()
                â”‚
                â””â”€â”€> metrics.sh
                     â”œâ”€ record_metric()
                     â”œâ”€ calculate_percentile()
                     â””â”€ generate_report()
```

---

## 6. æ–‡ä»¶ç³»ç»Ÿå¸ƒå±€

```
Claude Enhancer 5.0/
â”œâ”€â”€ .workflow/
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”œâ”€â”€ mutex_lock.sh              # ç°æœ‰ï¼ˆå¤ç”¨ï¼‰
â”‚   â”‚   â”œâ”€â”€ conflict_detector.sh       # ç°æœ‰ï¼ˆå¤ç”¨ï¼‰
â”‚   â”‚   â””â”€â”€ merge_queue_manager.sh     # æ–°å¢ï¼ˆä¸»å…¥å£ï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ merge_queue/                   # æ–°å¢ç›®å½•
â”‚   â”‚   â”œâ”€â”€ queue.json                 # é˜Ÿåˆ—ä¸»æ–‡ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ Format: [
â”‚   â”‚   â”‚         {queue_id, status, ...},
â”‚   â”‚   â”‚         ...
â”‚   â”‚   â”‚       ]
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ locks/                     # é”æ–‡ä»¶ç›®å½•
â”‚   â”‚   â”‚   â”œâ”€â”€ queue.lock             # é˜Ÿåˆ—æ“ä½œé”
â”‚   â”‚   â”‚   â””â”€â”€ processor.lock         # Processoräº’æ–¥é”
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ history/                   # å†å²è®°å½•ï¼ˆæŒ‰å¤©ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ 2025-10-10.jsonl
â”‚   â”‚   â”‚   â””â”€â”€ 2025-10-11.jsonl
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ checkpoints/               # æ¢å¤æ£€æŸ¥ç‚¹
â”‚   â”‚   â”‚   â”œâ”€â”€ queue_backup_20251010_180000.json
â”‚   â”‚   â”‚   â””â”€â”€ queue_backup_20251010_181000.json
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ notifications/             # Terminalé€šçŸ¥æ–‡ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ terminal-1.txt
â”‚   â”‚   â”‚   â””â”€â”€ terminal-2.txt
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ conflicts.log              # å†²çªå®¡è®¡æ—¥å¿—
â”‚   â”‚   â””â”€â”€ metrics.jsonl              # æ€§èƒ½æŒ‡æ ‡
â”‚   â”‚
â”‚   â””â”€â”€ modules/                       # æ–°å¢æ¨¡å—ç›®å½•
â”‚       â””â”€â”€ merge_queue/
â”‚           â”œâ”€â”€ core/
â”‚           â”‚   â”œâ”€â”€ queue_operations.sh
â”‚           â”‚   â”œâ”€â”€ state_machine.sh
â”‚           â”‚   â””â”€â”€ persistence.sh
â”‚           â”‚
â”‚           â”œâ”€â”€ conflict_detection/
â”‚           â”‚   â”œâ”€â”€ git_merge_tree.sh
â”‚           â”‚   â”œâ”€â”€ conflict_analyzer.sh
â”‚           â”‚   â””â”€â”€ rebase_advisor.sh
â”‚           â”‚
â”‚           â”œâ”€â”€ scheduler/
â”‚           â”‚   â”œâ”€â”€ fifo_scheduler.sh
â”‚           â”‚   â”œâ”€â”€ priority_engine.sh
â”‚           â”‚   â””â”€â”€ resource_manager.sh
â”‚           â”‚
â”‚           â”œâ”€â”€ integration/
â”‚           â”‚   â”œâ”€â”€ mutex_adapter.sh
â”‚           â”‚   â”œâ”€â”€ workflow_hooks.sh
â”‚           â”‚   â””â”€â”€ notification.sh
â”‚           â”‚
â”‚           â””â”€â”€ utils/
â”‚               â”œâ”€â”€ logger.sh
â”‚               â”œâ”€â”€ validator.sh
â”‚               â””â”€â”€ metrics.sh
â”‚
â”œâ”€â”€ .claude/
â”‚   â””â”€â”€ hooks/
â”‚       â””â”€â”€ workflow_enforcer.sh       # ä¿®æ”¹ï¼ˆæ·»åŠ P6é›†æˆï¼‰
â”‚
â””â”€â”€ docs/
    â”œâ”€â”€ P1_MERGE_QUEUE_ARCHITECTURE.md # æœ¬è§„åˆ’æ–‡æ¡£
    â””â”€â”€ P1_MERGE_QUEUE_DIAGRAMS.md     # æœ¬æ¶æ„å›¾é›†
```

---

## 7. æ€§èƒ½ç›‘æ§ä»ªè¡¨æ¿è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Merge Queue Performance Dashboard                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  å®æ—¶ç»Ÿè®¡                                    å½“å‰æ—¶é—´: 18:45 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  QUEUED    â”‚  MERGING   â”‚  MERGED    â”‚  FAILED    â”‚      â”‚
â”‚  â”‚     5      â”‚     1      â”‚    42      â”‚     2      â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                               â”‚
â”‚  ç­‰å¾…æ—¶é—´åˆ†å¸ƒ (è¿‡å»1å°æ—¶)                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ P50:  28s  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  Targetâ”‚       â”‚
â”‚  â”‚ P90:  55s  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘  Targetâ”‚       â”‚
â”‚  â”‚ P99: 115s  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                               â”‚
â”‚  ååé‡è¶‹åŠ¿                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ 18:00  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  6 merges                          â”‚       â”‚
â”‚  â”‚ 18:15  â–ˆâ–ˆâ–ˆâ–ˆ    4 merges                          â”‚       â”‚
â”‚  â”‚ 18:30  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 8 merges                         â”‚       â”‚
â”‚  â”‚ 18:45  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  6 merges                          â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                               â”‚
â”‚  å†²çªæ£€æµ‹ç»Ÿè®¡                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ æ€»æ£€æµ‹æ¬¡æ•°: 50                                    â”‚       â”‚
â”‚  â”‚ å‘ç°å†²çª:   8  (16%)                              â”‚       â”‚
â”‚  â”‚ è‡ªåŠ¨Rebase: 5  (10%)                              â”‚       â”‚
â”‚  â”‚ éœ€äººå·¥ä»‹å…¥: 3  (6%)                               â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                               â”‚
â”‚  å½“å‰é˜Ÿåˆ— (æœ€è¿‘5æ¡)                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ID       Branch            Status    Wait Time       â”‚  â”‚
â”‚  â”‚ mq-001   feature/auth      MERGING   45s            â”‚  â”‚
â”‚  â”‚ mq-002   feature/payment   QUEUED    12s            â”‚  â”‚
â”‚  â”‚ mq-003   feature/logging   QUEUED    5s             â”‚  â”‚
â”‚  â”‚ mq-004   feature/search    QUEUED    2s             â”‚  â”‚
â”‚  â”‚ mq-005   feature/export    QUEUED    0s             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                               â”‚
â”‚  [R] Refresh  [Q] Quit  [D] Details  [C] Clear History      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å®ç°è„šæœ¬**:
```bash
#!/bin/bash
# .workflow/cli/dashboard_merge_queue.sh

watch -n 1 '
clear
cat << EOF
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Merge Queue Performance Dashboard                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å®æ—¶ç»Ÿè®¡                                    å½“å‰æ—¶é—´: $(date +%H:%M) â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  QUEUED    â”‚  MERGING   â”‚  MERGED    â”‚  FAILED    â”‚      â”‚
â”‚  â”‚  $(jq "[.[] | select(.status == \"QUEUED\")] | length" queue.json | xargs printf "%5s") â”‚  $(jq "[.[] | select(.status == \"MERGING\")] | length" queue.json | xargs printf "%5s") â”‚  $(jq "[.[] | select(.status == \"MERGED\")] | length" queue.json | xargs printf "%5s") â”‚  $(jq "[.[] | select(.status == \"FAILED\")] | length" queue.json | xargs printf "%5s") â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
EOF
'
```

---

## 8. é”™è¯¯æ¢å¤æµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç³»ç»Ÿå¯åŠ¨/é‡å¯       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ£€æŸ¥é˜Ÿåˆ—å®Œæ•´æ€§           â”‚
â”‚ validate_queue_integrity()â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚ Valid      â”‚ Invalid
       â–¼            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç»§ç»­        â”‚  â”‚ ä»å¤‡ä»½æ¢å¤      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â”‚ restore_backup()â”‚
       â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                  â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                  â–¼
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚ æ‰«æMERGINGçŠ¶æ€ä»»åŠ¡    â”‚
       â”‚ find_incomplete_merges()â”‚
       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚ æœ‰æœªå®Œæˆä»»åŠ¡ï¼Ÿ  â”‚
       â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜
          â”‚ No       â”‚ Yes
          â–¼          â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ æ­£å¸¸å¯åŠ¨â”‚  â”‚ æ£€æŸ¥GitçŠ¶æ€      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ is_merge_active()â”‚
                 â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                    â”‚ Clean    â”‚ In Progress
                    â–¼          â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚ é‡æ–°å…¥é˜Ÿ       â”‚ â”‚ æ ‡è®°MANUAL_      â”‚
           â”‚ â†’ QUEUED       â”‚ â”‚ REQUIRED         â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                               â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ æ¸…ç†å­¤å„¿é”         â”‚
                    â”‚ cleanup_orphan_    â”‚
                    â”‚ locks()            â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ å‘é€æ¢å¤é€šçŸ¥       â”‚
                    â”‚ notify_recovery()  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ å¯åŠ¨Processor      â”‚
                    â”‚ merge_queue_       â”‚
                    â”‚ process()          â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 9. ä¼˜å…ˆçº§é˜Ÿåˆ—æ‰©å±•è®¾è®¡ï¼ˆé¢„ç•™ï¼‰

```
å½“å‰FIFOé˜Ÿåˆ—:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ mq-001 â”‚ mq-002 â”‚ mq-003 â”‚ mq-004 â”‚ mq-005 â”‚
â”‚  P=5   â”‚  P=5   â”‚  P=5   â”‚  P=5   â”‚  P=5   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         å…ˆå…¥å…ˆå‡º (FIFO)

æœªæ¥ä¼˜å…ˆçº§é˜Ÿåˆ—:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ mq-006 â”‚ mq-001 â”‚ mq-003 â”‚ mq-002 â”‚ mq-004 â”‚
â”‚ P=8    â”‚  P=7   â”‚  P=5   â”‚  P=5   â”‚  P=3   â”‚
â”‚hotfix  â”‚small   â”‚normal  â”‚normal  â”‚experi- â”‚
â”‚        â”‚change  â”‚        â”‚        â”‚ment    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         é«˜ä¼˜å…ˆçº§åœ¨å‰

ä¼˜å…ˆçº§è®¡ç®—å…¬å¼:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ priority = base_priority              â”‚
â”‚          + branch_type_weight         â”‚
â”‚          + small_change_bonus         â”‚
â”‚          + wait_time_bonus            â”‚
â”‚          - conflict_penalty           â”‚
â”‚                                       â”‚
â”‚ ä¾‹å­:                                 â”‚
â”‚ hotfix/critical-bug:                  â”‚
â”‚   = 5 (base)                          â”‚
â”‚   + 3 (hotfix weight)                 â”‚
â”‚   + 2 (3 files changed)               â”‚
â”‚   + 0 (just queued)                   â”‚
â”‚   - 0 (no conflict)                   â”‚
â”‚   = 10 (é«˜ä¼˜å…ˆçº§)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 10. æµ‹è¯•æ‹“æ‰‘å›¾

```
æµ‹è¯•é‡‘å­—å¡”:

              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ E2E Tests    â”‚  â† æ··æ²Œæµ‹è¯•
              â”‚ (Chaos)      â”‚    è¿›ç¨‹crashæ¢å¤
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    ç½‘ç»œæ•…éšœæ¨¡æ‹Ÿ
                     â–²
                     â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚ Integration Tests   â”‚  â† å¤šTerminalåœºæ™¯
           â”‚                     â”‚    å†²çªæ£€æµ‹+Rebase
           â”‚                     â”‚    å®Œæ•´mergeæµç¨‹
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â–²
                     â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   Unit Tests               â”‚  â† å•ä¸ªå‡½æ•°æµ‹è¯•
        â”‚   - enqueue()              â”‚    çŠ¶æ€è½¬æ¢
        â”‚   - dequeue()              â”‚    å†²çªæ£€æµ‹
        â”‚   - conflict_precheck()    â”‚    æ•°æ®æŒä¹…åŒ–
        â”‚   - auto_rebase()          â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


æµ‹è¯•çŸ©é˜µ:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Scenario    â”‚ Unit     â”‚ Integr.  â”‚ Perf.    â”‚ Chaos    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Enqueue     â”‚    âœ“     â”‚    âœ“     â”‚    âœ“     â”‚          â”‚
â”‚ Dequeue     â”‚    âœ“     â”‚    âœ“     â”‚    âœ“     â”‚          â”‚
â”‚ Conflict    â”‚    âœ“     â”‚    âœ“     â”‚          â”‚          â”‚
â”‚ Rebase      â”‚    âœ“     â”‚    âœ“     â”‚          â”‚    âœ“     â”‚
â”‚ Merge       â”‚          â”‚    âœ“     â”‚    âœ“     â”‚    âœ“     â”‚
â”‚ Crash       â”‚          â”‚          â”‚          â”‚    âœ“     â”‚
â”‚ Network     â”‚          â”‚          â”‚          â”‚    âœ“     â”‚
â”‚ Deadlock    â”‚          â”‚    âœ“     â”‚          â”‚    âœ“     â”‚
â”‚ 10 Conc.    â”‚          â”‚          â”‚    âœ“     â”‚          â”‚
â”‚ 50 Conc.    â”‚          â”‚          â”‚    âœ“     â”‚          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## é™„å½•ï¼šç¬¦å·è¯´æ˜

```
å›¾å½¢ç¬¦å·:
â”Œâ”€â”  â”Œâ”€â”€â”€â”
â”‚ â”‚  â”‚   â”‚  çŸ©å½¢æ¡†ï¼šè¿›ç¨‹/æ¨¡å—/ç»„ä»¶
â””â”€â”˜  â””â”€â”€â”€â”˜

   â—†       è±å½¢ï¼šå†³ç­–ç‚¹
  â•± â•²
 â•±   â•²
â•²     â•±
 â•²   â•±
  â•² â•±

   â–¼       ç®­å¤´ï¼šæµå‘/ä¾èµ–

â”â”â”â”â”â”â”   åŒçº¿ï¼šå¼ºè°ƒ/é‡è¦

â”„â”„â”„â”„â”„â”„â”„   è™šçº¿ï¼šå¯é€‰/é¢„ç•™

çº¿æ¡é£æ ¼:
â”€â”€â”€â”€â”€      ç›´çº¿ï¼šæ­£å¸¸æµç¨‹
â” â” â”      é—´æ–­ï¼šé”™è¯¯å¤„ç†
â”ˆâ”ˆâ”ˆâ”ˆâ”ˆ      ç‚¹çº¿ï¼šæ•°æ®æµ
â•â•â•â•â•      åŒçº¿ï¼šå¹¶å‘/é”

çŠ¶æ€æ ‡è®°:
âœ“  æˆåŠŸ/å®Œæˆ
âœ—  å¤±è´¥/é”™è¯¯
âš   è­¦å‘Š
ğŸ”’ é”å®š
ğŸ”„ é‡è¯•
ğŸ“‹ é˜Ÿåˆ—
â±  è¶…æ—¶
```

---

## æ€»ç»“

æœ¬æ¶æ„å›¾é›†æä¾›äº†Merge Queue Managerçš„10ä¸ªæ ¸å¿ƒè§†å›¾ï¼š

1. **ç³»ç»Ÿæ¶æ„æ€»è§ˆ** - ç»„ä»¶å…³ç³»
2. **æ•°æ®æµå›¾** - æ•°æ®æµè½¬è·¯å¾„
3. **çŠ¶æ€æœºè½¬æ¢å›¾** - å®Œæ•´çŠ¶æ€æµè½¬
4. **å¹¶å‘æ§åˆ¶æ—¶åºå›¾** - å¤šTerminaläº¤äº’
5. **æ¨¡å—ä¾èµ–å›¾** - ä»£ç ç»„ç»‡ç»“æ„
6. **æ–‡ä»¶ç³»ç»Ÿå¸ƒå±€** - ç›®å½•å’Œæ–‡ä»¶ç»„ç»‡
7. **æ€§èƒ½ç›‘æ§ä»ªè¡¨æ¿** - è¿ç»´å¯è§†åŒ–
8. **é”™è¯¯æ¢å¤æµç¨‹** - å¼‚å¸¸å¤„ç†æœºåˆ¶
9. **ä¼˜å…ˆçº§é˜Ÿåˆ—è®¾è®¡** - æœªæ¥æ‰©å±•
10. **æµ‹è¯•æ‹“æ‰‘å›¾** - æµ‹è¯•ç­–ç•¥å…¨æ™¯

è¿™äº›å›¾è¡¨å°†æŒ‡å¯¼P2ï¼ˆéª¨æ¶æ­å»ºï¼‰å’ŒP3ï¼ˆå®ç°ç¼–ç ï¼‰é˜¶æ®µçš„å·¥ä½œã€‚

---

**ä¸‹ä¸€æ­¥è¡ŒåŠ¨**:
- [ ] P2ï¼šåˆ›å»ºç›®å½•ç»“æ„
- [ ] P2ï¼šå®ç°æ ¸å¿ƒæ¥å£ï¼ˆç©ºå‡½æ•°ï¼‰
- [ ] P3ï¼šé€æ¨¡å—å®ç°åŠŸèƒ½
- [ ] P4ï¼šæŒ‰æµ‹è¯•çŸ©é˜µç¼–å†™æµ‹è¯•

*ç”Ÿæˆæ—¶é—´: 2025-10-10*
*Claude Enhancer 5.3 - Production-Ready AI Programming*
